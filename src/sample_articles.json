[{"rendered_body":"\u003cp\u003e毎回調べているので、自分用にまとめ。\u003c/p\u003e\n\n\u003cp\u003e個人的に要注意のところは\u003cfont color=\"OrangeRed\"\u003e*\u003c/font\u003eがついています。\u003c/p\u003e\n\n\u003cp\u003e先に結論を言ってしまうと、ファイルサイズを気にしなくていいときは素直にlodashを使おう。\u003cbr\u003e\nElmの使用も検討しよう。\u003c/p\u003e\n\n\u003cp\u003e動作確認: node v10.16.0(LTS)\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"array\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#array\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eArray\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"非破壊\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%9D%9E%E7%A0%B4%E5%A3%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e非破壊\u003c/h3\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypeconcat\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypeconcat\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.concat()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eb\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ec\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ed\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ee\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ef\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003econcat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003earray2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'a', 'b', 'c', 'd', 'e', 'f' ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'a', 'b', 'c' ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray2\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'd', 'e', 'f' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypefilter\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypefilter\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.filter()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003espray\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003elimit\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eelite\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eexuberant\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003edestruction\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epresent\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efilter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eword\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'exuberant', 'destruction', 'present' ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'spray', 'limit', 'elite', 'exuberant', 'destruction', 'present' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypefind\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypefind\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.find()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e130\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e44\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eelement\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e})\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; 12\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 5, 12, 8, 130, 44 ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypefindindex\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypefindindex\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.findIndex()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e130\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e44\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efindIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eelement\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eelement\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e})\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; 1\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 5, 12, 8, 130, 44 ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypemap\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypemap\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.map()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e12\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e130\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e44\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003ex\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 10, 24, 16, 260, 88 ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 5, 12, 8, 130, 44 ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypejoin\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypejoin\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.join()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eFire\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eAir\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eWater\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; 'Fire,Air,Water'\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'Fire', 'Air', 'Water' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypereduce\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypereduce\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.reduce()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003eacc\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eacc\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; 10\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 1, 2, 3, 4 ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypeslice\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypeslice\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.slice()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eant\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ebison\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ecamel\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003educk\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eelephant\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eslice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'camel', 'duck' ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'ant', 'bison', 'camel', 'duck', 'elephant' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"レシーバ破壊\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AC%E3%82%B7%E3%83%BC%E3%83%90%E7%A0%B4%E5%A3%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eレシーバ破壊\u003c/h3\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypepop\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypepop\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.pop()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eb\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ec\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epop\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; 'c'\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'a', 'b' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypepush\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypepush\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.push()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eb\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ec\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ed\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; 4\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'a', 'b', 'c', 'd' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypeshift\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypeshift\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.shift()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eb\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ec\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eshift\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; 'a'\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'b', 'c' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypesplice\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypesplice\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.splice()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eb\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ec\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esplice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ex\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'c' ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'a', 'b', 'x' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"arrayprototypeunshift\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#arrayprototypeunshift\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eArray.prototype.unshift()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eb\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ec\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eunshift\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ex\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ey\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ez\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; 6\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'x', 'y', 'z', 'a', 'b', 'c' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"-arrayprototypereverse\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-arrayprototypereverse\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cfont color=\"OrangeRed\"\u003e*\u003c/font\u003e \u003ccode\u003eArray.prototype.reverse()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ea\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eb\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ec\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ereverse\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'c', 'b', 'a' ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'c', 'b', 'a' ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"-arrayprototypesort\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-arrayprototypesort\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cfont color=\"OrangeRed\"\u003e*\u003c/font\u003e \u003ccode\u003eArray.prototype.sort()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e21\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e100000\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esort\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 1, 100000, 21, 30, 4 ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003earray1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 1, 100000, 21, 30, 4 ]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e\u003cfont color=\"Gray\"\u003e(戻り値があるくせにレシーバ破壊してくるとか正気かよ。)\u003c/font\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"object\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#object\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eObject\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"非破壊-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%9D%9E%E7%A0%B4%E5%A3%8A-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e非破壊\u003c/h3\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"objectkeys\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#objectkeys\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eObject.keys()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ekeys\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 'a', 'b', 'c' ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; { a: 1, b: 2, c: 3 }\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"objectvalues\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#objectvalues\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eObject.values()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; [ 1, 2, 3 ]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; { a: 1, b: 2, c: 3 }\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"引数破壊\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BC%95%E6%95%B0%E7%A0%B4%E5%A3%8A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e引数破壊\u003c/h3\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"-objectassign\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#-objectassign\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cfont color=\"OrangeRed\"\u003e*\u003c/font\u003e \u003ccode\u003eObject.assign()\u003c/code\u003e\n\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eassign\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; { a: 1, b: 4, c: 5 }\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; { a: 1, b: 4, c: 5 }\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eobject2\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; { b: 4, c: 5 }\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e補足: 破壊したくない場合\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eassign\u003c/span\u003e\u003cspan class=\"p\"\u003e({},\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eobject2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; { a: 1, b: 4, c: 5 }\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eobject1\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; { a: 1, b: 2 }\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eobject2\u003c/span\u003e \u003cspan class=\"c1\"\u003e// =\u0026gt; { b: 4, c: 5 }\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e\u003cfont color=\"Gray\"\u003e(戻り値があるくせに引数破壊してくるとかどうかしてるぜ。)\u003c/font\u003e\u003c/p\u003e\n","body":"毎回調べているので、自分用にまとめ。\n\n個人的に要注意のところは\u003cfont color=\"OrangeRed\"\u003e*\u003c/font\u003eがついています。\n\n先に結論を言ってしまうと、ファイルサイズを気にしなくていいときは素直にlodashを使おう。\nElmの使用も検討しよう。\n\n動作確認: node v10.16.0(LTS)\n\n## Array\n\n### 非破壊\n\n#### `Array.prototype.concat()`\n\n```js\nlet array1 = ['a', 'b', 'c']\nlet array2 = ['d', 'e', 'f']\narray1.concat(array2) // =\u003e [ 'a', 'b', 'c', 'd', 'e', 'f' ]\narray1 // =\u003e [ 'a', 'b', 'c' ]\narray2 // =\u003e [ 'd', 'e', 'f' ]\n```\n\n#### `Array.prototype.filter()`\n\n```js\nlet array1 = ['spray', 'limit', 'elite', 'exuberant', 'destruction', 'present']\narray1.filter(word =\u003e word.length \u003e 6) // =\u003e [ 'exuberant', 'destruction', 'present' ]\narray1 // =\u003e [ 'spray', 'limit', 'elite', 'exuberant', 'destruction', 'present' ]\n```\n\n#### `Array.prototype.find()`\n\n```js\nlet array1 = [5, 12, 8, 130, 44]\narray1.find(function(element) { return element \u003e 10; }) // =\u003e 12\narray1 // =\u003e [ 5, 12, 8, 130, 44 ]\n```\n\n#### `Array.prototype.findIndex()`\n\n```js\nlet array1 = [5, 12, 8, 130, 44]\narray1.findIndex(function(element) { return element \u003e 10; }) // =\u003e 1\narray1 // =\u003e [ 5, 12, 8, 130, 44 ]\n```\n\n#### `Array.prototype.map()`\n\n```js\nlet array1 = [5, 12, 8, 130, 44]\narray1.map(x =\u003e x * 2) // =\u003e [ 10, 24, 16, 260, 88 ]\narray1 // =\u003e [ 5, 12, 8, 130, 44 ]\n```\n\n#### `Array.prototype.join()`\n\n```js\nlet array = ['Fire', 'Air', 'Water']\narray.join() // =\u003e 'Fire,Air,Water'\narray // =\u003e [ 'Fire', 'Air', 'Water' ]\n```\n\n#### `Array.prototype.reduce()`\n\n```js\nlet array1 = [1, 2, 3, 4]\narray1.reduce((acc, current) =\u003e acc + current) // =\u003e 10\narray1 // =\u003e [ 1, 2, 3, 4 ]\n```\n\n#### `Array.prototype.slice()`\n\n```js\nlet array1 = ['ant', 'bison', 'camel', 'duck', 'elephant']\narray1.slice(2, 4) // =\u003e [ 'camel', 'duck' ]\narray1 // =\u003e [ 'ant', 'bison', 'camel', 'duck', 'elephant' ]\n```\n\n### レシーバ破壊\n\n#### `Array.prototype.pop()`\n\n```js\nlet array1 = ['a', 'b', 'c']\narray1.pop() // =\u003e 'c'\narray1 // =\u003e [ 'a', 'b' ]\n```\n\n#### `Array.prototype.push()`\n\n```js\nlet array1 = ['a', 'b', 'c']\narray1.push('d') // =\u003e 4\narray1 // =\u003e [ 'a', 'b', 'c', 'd' ]\n```\n\n#### `Array.prototype.shift()`\n\n```js\nlet array1 = ['a', 'b', 'c']\narray1.shift() // =\u003e 'a'\narray1 // =\u003e [ 'b', 'c' ]\n```\n\n#### `Array.prototype.splice()`\n\n```js\nlet array1 = ['a', 'b', 'c']\narray1.splice(2, 1, 'x') // =\u003e [ 'c' ]\narray1 // =\u003e [ 'a', 'b', 'x' ]\n```\n\n#### `Array.prototype.unshift()`\n\n```js\nlet array1 = ['a', 'b', 'c']\narray1.unshift('x', 'y', 'z') // =\u003e 6\narray1 // =\u003e [ 'x', 'y', 'z', 'a', 'b', 'c' ]\n```\n\n#### \u003cfont color=\"OrangeRed\"\u003e*\u003c/font\u003e `Array.prototype.reverse()`\n\n```js\nlet array1 = ['a', 'b', 'c']\narray1.reverse() // =\u003e [ 'c', 'b', 'a' ]\narray1 // =\u003e [ 'c', 'b', 'a' ]\n```\n\n#### \u003cfont color=\"OrangeRed\"\u003e*\u003c/font\u003e `Array.prototype.sort()`\n\n```js\nlet array1 = [1, 30, 4, 21, 100000]\narray1.sort() // =\u003e [ 1, 100000, 21, 30, 4 ]\narray1 // =\u003e [ 1, 100000, 21, 30, 4 ]\n```\n\n---\n\n\u003cfont color=\"Gray\"\u003e(戻り値があるくせにレシーバ破壊してくるとか正気かよ。)\u003c/font\u003e\n\n## Object\n\n### 非破壊\n\n#### `Object.keys()`\n\n```js\nlet object1 = { a: 1, b: 2, c: 3 }\nObject.keys(object1) // =\u003e [ 'a', 'b', 'c' ]\nobject1 // =\u003e { a: 1, b: 2, c: 3 }\n```\n\n#### `Object.values()`\n\n```js\nlet object1 = { a: 1, b: 2, c: 3 }\nObject.values(object1) // =\u003e [ 1, 2, 3 ]\nobject1 // =\u003e { a: 1, b: 2, c: 3 }\n```\n\n### 引数破壊\n\n#### \u003cfont color=\"OrangeRed\"\u003e*\u003c/font\u003e `Object.assign()`\n\n```js\nlet object1 = { a: 1, b: 2 }\nlet object2 = { b: 4, c: 5 }\nObject.assign(object1, object2) // =\u003e { a: 1, b: 4, c: 5 }\nobject1 // =\u003e { a: 1, b: 4, c: 5 }\nobject2 // =\u003e { b: 4, c: 5 }\n```\n\n補足: 破壊したくない場合\n\n```js\nlet object1 = { a: 1, b: 2 }\nlet object2 = { b: 4, c: 5 }\nObject.assign({}, object1, object2) // =\u003e { a: 1, b: 4, c: 5 }\nobject1 // =\u003e { a: 1, b: 2 }\nobject2 // =\u003e { b: 4, c: 5 }\n```\n\n---\n\n\u003cfont color=\"Gray\"\u003e(戻り値があるくせに引数破壊してくるとかどうかしてるぜ。)\u003c/font\u003e\n","coediting":false,"comments_count":0,"created_at":"2019-09-02T19:34:52+09:00","group":null,"id":"125cc9d26a2578bc7526","likes_count":3,"private":false,"reactions_count":0,"tags":[{"name":"JavaScript","versions":[]},{"name":"ECMAScript","versions":[]},{"name":"es6","versions":[]},{"name":"es2015","versions":[]}],"title":"JavaScript(ECMAScript)の破壊/非破壊関数まとめ","updated_at":"2019-09-02T19:34:52+09:00","url":"https://qiita.com/isuke/items/125cc9d26a2578bc7526","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eElectronで半透明なウィンドウを作る方法を調べても古い方法しかなかなか見つからなかったので、最新のやり方をメモしておきます。\u003cbr\u003e\n2019/03 現在のバージョン(\u003ccode\u003e4.1\u003c/code\u003e系)ではウィンドウを半透明にするために\u003cstrong\u003eCSSを使う必要はありません\u003c/strong\u003e。\u003c/p\u003e\n\n\u003cp\u003e２つ方法があります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"方法1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%B9%E6%B3%951\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e方法1\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003ewin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eBrowserWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e800\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e600\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eopacity\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mf\"\u003e0.5\u003c/span\u003e \u003cspan class=\"c1\"\u003e// これだけ！\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれだけでウィンドウが半透明になります。1で不透明、0で完全に透明です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"方法2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%B9%E6%B3%952\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e方法2\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003ewin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eBrowserWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e800\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e600\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003etransparent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"c1\"\u003e// これと\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ebackgroundColor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e80FFFFFF\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e \u003cspan class=\"c1\"\u003e// これだけ！\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこちらの方法の場合、背景色だけが半透明になるので、その上の要素(文字など)は半透明になりません。\u003cbr\u003e\n\u003ccode\u003ebackgroundColor\u003c/code\u003eの値はCSSと違い\u003ccode\u003eARGB\u003c/code\u003e(Alphaが最初)な点に注意しましょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h3\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://electronjs.org/docs/api/browser-window?q=mouseleave#new-browserwindowoptions\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://electronjs.org/docs/api/browser-window?q=mouseleave#new-browserwindowoptions\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","body":"Electronで半透明なウィンドウを作る方法を調べても古い方法しかなかなか見つからなかったので、最新のやり方をメモしておきます。\n2019/03 現在のバージョン(`4.1`系)ではウィンドウを半透明にするために**CSSを使う必要はありません**。\n\n２つ方法があります。\n\n## 方法1\n\n```js\nwin = new BrowserWindow({\n  width: 800,\n  height: 600,\n  opacity: 0.5 // これだけ！\n})\n```\n\nこれだけでウィンドウが半透明になります。1で不透明、0で完全に透明です。\n\n## 方法2\n\n```js\nwin = new BrowserWindow({\n  width: 800,\n  height: 600,\n  transparent: true, // これと\n  backgroundColor: '80FFFFFF' // これだけ！\n})\n```\n\nこちらの方法の場合、背景色だけが半透明になるので、その上の要素(文字など)は半透明になりません。\n`backgroundColor`の値はCSSと違い`ARGB`(Alphaが最初)な点に注意しましょう。\n\n### 参考\n\n- https://electronjs.org/docs/api/browser-window?q=mouseleave#new-browserwindowoptions\n","coediting":false,"comments_count":0,"created_at":"2019-03-27T15:26:20+09:00","group":null,"id":"ddc5791ce62cda3f7822","likes_count":4,"private":false,"reactions_count":0,"tags":[{"name":"JavaScript","versions":[]},{"name":"Electron","versions":[]}],"title":"Electronで半透明なウィンドウを作る方法 2019年版","updated_at":"2019-03-27T15:26:20+09:00","url":"https://qiita.com/isuke/items/ddc5791ce62cda3f7822","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eタイトル通りなのでとりあえず結果を見てもらいましょう。\u003c/p\u003e\n\n\u003cp class=\"codepen\" data-height=\"265\" data-default-tab=\"js,result\" data-slug-hash=\"EMNpVM\"\u003e\n  See the Pen \u003ca href=\"https://codepen.io/isuke/pen/EMNpVM/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\n  EMNpVM\u003c/a\u003e by isuke (\u003ca href=\"https://codepen.io/isuke\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@isuke\u003c/a\u003e)\n  on \u003ca href=\"https://codepen.io\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCodePen\u003c/a\u003e.\n\u003c/p\u003e\n\n\u003cscript async src=\"https://static.codepen.io/assets/embed/ei.js\"\u003e\u003c/script\u003e\n\n\u003cp\u003e実行結果 ↓\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Ff1eed6b2-316d-79f4-87a5-be61b4d89858.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ac2cc1c36adc1051df6aed4213412e0a\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Ff1eed6b2-316d-79f4-87a5-be61b4d89858.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ac2cc1c36adc1051df6aed4213412e0a\" alt=\"スクリーンショット 2019-03-06 8.53.06.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/f1eed6b2-316d-79f4-87a5-be61b4d89858.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Ff1eed6b2-316d-79f4-87a5-be61b4d89858.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d793c072ccd9cdca7e8636a4ba0b42c9 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e正確な測定ではないですが明らかな速度の違いがわかります。\u003c/p\u003e\n\n\u003cp\u003eと、言うことで大きなObjectを扱うときは\u003ccode\u003eObject.freeze\u003c/code\u003eするといいよ。\u003c/p\u003e\n\n\u003cp\u003e\u003cfont color=\"Gray\"\u003e(新旧の差をとって、差分だけ更新しようとしていた私の苦労は何だったんだ。)\u003c/font\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ちょっと注意\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%A1%E3%82%87%E3%81%A3%E3%81%A8%E6%B3%A8%E6%84%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eちょっと注意\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e件のObjectをレンダリングする場合はこれをしてもボトルネックの解消にはならない可能性があります。結局レンダリングに時間かかっちゃいますからね。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003edevtools\u003c/code\u003eが有効になっているかどうかで結果に差があるかもです。\u003ccode\u003edevtools\u003c/code\u003eがゴニョゴニョしているかもしれないので。\u003c/li\u003e\n\u003cli\u003evuexの場合、\u003ccode\u003estrict\u003c/code\u003eモードが有効かどうかで結果に差があるかもです。\u003ca href=\"https://vuex.vuejs.org/ja/guide/strict.html#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83-vs-%E6%9C%AC%E7%95%AA%E7%92%B0%E5%A2%83\" rel=\"nofollow noopener\" target=\"_blank\"\u003e参考1\u003c/a\u003e \u003ca href=\"https://forum.vuejs.org/t/adding-many-objects-to-vuex-state-is-slow/10492\" rel=\"nofollow noopener\" target=\"_blank\"\u003e参考2\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/vuejs/vue/issues/4384\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/vuejs/vue/issues/4384\u003c/a\u003e\u003c/p\u003e\n","body":"タイトル通りなのでとりあえず結果を見てもらいましょう。\n\n\u003cp class=\"codepen\" data-height=\"265\" data-theme-id=\"0\" data-default-tab=\"js,result\" data-user=\"isuke\" data-slug-hash=\"EMNpVM\" style=\"height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid black; margin: 1em 0; padding: 1em;\" data-pen-title=\"EMNpVM\"\u003e\n  \u003cspan\u003eSee the Pen \u003ca href=\"https://codepen.io/isuke/pen/EMNpVM/\"\u003e\n  EMNpVM\u003c/a\u003e by isuke (\u003ca href=\"https://codepen.io/isuke\"\u003e@isuke\u003c/a\u003e)\n  on \u003ca href=\"https://codepen.io\"\u003eCodePen\u003c/a\u003e.\u003c/span\u003e\n\u003c/p\u003e\n\u003cscript async src=\"https://static.codepen.io/assets/embed/ei.js\"\u003e\u003c/script\u003e\n\n実行結果 ↓\n\n![スクリーンショット 2019-03-06 8.53.06.png](https://qiita-image-store.s3.amazonaws.com/0/152997/f1eed6b2-316d-79f4-87a5-be61b4d89858.png)\n\n正確な測定ではないですが明らかな速度の違いがわかります。\n\nと、言うことで大きなObjectを扱うときは`Object.freeze`するといいよ。\n\n\u003cfont color=\"Gray\"\u003e(新旧の差をとって、差分だけ更新しようとしていた私の苦労は何だったんだ。)\u003c/font\u003e\n\n## ちょっと注意\n\n- 件のObjectをレンダリングする場合はこれをしてもボトルネックの解消にはならない可能性があります。結局レンダリングに時間かかっちゃいますからね。\n- `devtools`が有効になっているかどうかで結果に差があるかもです。`devtools`がゴニョゴニョしているかもしれないので。\n- vuexの場合、`strict`モードが有効かどうかで結果に差があるかもです。[参考1](https://vuex.vuejs.org/ja/guide/strict.html#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83-vs-%E6%9C%AC%E7%95%AA%E7%92%B0%E5%A2%83) [参考2](https://forum.vuejs.org/t/adding-many-objects-to-vuex-state-is-slow/10492)\n\n## 参考\n\nhttps://github.com/vuejs/vue/issues/4384\n","coediting":false,"comments_count":0,"created_at":"2019-03-06T09:04:17+09:00","group":null,"id":"441c21e7f99e3a619803","likes_count":11,"private":false,"reactions_count":0,"tags":[{"name":"JavaScript","versions":[]},{"name":"Vue.js","versions":[]},{"name":"performance","versions":[]}],"title":"Vue.jsで大きなObjectを扱うときはObject.freezeすると100倍くらい速くなるよ","updated_at":"2019-03-06T09:17:19+09:00","url":"https://qiita.com/isuke/items/441c21e7f99e3a619803","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e(この人、2019年になってもまだCoffeeScriptつかっている・・・。)\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"dynamic-importって\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#dynamic-import%E3%81%A3%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003eDynamic Import\u003c/code\u003eって？\u003c/h2\u003e\n\n\u003cp\u003eモダンブラウザで使える、必要になったときに非同期でモジュールをインポートできるやつです。\u003cbr\u003e\n以下のように使えます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ejavascript\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003ejsziptools/zip\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003ethen\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eunpack\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// or\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003easync\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e \u003cspan class=\"nx\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003ezip\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003ejsziptools/zip\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eunpack\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"coffeescript2で\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#coffeescript2%E3%81%A7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCoffeeScript2で\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003eDynamic Import\u003c/code\u003eはCoffeeScript2ではまだ実装されていません(v2.3.2時点)。\u003cbr\u003e\nなので\u003ca href=\"https://coffeescript.org/v2/#embedded\" rel=\"nofollow noopener\" target=\"_blank\"\u003eEmbedded JavaScript\u003c/a\u003e機能を使う必要があります。\u003cbr\u003e\nCoffeeScript2では\u003ccode\u003e``\u003c/code\u003eで囲った部分がJavaScriptとして解釈されます。\u003cbr\u003e\nなので上記のJavaScriptの例はCoffeeScript2では以下のように書けます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eCoffeeScript2\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"jsziptools/zip\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ethen\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eunpack\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# or\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ezip\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eawait\u003c/span\u003e \u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\"jsziptools/zip\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ezip\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eunpack\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e以上です。\u003c/p\u003e\n","body":"(この人、2019年になってもまだCoffeeScriptつかっている・・・。)\n\n## `Dynamic Import`って？\n\nモダンブラウザで使える、必要になったときに非同期でモジュールをインポートできるやつです。\n以下のように使えます。\n\n```js:javascript\nimport(\"jsziptools/zip\").then((zip) =\u003e {\n  zip.unpack(hoge)\n})\n\n// or\n\nasync function foo() {\n  const zip = await import(\"jsziptools/zip\")\n  zip.unpack(hoge)\n}\n```\n\n## CoffeeScript2で\n\n`Dynamic Import`はCoffeeScript2ではまだ実装されていません(v2.3.2時点)。\nなので[Embedded JavaScript](https://coffeescript.org/v2/#embedded)機能を使う必要があります。\nCoffeeScript2では``` `` ```で囲った部分がJavaScriptとして解釈されます。\nなので上記のJavaScriptの例はCoffeeScript2では以下のように書けます。\n\n```coffeescript:CoffeeScript2\n`import(\"jsziptools/zip\")`.then (zip) =\u003e\n    zip.unpack(hoge)\n\n# or\n\nfoo() -\u003e\n  zip = await `import(\"jsziptools/zip\")`\n  zip.unpack(hoge)\n```\n\n以上です。\n","coediting":false,"comments_count":0,"created_at":"2019-02-16T15:06:00+09:00","group":null,"id":"dcb599b462901e047f76","likes_count":1,"private":false,"reactions_count":0,"tags":[{"name":"JavaScript","versions":[]},{"name":"CoffeeScript","versions":[]},{"name":"es2015","versions":[]},{"name":"CoffeeScript2","versions":[]}],"title":"CoffeeScript2でDynamic Importする方法","updated_at":"2019-02-17T22:11:13+09:00","url":"https://qiita.com/isuke/items/dcb599b462901e047f76","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e「\u003ccode\u003egit log --pretty=format\u003c/code\u003e で tagを表示する」とはつまり、\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e[2018-07-27 23:13:04 +0900] ec017df : Merge branch 'b3.3_4.6'\n[2018-07-10 23:09:09 +0900] cc0b4f3 : Fix IncursionMods\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e↑を↓にしたいってことです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e[2018-07-27 23:13:04 +0900] ec017df : Merge branch 'b3.3_4.6' tag: v3.3_4.6\n[2018-07-10 23:09:09 +0900] cc0b4f3 : Fix IncursionMods\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"tldr\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#tldr\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003etl;dr\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c\"\u003e# 色なし\u003c/span\u003e\ngit log \u003cspan class=\"nt\"\u003e--pretty\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eformat:\u003cspan class=\"s1\"\u003e'[%ad] %h : %s %D'\u003c/span\u003e \u003cspan class=\"nt\"\u003e--date\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eiso \u003cspan class=\"nt\"\u003e--decorate-refs\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003etags\n\n\u003cspan class=\"c\"\u003e# 色付き\u003c/span\u003e\ngit log \u003cspan class=\"nt\"\u003e--pretty\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eformat:\u003cspan class=\"s1\"\u003e'%C(yellow)[%ad] %C(green)%h %Creset: %s %C(red)%D%Creset'\u003c/span\u003e \u003cspan class=\"nt\"\u003e--date\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eiso \u003cspan class=\"nt\"\u003e--decorate-refs\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003etags\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"解説\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003e%D\u003c/code\u003eを使うと\u003ccode\u003eref name\u003c/code\u003eとやらが表示されます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003egit log \u003cspan class=\"nt\"\u003e--pretty\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eformat:\u003cspan class=\"s1\"\u003e'[%ad] %h : %s %D'\u003c/span\u003e \u003cspan class=\"nt\"\u003e--date\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eiso\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e2018-07-27 23:13:04 +0900] ec017df : Merge branch \u003cspan class=\"s1\"\u003e'b3.3_4.6'\u003c/span\u003e HEAD -\u0026gt; master, tag: v3.3_4.6, origin/master\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこんな感じ(\u003ccode\u003eHEAD -\u0026gt; master, tag: v3.3_4.6, origin/master\u003c/code\u003eの部分)。\u003c/p\u003e\n\n\u003cp\u003eちなみに\u003ccode\u003e%d\u003c/code\u003eもあってちょっとフォーマットがちょっと違います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003egit log \u003cspan class=\"nt\"\u003e--pretty\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eformat:\u003cspan class=\"s1\"\u003e'[%ad] %h : %s %d'\u003c/span\u003e \u003cspan class=\"nt\"\u003e--date\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eiso\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e2018-07-27 23:13:04 +0900] ec017df : Merge branch \u003cspan class=\"s1\"\u003e'b3.3_4.6'\u003c/span\u003e  \u003cspan class=\"o\"\u003e(\u003c/span\u003eHEAD -\u0026gt; master, tag: v3.3_4.6, origin/master\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eで、これが\u003ccode\u003eHEAD\u003c/code\u003eとかリモートとかが混ざっていて邪魔。タグだけでいいのに。\u003c/p\u003e\n\n\u003cp\u003eそんなとき\u003ccode\u003e--decorate-refs=\u003c/code\u003e オプションを使うことで\u003ccode\u003e%D\u003c/code\u003e, \u003ccode\u003e%d\u003c/code\u003eで表示するものを制御できます。\u003cbr\u003e\n\u003ccode\u003e--decorate-refs=tags\u003c/code\u003eだとタグだけになるわけですね。\u003c/p\u003e\n\n\u003cp\u003eこのオプションの引数は\u003ccode\u003etags\u003c/code\u003e以外には\u003ccode\u003eheads\u003c/code\u003eと\u003ccode\u003eremotes\u003c/code\u003eがあるみたいです。\u003c/p\u003e\n\n\u003cp\u003eお試しあれ。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"参考資料\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考資料\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://git-scm.com/docs/git-log\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://git-scm.com/docs/git-log\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","body":"\n「`git log --pretty=format` で tagを表示する」とはつまり、\n\n```\n[2018-07-27 23:13:04 +0900] ec017df : Merge branch 'b3.3_4.6'\n[2018-07-10 23:09:09 +0900] cc0b4f3 : Fix IncursionMods\n```\n\n↑を↓にしたいってことです。\n\n```\n[2018-07-27 23:13:04 +0900] ec017df : Merge branch 'b3.3_4.6' tag: v3.3_4.6\n[2018-07-10 23:09:09 +0900] cc0b4f3 : Fix IncursionMods\n```\n\n## tl;dr\n\n```sh\n# 色なし\ngit log --pretty=format:'[%ad] %h : %s %D' --date=iso --decorate-refs=tags\n\n# 色付き\ngit log --pretty=format:'%C(yellow)[%ad] %C(green)%h %Creset: %s %C(red)%D%Creset' --date=iso --decorate-refs=tags\n```\n\n## 解説\n\n`%D`を使うと`ref name`とやらが表示されます。\n\n```sh\n$ git log --pretty=format:'[%ad] %h : %s %D' --date=iso\n[2018-07-27 23:13:04 +0900] ec017df : Merge branch 'b3.3_4.6' HEAD -\u003e master, tag: v3.3_4.6, origin/master\n```\n\nこんな感じ(`HEAD -\u003e master, tag: v3.3_4.6, origin/master`の部分)。\n\nちなみに`%d`もあってちょっとフォーマットがちょっと違います。\n\n```sh\n$ git log --pretty=format:'[%ad] %h : %s %d' --date=iso\n[2018-07-27 23:13:04 +0900] ec017df : Merge branch 'b3.3_4.6'  (HEAD -\u003e master, tag: v3.3_4.6, origin/master)\n```\n\nで、これが`HEAD`とかリモートとかが混ざっていて邪魔。タグだけでいいのに。\n\nそんなとき`--decorate-refs=` オプションを使うことで`%D`, `%d`で表示するものを制御できます。\n`--decorate-refs=tags`だとタグだけになるわけですね。\n\nこのオプションの引数は`tags`以外には`heads`と`remotes`があるみたいです。\n\nお試しあれ。\n\n## 参考資料\n\n- https://git-scm.com/docs/git-log\n","coediting":false,"comments_count":0,"created_at":"2018-08-23T20:08:54+09:00","group":null,"id":"35b192b0899872aa7b03","likes_count":5,"private":false,"reactions_count":0,"tags":[{"name":"Git","versions":[]},{"name":"小ネタ","versions":[]}],"title":"`git log --pretty=format` で tagを表示する方法","updated_at":"2018-09-17T18:56:06+09:00","url":"https://qiita.com/isuke/items/35b192b0899872aa7b03","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ccode\u003erspec-rails\u003c/code\u003e 3.7でsystem specが追加されてfailしたら自動でschreenshotを取ってくれて便利なんですが、いくつか問題があったので\u003cstrong\u003e雑に\u003c/strong\u003e修正しました。\u003c/p\u003e\n\n\u003cp\u003e注意) 当記事では著者が書いたコードを指して(パッチの当て方や文字列の末尾を取得しているところなどを)「雑に」と言っています。\u003cbr\u003e\n参考にさせていただいた記事を指しているわけでは決してありません。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/g-fujioka/items/091c400814800f1280ff\" id=\"reference-40cb8530cd3f982a54ea\"\u003eCapybara+headless-chrome でフルサイズのスクリーンショットを撮る\u003c/a\u003eは素晴らしい記事です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ファイル名が長すぎてエラーになる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%90%8D%E3%81%8C%E9%95%B7%E3%81%99%E3%81%8E%E3%81%A6%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%AA%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファイル名が長すぎてエラーになる。\u003c/h2\u003e\n\n\u003cp\u003erspecのネストが深くなるとschreenshotのファイル名が長くなりすぎてエラーが発生してしまいます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/rails/rails/issues/32346\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/rails/rails/issues/32346\u003c/a\u003e\u003cbr\u003e\nこちらでissueがあがっているんですが、\u003ccode\u003e5.2.1 milestone\u003c/code\u003e から外されてしまい、対応は少し待たないといけないようです。\u003c/p\u003e\n\n\u003cp\u003e仕方ないのでモンキーパッチで雑に対応します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e# frozen_string_literal: true\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'action_dispatch/system_testing/test_helpers/screenshot_helper'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003eActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eLINUX_MAX_FILE_NAME_LENGTH\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e255\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eEXT_NAME\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e'.png'\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e# https://github.com/rails/rails/blob/a3ecf4ff1dbb92259e1627bdd09546211f25d906/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L24\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etake_screenshot\u003c/span\u003e\n    \u003cspan class=\"n\"\u003esave_image\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003edisplay_image\u003c/span\u003e\n  \u003cspan class=\"k\"\u003erescue\u003c/span\u003e \u003cspan class=\"no\"\u003eErrno\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eENAMETOOLONG\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emax_length\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eLINUX_MAX_FILE_NAME_LENGTH\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"no\"\u003eEXT_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elength\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eomitted_image_name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eimage_name\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003emax_length\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emax_length\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eRails\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eroot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"tmp/screenshots/\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eomitted_image_name\u003c/span\u003e\u003cspan class=\"si\"\u003e}#{\u003c/span\u003e\u003cspan class=\"no\"\u003eEXT_NAME\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esave_screenshot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"[Screenshot]: \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのファイルを\u003ccode\u003espec/support\u003c/code\u003eにおいて、読み込んであげればOKです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"headless-chrome-でフルサイズのスクリーンショットが撮れない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#headless-chrome-%E3%81%A7%E3%83%95%E3%83%AB%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%AE%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%E3%81%8C%E6%92%AE%E3%82%8C%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eheadless-chrome でフルサイズのスクリーンショットが撮れない\u003c/h2\u003e\n\n\u003cp\u003eフルサイズのスクリーンショットを取るためにはcapybaraの\u003ccode\u003esave_screenshot\u003c/code\u003eに\u003ccode\u003efull: true\u003c/code\u003eのオプションを与える必要があるのですが、何故かそうなっていません。↓\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/rails/rails/blob/a3ecf4ff1dbb92259e1627bdd09546211f25d906/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L54\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/rails/rails/blob/a3ecf4ff1dbb92259e1627bdd09546211f25d906/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L54\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eしかも、現状 headless-chrome だと\u003ccode\u003efull: true\u003c/code\u003eのオプションを与えてもフルサイズのスクリーンショットが撮れないようです。\u003c/p\u003e\n\n\u003cp\u003eこちらの記事(\u003ca href=\"https://qiita.com/g-fujioka/items/091c400814800f1280ff\"\u003eCapybara+headless-chrome でフルサイズのスクリーンショットを撮る\u003c/a\u003e)を参考に更にモンキーパッチを当てます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e# frozen_string_literal: true\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'action_dispatch/system_testing/test_helpers/screenshot_helper'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003eActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eLINUX_MAX_FILE_NAME_LENGTH\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e255\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eEXT_NAME\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e'.png'\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e# https://github.com/rails/rails/blob/a3ecf4ff1dbb92259e1627bdd09546211f25d906/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L24\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etake_screenshot\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresize_window_to_full_screen\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003esave_image\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003edisplay_image\u003c/span\u003e\n  \u003cspan class=\"k\"\u003erescue\u003c/span\u003e \u003cspan class=\"no\"\u003eErrno\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eENAMETOOLONG\u003c/span\u003e\n    \u003cspan class=\"n\"\u003emax_length\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eLINUX_MAX_FILE_NAME_LENGTH\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"no\"\u003eEXT_NAME\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elength\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eomitted_image_name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eimage_name\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003emax_length\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emax_length\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003epath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eRails\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eroot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"tmp/screenshots/\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eomitted_image_name\u003c/span\u003e\u003cspan class=\"si\"\u003e}#{\u003c/span\u003e\u003cspan class=\"no\"\u003eEXT_NAME\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003epage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esave_screenshot\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"[Screenshot]: \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003epath\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"kp\"\u003eprivate\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e# https://qiita.com/g-fujioka/items/091c400814800f1280ff\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eresize_window_to_full_screen\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# rubocop:disable Metrics/LineLength\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eCapybara\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003epage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eexecute_script\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'return Math.max(document.body.scrollWidth , document.body.offsetWidth , document.documentElement.clientWidth , document.documentElement.scrollWidth , document.documentElement.offsetWidth);'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eheight\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eCapybara\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003epage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eexecute_script\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'return Math.max(document.body.scrollHeight, document.body.offsetHeight, document.documentElement.clientHeight, document.documentElement.scrollHeight, document.documentElement.offsetHeight);'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# rubocop:enable Metrics/LineLength\u003c/span\u003e\n\n    \u003cspan class=\"no\"\u003eCapybara\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecurrent_session\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edriver\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebrowser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emanage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eresize_to\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれでフルサイズのスクリーンショットが撮れるようになりました。\u003c/p\u003e\n\n\u003cp\u003e快適！\u003c/p\u003e\n","body":"`rspec-rails` 3.7でsystem specが追加されてfailしたら自動でschreenshotを取ってくれて便利なんですが、いくつか問題があったので**雑に**修正しました。\n\n注意) 当記事では著者が書いたコードを指して(パッチの当て方や文字列の末尾を取得しているところなどを)「雑に」と言っています。\n参考にさせていただいた記事を指しているわけでは決してありません。\n[Capybara+headless-chrome でフルサイズのスクリーンショットを撮る](https://qiita.com/g-fujioka/items/091c400814800f1280ff)は素晴らしい記事です。\n\n## ファイル名が長すぎてエラーになる。\n\nrspecのネストが深くなるとschreenshotのファイル名が長くなりすぎてエラーが発生してしまいます。\n\nhttps://github.com/rails/rails/issues/32346\nこちらでissueがあがっているんですが、`5.2.1 milestone` から外されてしまい、対応は少し待たないといけないようです。\n\n仕方ないのでモンキーパッチで雑に対応します。\n\n```rb\n# frozen_string_literal: true\n\nrequire 'action_dispatch/system_testing/test_helpers/screenshot_helper'\n\nmodule ActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper\n  LINUX_MAX_FILE_NAME_LENGTH = 255\n  EXT_NAME = '.png'\n\n  # https://github.com/rails/rails/blob/a3ecf4ff1dbb92259e1627bdd09546211f25d906/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L24\n  def take_screenshot\n    save_image\n    puts display_image\n  rescue Errno::ENAMETOOLONG\n    max_length = LINUX_MAX_FILE_NAME_LENGTH - EXT_NAME.length\n    omitted_image_name = image_name[- max_length, max_length]\n\n    path = Rails.root.join(\"tmp/screenshots/#{omitted_image_name}#{EXT_NAME}\")\n    page.save_screenshot(path)\n\n    puts \"[Screenshot]: #{path}\"\n  end\nend\n```\n\nこのファイルを`spec/support`において、読み込んであげればOKです。\n\n## headless-chrome でフルサイズのスクリーンショットが撮れない\n\nフルサイズのスクリーンショットを取るためにはcapybaraの`save_screenshot`に`full: true`のオプションを与える必要があるのですが、何故かそうなっていません。↓\n\nhttps://github.com/rails/rails/blob/a3ecf4ff1dbb92259e1627bdd09546211f25d906/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L54\n\nしかも、現状 headless-chrome だと`full: true`のオプションを与えてもフルサイズのスクリーンショットが撮れないようです。\n\nこちらの記事([Capybara+headless-chrome でフルサイズのスクリーンショットを撮る](https://qiita.com/g-fujioka/items/091c400814800f1280ff))を参考に更にモンキーパッチを当てます。\n\n```rb\n# frozen_string_literal: true\n\nrequire 'action_dispatch/system_testing/test_helpers/screenshot_helper'\n\nmodule ActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper\n  LINUX_MAX_FILE_NAME_LENGTH = 255\n  EXT_NAME = '.png'\n\n  # https://github.com/rails/rails/blob/a3ecf4ff1dbb92259e1627bdd09546211f25d906/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L24\n  def take_screenshot\n    resize_window_to_full_screen\n\n    save_image\n    puts display_image\n  rescue Errno::ENAMETOOLONG\n    max_length = LINUX_MAX_FILE_NAME_LENGTH - EXT_NAME.length\n    omitted_image_name = image_name[- max_length, max_length]\n\n    path = Rails.root.join(\"tmp/screenshots/#{omitted_image_name}#{EXT_NAME}\")\n    page.save_screenshot(path)\n\n    puts \"[Screenshot]: #{path}\"\n  end\n\nprivate\n\n  # https://qiita.com/g-fujioka/items/091c400814800f1280ff\n  def resize_window_to_full_screen\n    # rubocop:disable Metrics/LineLength\n    width  = Capybara.page.execute_script('return Math.max(document.body.scrollWidth , document.body.offsetWidth , document.documentElement.clientWidth , document.documentElement.scrollWidth , document.documentElement.offsetWidth);')\n    height = Capybara.page.execute_script('return Math.max(document.body.scrollHeight, document.body.offsetHeight, document.documentElement.clientHeight, document.documentElement.scrollHeight, document.documentElement.offsetHeight);')\n    # rubocop:enable Metrics/LineLength\n\n    Capybara.current_session.driver.browser.manage.window.resize_to(width, height)\n  end\nend\n```\n\nこれでフルサイズのスクリーンショットが撮れるようになりました。\n\n快適！\n","coediting":false,"comments_count":0,"created_at":"2018-06-29T21:10:32+09:00","group":null,"id":"f7d78cbc9305bb99f8ef","likes_count":2,"private":false,"reactions_count":0,"tags":[{"name":"Rails","versions":[]},{"name":"RSpec","versions":[]},{"name":"Capybara","versions":[]},{"name":"rspec-rails","versions":[]},{"name":"Rails5","versions":[]}],"title":"[rails] system specにおけるtake_screenshotの問題を雑に修正する","updated_at":"2018-06-29T23:38:12+09:00","url":"https://qiita.com/isuke/items/f7d78cbc9305bb99f8ef","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ccode\u003estdout.write\u003c/code\u003e(もしくは\u003ccode\u003ewrite stdout\u003c/code\u003e)を使います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"nim\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003estdout\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewrite\u003c/span\u003e \u003cspan class=\"s\"\u003e\"input: \"\u003c/span\u003e\n\u003cspan class=\"k\"\u003elet\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ereadLine\u003c/span\u003e \u003cspan class=\"n\"\u003estdin\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eecho\u003c/span\u003e \u003cspan class=\"s\"\u003e\"your input text \"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etext\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"sh\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003enim c \u003cspan class=\"nt\"\u003e-r\u003c/span\u003e sample2.nim\ninput: foobar\nyour input text foobar\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n","body":"`stdout.write`(もしくは`write stdout`)を使います。\n\n```nim\nstdout.write \"input: \"\nlet text = readLine stdin\n\necho \"your input text \", text\n```\n\n```sh\n$ nim c -r sample2.nim\ninput: foobar\nyour input text foobar\n```\n","coediting":false,"comments_count":0,"created_at":"2018-05-27T15:46:19+09:00","group":null,"id":"97b8293a1df41320eb07","likes_count":2,"private":false,"reactions_count":0,"tags":[{"name":"小ネタ","versions":[]},{"name":"Nim","versions":[]}],"title":"Nimで改行しない標準出力","updated_at":"2018-05-27T15:46:19+09:00","url":"https://qiita.com/isuke/items/97b8293a1df41320eb07","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e普段お世話になっているwebツール達の紹介です。\u003c/p\u003e\n\n\u003cp\u003e以下のサイトはすべて\u003cstrong\u003e無料\u003c/strong\u003e\u0026amp;\u003cstrong\u003e登録不要\u003c/strong\u003eです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"正規表現\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%AD%A3%E8%A6%8F%E8%A1%A8%E7%8F%BE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e正規表現\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"regexper\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#regexper\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://regexper.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eregexper\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://regexper.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F9ff91e69-c6b2-5e2b-7985-038ac2af3d51.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=69b495ce80768034dbb814bd2bb0fb06\" alt=\"スクリーンショット 2018-05-10 23.39.05.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/9ff91e69-c6b2-5e2b-7985-038ac2af3d51.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F9ff91e69-c6b2-5e2b-7985-038ac2af3d51.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4ff1b8ca81507d9f7b53a0da25a3ffa5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003e正規表現を可視化してくれます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e複雑な正規表現を書くときやコードリーディングのお供に重宝します。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"rubular\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rubular\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"http://www.rubular.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eRubular\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.rubular.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fbf719f69-7cbc-86ba-01c9-111060bf3bd0.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6902b114809f8f06714524ed90863af9\" alt=\"スクリーンショット 2018-05-10 23.49.38.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/bf719f69-7cbc-86ba-01c9-111060bf3bd0.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fbf719f69-7cbc-86ba-01c9-111060bf3bd0.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=40aefc6bbc882f7f1bc3831de26cc8f4 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eRubyの正規表現をテストできます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"json\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#json\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eJSON\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"json-formatter--validator\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#json-formatter--validator\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://jsonformatter.curiousconcept.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eJSON FORMATTER \u0026amp; VALIDATOR\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003eJSON系のツールが集まったサイト。\u003cbr\u003e\nそれぞれ、サイト名とドメインが違うのでリンクはそのうちの１つになっています。\u003cbr\u003e\n(画像クリックでそれぞれのツールに飛べます。)\u003c/p\u003e\n\n\u003cp\u003eひとつずつ紹介します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://jsonformatter.curiousconcept.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F1f922598-6ca1-6aec-ec15-adfab16f2b25.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=73b19a9eb39ce837cef46570ead0edc0\" alt=\"screely-curiousconcept1.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/1f922598-6ca1-6aec-ec15-adfab16f2b25.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F1f922598-6ca1-6aec-ec15-adfab16f2b25.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=27c02ee854869b1b5230be4a08720eb0 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eJSONをフォーマットしてくれます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e出力結果は折りたたむことができるので、長いJSONを読むときにも便利です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://dataconverter.curiousconcept.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F8bf19aa6-b840-c9c0-1bfc-9cd9e111cba3.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=571184035ad6da585c005cd965777c27\" alt=\"screely-curiousconcept2.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/8bf19aa6-b840-c9c0-1bfc-9cd9e111cba3.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F8bf19aa6-b840-c9c0-1bfc-9cd9e111cba3.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=44d81996f8e2f5cfe87259136e116a5b 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eJSONを含めた様々なデータ形式を変換できます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eInputの以下に対応。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCSV\u003c/li\u003e\n\u003cli\u003eINI\u003c/li\u003e\n\u003cli\u003eJSON\u003c/li\u003e\n\u003cli\u003eXML\u003c/li\u003e\n\u003cli\u003eYAML\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eOutputは以下に対応。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eJSON\u003c/li\u003e\n\u003cli\u003ePHP Code\u003c/li\u003e\n\u003cli\u003ePHP Serialized\u003c/li\u003e\n\u003cli\u003eXML\u003c/li\u003e\n\u003cli\u003eYAML\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ca href=\"https://jsonpath.curiousconcept.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F1b28a6cb-0a21-5d9f-65ba-0a2e9357caa5.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=4a411fb0a0ed2d8ab3fa055d378b5019\" alt=\"screely-curiousconcept3.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/1b28a6cb-0a21-5d9f-65ba-0a2e9357caa5.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F1b28a6cb-0a21-5d9f-65ba-0a2e9357caa5.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d115619e078ec45ece97e3eb361d0f9f 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003e\u003ca href=\"https://github.com/json-path/JsonPath\" rel=\"nofollow noopener\" target=\"_blank\"\u003eJsonPath\u003c/a\u003eによるスクレイピングができます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://jsonselect.curiousconcept.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F17d6a1a0-03d4-5590-1c30-c5bbed2bcc82.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6c90adb6c67f8ec0ffbaaadc7e682e05\" alt=\"screely-curiousconcept4.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/17d6a1a0-03d4-5590-1c30-c5bbed2bcc82.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F17d6a1a0-03d4-5590-1c30-c5bbed2bcc82.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=079ad9f8c05a3768d30d421b03631200 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003e\u003ca href=\"https://github.com/lloyd/JSONSelect/blob/master/JSONSelect.md\" rel=\"nofollow noopener\" target=\"_blank\"\u003eJSONSelect\u003c/a\u003eによるスクレイピングができます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"sql\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sql\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSQL\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"instant-sql-formatter\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#instant-sql-formatter\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"http://www.dpriver.com/pp/sqlformat.htm\" rel=\"nofollow noopener\" target=\"_blank\"\u003eInstant SQL Formatter\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.dpriver.com/pp/sqlformat.htm\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F94f8ac0c-91ee-f54f-6cbf-11ac5f7b45e1.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=195c0ec1c6e935f8da075588bf743ef7\" alt=\"スクリーンショット 2018-05-11 0.07.32.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/94f8ac0c-91ee-f54f-6cbf-11ac5f7b45e1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F94f8ac0c-91ee-f54f-6cbf-11ac5f7b45e1.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a72fa716b9ecab7c20530edaa582ce53 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eSQLをフォーマットしてくれます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e細かく設定を変更できるのがナイスです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コード管理\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E7%AE%A1%E7%90%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコード管理\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"gitignoreio\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#gitignoreio\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://www.gitignore.io/\" rel=\"nofollow noopener\" target=\"_blank\"\u003egitignore.io\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.gitignore.io/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F5ddeae39-fe28-196e-e033-b51a8ffdebba.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a24e880defcfa6e413879f61ff54e231\" alt=\"screely-gitignoreio.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/5ddeae39-fe28-196e-e033-b51a8ffdebba.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F5ddeae39-fe28-196e-e033-b51a8ffdebba.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=f732dda1f3c3552fb40948c13e22d228 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003e.gitignore 作成サービス。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eプロジェクトのフレームワークなどをフォームに入力して[Create]をクリックするだけで適切な\u003ccode\u003e.gitignore\u003c/code\u003eファイルが作成できます。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003emacOS\u003c/code\u003eや\u003ccode\u003eLinux\u003c/code\u003eなど汎用的なものもあるので\u003ca href=\"https://qiita.com/pira/items/dd67077c5b414c8eb59d\" id=\"reference-b1332572d30a3628a491\"\u003eこれらは\u003ccode\u003e.gitignore_global\u003c/code\u003eとしてHomeディレクトリに置いておくと良いでしょう。\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"文字列解析\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%87%E5%AD%97%E5%88%97%E8%A7%A3%E6%9E%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e文字列解析\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"paste-a-date\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#paste-a-date\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"http://pasteadate.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePaste A Date\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://pasteadate.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F0506e4e7-01cc-ed27-d688-9c0a722bb766.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=260bf3b4b43cf422b320513066e26d72\" alt=\"screely-1529149962449.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/0506e4e7-01cc-ed27-d688-9c0a722bb766.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F0506e4e7-01cc-ed27-d688-9c0a722bb766.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6c76497e1cb382bf33fcab555ad73344 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eTimestampの文字列をパースしてくれます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eRailsなどのフレームワークを使っているとDBへのTimestampの保存はUTCに統一されていると思います。\u003cbr\u003e\nそうすると、直接DBを見ているときに「これ日本時間で何時だっけ?」なることがあります。\u003c/p\u003e\n\n\u003cp\u003eそんなときはこのサイトに貼り付ければLocal Timeで何時か表示してくれます。\u003c/p\u003e\n\n\u003cp\u003eただ、月の表記が英語なのが少々わかりにくい。\u003cbr\u003e\n誰か、そのへんまでローカライズした表記にしてくれるサイト作ってくれませんかね?\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"プログラミング言語\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E8%A8%80%E8%AA%9E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプログラミング言語\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"syntaxdb\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#syntaxdb\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://syntaxdb.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSyntaxDB\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://syntaxdb.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F254a2595-8b46-4d07-6366-3ff0b4558b93.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ec0dbf8b77c5025c678c04edbb661ac6\" alt=\"スクリーンショット 2018-05-18 23.59.06.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/254a2595-8b46-4d07-6366-3ff0b4558b93.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F254a2595-8b46-4d07-6366-3ff0b4558b93.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d75956b0942ec317a27b1cfe366643c1 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eいろんな言語のシンタックスがサンプル付きでまとめられています。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eこの言語でこれってどう書くんだっけ?ってときに便利です。\u003c/p\u003e\n\n\u003cp\u003e対応言語は以下。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eJava\u003c/li\u003e\n\u003cli\u003eC\u003c/li\u003e\n\u003cli\u003eC++\u003c/li\u003e\n\u003cli\u003eC#\u003c/li\u003e\n\u003cli\u003ePython\u003c/li\u003e\n\u003cli\u003eRuby\u003c/li\u003e\n\u003cli\u003eSwift\u003c/li\u003e\n\u003cli\u003eGo\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"デバッグ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%90%E3%83%83%E3%82%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデバッグ\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"もじばけらった\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%82%E3%81%98%E3%81%B0%E3%81%91%E3%82%89%E3%81%A3%E3%81%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"http://lab.kiki-verb.com/mojibakeratta/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eもじばけらった\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://lab.kiki-verb.com/mojibakeratta/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F02dd29c8-ac15-dc03-20c1-1f5272a46fff.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=62b72ece5b6cd0ced0c45f325330ab22\" alt=\"screely-もじばけらった.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/02dd29c8-ac15-dc03-20c1-1f5272a46fff.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F02dd29c8-ac15-dc03-20c1-1f5272a46fff.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a50851cc9e8e3ae0b0fd54b51b73c334 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003e文字化け解消ツール。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eURLエンコードされた文字をUTF-8にするときなんかにサクッと使えます。\u003cbr\u003e\n(実際の文字化けにはあんまり使えないかも・・・。)\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"web-frontend\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#web-frontend\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eWeb Frontend\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sassmeister\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sassmeister\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://www.sassmeister.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSassMeister\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.sassmeister.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F30877c05-f8ec-e46a-2add-3a4f54584bfb.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=b83ea7643d4560a73bcd5cbceaa998d8\" alt=\"スクリーンショット 2018-05-11 0.16.49.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/30877c05-f8ec-e46a-2add-3a4f54584bfb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F30877c05-f8ec-e46a-2add-3a4f54584bfb.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=94260da6c852b10765b3542619823444 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003esassをコンパイルした結果を表示してくれます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eやたら複雑なfunctionやmixinを書くハメになったときに。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"browser-screenshots--サイトが無くなっていました\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#browser-screenshots--%E3%82%B5%E3%82%A4%E3%83%88%E3%81%8C%E7%84%A1%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%A6%E3%81%84%E3%81%BE%E3%81%97%E3%81%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cdel\u003e\u003ca href=\"https://developer.microsoft.com/en-us/microsoft-edge/tools/screenshots/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eBrowser screenshots\u003c/a\u003e\u003c/del\u003e =\u0026gt; サイトが無くなっていました。\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://developer.microsoft.com/en-us/microsoft-edge/tools/screenshots/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fabd5d322-2dcb-7be4-ee0c-7bc792f213c3.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=c5851d580fd8f660822ca523e63668a4\" alt=\"スクリーンショット 2018-05-18 23.34.52.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/abd5d322-2dcb-7be4-ee0c-7bc792f213c3.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fabd5d322-2dcb-7be4-ee0c-7bc792f213c3.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=33d210477f4392714110ff56b6e58510 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eフォームにURLを入れると、複数のブラウザでの表示結果を表示してくれます。\u003c/font\u003e\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eMicrosoft製のツール。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e表示結果はダウンロード可能。\u003cbr\u003e\n長いページもちゃんと頭からお尻までの一枚の画像にしてくます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"svg-backgrounds\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#svg-backgrounds\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://www.svgbackgrounds.com/#varying-stripes\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSVG Backgrounds\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.svgbackgrounds.com/#varying-stripes\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F53d1955c-7b0f-1cc8-17ef-d1376403c589.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a24d1e7b58cc07b4f56550aea935c354\" alt=\"screely-1529149985985.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/53d1955c-7b0f-1cc8-17ef-d1376403c589.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F53d1955c-7b0f-1cc8-17ef-d1376403c589.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=fb3c6ace9c317cbed4165d531229ce0d 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eバックグラウンドに使えるsvgのパターン画像が作れます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e色やバランス調整可能。\u003cbr\u003e\nライセンスは\u003ca href=\"https://creativecommons.org/licenses/by/4.0/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCreative Commons 4.0\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"プロトタイプ作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%83%88%E3%82%BF%E3%82%A4%E3%83%97%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロトタイプ作成\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"myjson\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#myjson\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"http://myjson.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003emyjson\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://myjson.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F83ed5aae-0c93-5c49-a2d6-394de288421b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=149c2d40127fe99c9fd6a73fd325d493\" alt=\"スクリーンショット 2018-05-10 23.28.18.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/83ed5aae-0c93-5c49-a2d6-394de288421b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F83ed5aae-0c93-5c49-a2d6-394de288421b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4ff3006181cf5996dcf73d734432cdfe 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003ejson api 作成サービス。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eフォームにjsonを入力して[Save]を押せば一瞬でapiが作成できます。\u003c/p\u003e\n\n\u003cp\u003e注意としては生成されたurlを忘れたら二度とアクセス出来ないこと、一度作成したapiは削除できないことです。\u003cbr\u003e\n個人情報やAWSのキーなど人に知られたらまずいものは絶対に入力しないようにしましょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"placeholdercom\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#placeholdercom\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://placeholder.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eplaceholder.com\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://placeholder.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fa596d5fe-0004-5218-8803-2499e1833d71.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=16e442b549e88a4f2aab8d77045042e7\" alt=\"スクリーンショット 2018-05-10 23.32.07.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/a596d5fe-0004-5218-8803-2499e1833d71.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fa596d5fe-0004-5218-8803-2499e1833d71.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=de8c393e1a197ae1d41158fbe3ef94da 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eプレースホルダー作成サービス。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e好きな色・大きさ・テキストの画像がURL指定だけでお手軽に使えます。\u003c/p\u003e\n\n\u003cp\u003e例えば \u003ccode\u003ehttp://via.placeholder.com/200x80/333333/66dd22?text=Hello+World\u003c/code\u003e なら以下になります。\u003cbr\u003e\n\u003ca href=\"https://qiita-user-contents.imgix.net/http%3A%2F%2Fvia.placeholder.com%2F200x80%2F333333%2F66dd22%3Ftext%3DHello%2BWorld?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=0da0ec79c7bae7dfdd5aa8920763e1bb\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/http%3A%2F%2Fvia.placeholder.com%2F200x80%2F333333%2F66dd22%3Ftext%3DHello%2BWorld?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=0da0ec79c7bae7dfdd5aa8920763e1bb\" alt=\"placeholder\" data-canonical-src=\"http://via.placeholder.com/200x80/333333/66dd22?text=Hello+World\" srcset=\"https://qiita-user-contents.imgix.net/http%3A%2F%2Fvia.placeholder.com%2F200x80%2F333333%2F66dd22%3Ftext%3DHello%2BWorld?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=62902451743be2d533b29da3492b42ec 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"avataaars-generator\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#avataaars-generator\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://getavataaars.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAvataaars generator\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://getavataaars.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F8cde8dcb-a664-bfda-9f05-4216ed7a9c72.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=71bc9c152fab5bd96c9ef2dd45e7fa51\" alt=\"スクリーンショット 2018-05-26 13.26.28.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/8cde8dcb-a664-bfda-9f05-4216ed7a9c72.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F8cde8dcb-a664-bfda-9f05-4216ed7a9c72.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=10da70dd6a3a53a8b635685d2458e38a 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003e好みのアバター画像が作れます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e自分のアバター画像を作るときはもちろん、\u003cbr\u003e\nランダム生成ができるので、プロトタイプで大量のアバター画像が必要になったときも便利です。\u003c/p\u003e\n\n\u003cp\u003e作った画像はpng, svgでダウンロードできる他、React, imgタグの生成もできます。\u003cbr\u003e\nimgタグにはURLが入っているのでそこだけ抜き出すことも可能。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ehttps://avataaars.io/?avatarStyle=Circle\u0026amp;topType=ShortHairTheCaesar\u0026amp;accessoriesType=Sunglasses\u0026amp;hairColor=SilverGray\u0026amp;facialHairType=MoustacheFancy\u0026amp;facialHairColor=BrownDark\u0026amp;clotheType=CollarSweater\u0026amp;clotheColor=Gray01\u0026amp;eyeType=Default\u0026amp;eyebrowType=Default\u0026amp;mouthType=Smile\u0026amp;skinColor=Brown\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eのURLなら以下の画像になります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://avataaars.io/?avatarStyle=Circle\u0026amp;topType=ShortHairTheCaesar\u0026amp;accessoriesType=Sunglasses\u0026amp;hairColor=SilverGray\u0026amp;facialHairType=MoustacheFancy\u0026amp;facialHairColor=BrownDark\u0026amp;clotheType=CollarSweater\u0026amp;clotheColor=Gray01\u0026amp;eyeType=Default\u0026amp;eyebrowType=Default\u0026amp;mouthType=Smile\u0026amp;skinColor=Brown\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://avataaars.io/?avatarStyle=Circle\u0026amp;topType=ShortHairTheCaesar\u0026amp;accessoriesType=Sunglasses\u0026amp;hairColor=SilverGray\u0026amp;facialHairType=MoustacheFancy\u0026amp;facialHairColor=BrownDark\u0026amp;clotheType=CollarSweater\u0026amp;clotheColor=Gray01\u0026amp;eyeType=Default\u0026amp;eyebrowType=Default\u0026amp;mouthType=Smile\u0026amp;skinColor=Brown\" alt=\"avataaars\" data-canonical-src=\"https://avataaars.io/?avatarStyle=Circle\u0026amp;topType=ShortHairTheCaesar\u0026amp;accessoriesType=Sunglasses\u0026amp;hairColor=SilverGray\u0026amp;facialHairType=MoustacheFancy\u0026amp;facialHairColor=BrownDark\u0026amp;clotheType=CollarSweater\u0026amp;clotheColor=Gray01\u0026amp;eyeType=Default\u0026amp;eyebrowType=Default\u0026amp;mouthType=Smile\u0026amp;skinColor=Brown\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"sketchsheets\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sketchsheets\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://sketchsheets.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eSketchsheets\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://sketchsheets.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Ff6c6642b-11f9-5417-1320-9dc88ad11d2b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=ed03d385de7607bcb5b69d638550f012\" alt=\"screely-1529149945603.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/f6c6642b-11f9-5417-1320-9dc88ad11d2b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Ff6c6642b-11f9-5417-1320-9dc88ad11d2b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=a6836c46968d9115ad64e08d62cf5712 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eいろいろなデバイスのスケッチ用画像です。\u003c/font\u003e\u003c/strong\u003e\u003cbr\u003e\n印刷して使おう！\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"naming\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#naming\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eNaming\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"fantasy-name-generator\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#fantasy-name-generator\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"http://www.rinkworks.com/namegen/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eFantasy Name Generator\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.rinkworks.com/namegen/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F4a23edee-6df9-3b41-9e90-f334c9c0e9c1.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d26725f5667e1ddc9e1a4baa5f511829\" alt=\"スクリーンショット 2018-05-10 23.18.18.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/4a23edee-6df9-3b41-9e90-f334c9c0e9c1.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F4a23edee-6df9-3b41-9e90-f334c9c0e9c1.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=23d727b50a506532a5b1f6b744922ce8 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eランダム名前生成サービス。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eプロダクト名を考えるときに便利です。\u003cbr\u003e\n使い方は少々慣れが必要です。\u003c/p\u003e\n\n\u003cp\u003e例えば「git関連のツールなので\u003ccode\u003egi\u003c/code\u003eで始まって\u003ccode\u003et\u003c/code\u003eで終わる名前がいいな」と思ったら\u003ccode\u003e(gi)s(t)\u003c/code\u003eと入力して[Generate Names]をクリックすると、上の画像のように条件に合う名前をランダム生成してくれます。\u003c/p\u003e\n\n\u003cp\u003e詳しい使い方は\u003ca href=\"http://www.rinkworks.com/namegen/reference.shtml\" rel=\"nofollow noopener\" target=\"_blank\"\u003eここ\u003c/a\u003e。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"weblio英語類語辞典\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#weblio%E8%8B%B1%E8%AA%9E%E9%A1%9E%E8%AA%9E%E8%BE%9E%E5%85%B8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://ejje.weblio.jp/english-thesaurus/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eWeblio英語類語辞典\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://ejje.weblio.jp/english-thesaurus/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F8ced68ed-2e1d-e1f3-3c4e-015df07e9566.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=bab87267f98bfc162557a9d977f42812\" alt=\"スクリーンショット 2018-05-10 23.15.14.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/8ced68ed-2e1d-e1f3-3c4e-015df07e9566.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F8ced68ed-2e1d-e1f3-3c4e-015df07e9566.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=1e4544833beaf1c84e88e1a18b9fb620 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003e英語類語辞典\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eメソッド名などの名前付けに困ったときに、とりあえず見てみるといい単語が見つかる時があります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ドキュメント作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eドキュメント作成\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"tables-generator\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#tables-generator\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"http://www.tablesgenerator.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eTables Generator\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.tablesgenerator.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fbfbb437d-1f89-f700-5c9f-211dfe860218.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6878d9e5dd41523a243dd3c89e86e94f\" alt=\"スクリーンショット 2018-05-18 23.03.58.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/bfbb437d-1f89-f700-5c9f-211dfe860218.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fbfbb437d-1f89-f700-5c9f-211dfe860218.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e87f6a1e35e27073d8d6bb016698cfd3 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eテーブルを様々な形式に変換することができます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eインプットは以下に対応していて、\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ecsvファイルのアップロード\u003c/li\u003e\n\u003cli\u003e以下からコピーアンドペースト\n\n\u003cul\u003e\n\u003cli\u003espreadsheet (Microsoft ExcelやGoogle spreadsheetなど)\u003c/li\u003e\n\u003cli\u003eMarkdown\u003c/li\u003e\n\u003cli\u003ewebsite\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eアウトプットは以下に対応しています。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eLaTeX\u003c/li\u003e\n\u003cli\u003eHTML\u003c/li\u003e\n\u003cli\u003eMarkdown\u003c/li\u003e\n\u003cli\u003eMediaWiki \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e(Asciidocにも対応してほしい！)\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"text-to-ascii-art-generator-taag\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#text-to-ascii-art-generator-taag\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"http://www.patorjk.com/software/taag\" rel=\"nofollow noopener\" target=\"_blank\"\u003eText to ASCII Art Generator (TAAG)\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.patorjk.com/software/taag\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F4ef3b04a-2634-0f56-777f-8849d97996fb.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=3bb9f1ccca0ab5315ab487566b12a194\" alt=\"screely-1549619870352.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/4ef3b04a-2634-0f56-777f-8849d97996fb.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F4ef3b04a-2634-0f56-777f-8849d97996fb.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=ae4cf59abef444fab212126b792bad72 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eコマンドラインツールやREADMEを書いているときに時々派手な表現をしたくなるときがあります。\u003cbr\u003e\nそんなときはTAAGを使えば\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eサクッとテキストをアスキーアートにしてくれます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eテキストを入力して、[Test All]をクリックすると300以上のパターンを生成してくれます。\u003cbr\u003e\n(ライセンスが明記されてないっぽいので商用利用等には注意してください。)\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コミュニケーション\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%9F%E3%83%A5%E3%83%8B%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコミュニケーション\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"carbon\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#carbon\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://carbon.now.sh\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCarbon\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://carbon.now.sh\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fbebb34e4-63c3-c35f-fca5-bc8797d93305.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=932b2db0c7b81e0885ac9d36de4fe032\" alt=\"screely-1540693447910.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/bebb34e4-63c3-c35f-fca5-bc8797d93305.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fbebb34e4-63c3-c35f-fca5-bc8797d93305.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=6fa6a1819243d9f98f33b38384b7fd8c 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eコードをおしゃれな画像にできます。\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003etweet機能があるので、twitterでコードを共有するのに便利です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"作業用bgm\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%A5%AD%E7%94%A8bgm\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作業用BGM\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"rainy-mood\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#rainy-mood\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"http://www.rainymood.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003erainy mood\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.rainymood.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Ff1bfd801-f181-2b08-43a3-316caa1372e9.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=166c87dfda69a23be71cf7d55f30bbd9\" alt=\"スクリーンショット 2018-05-24 22.46.59.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/f1bfd801-f181-2b08-43a3-316caa1372e9.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Ff1bfd801-f181-2b08-43a3-316caa1372e9.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=65b75bdf456bf5df1cfbfc31ef8c8121 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e作業用BGMはそれぞれ好みがあると思いますが、自分は雨の音が好きです。\u003cbr\u003e\n雨の音にはピンクノイズが入っている気がする。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003e上記のサイトは開くと雨の音がループ再生される(だけの)サイトです。\u003c/font\u003e\u003c/strong\u003e\u003cbr\u003e\nシンプルで良い。\u003c/p\u003e\n\n\u003cp\u003e類似のサイトに以下もあるのでお好みでどうぞ。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ca href=\"http://rainyscope.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eRainyscope\u003c/a\u003e 季節ごとの雨の音\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"http://www.jazzandrain.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ejazz and rain\u003c/a\u003e 雨の音とJazz\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://www.noisli.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eNoisli\u003c/a\u003e 様々な環境音を自分好みにMixできる\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://hipstersound.com/ambience.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHipstersound\u003c/a\u003e カフェの音 右のメニューから雨の音も加えられます\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003chr\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"おまけ-あまり使う機会はないけど\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%8A%E3%81%BE%E3%81%91-%E3%81%82%E3%81%BE%E3%82%8A%E4%BD%BF%E3%81%86%E6%A9%9F%E4%BC%9A%E3%81%AF%E3%81%AA%E3%81%84%E3%81%91%E3%81%A9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eおまけ あまり使う機会はないけど\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"unicode-character-table\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#unicode-character-table\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ca href=\"https://unicode-table.com/jp/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eUnicode® character table\u003c/a\u003e\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://unicode-table.com/jp/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F2d2061cf-930f-4bb1-6960-d54a09d42345.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=993ad98a087bf10eb8480d3f9dd5829f\" alt=\"スクリーンショット 2018-05-10 23.55.08.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/2d2061cf-930f-4bb1-6960-d54a09d42345.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F2d2061cf-930f-4bb1-6960-d54a09d42345.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=c50648c1029ecd9a964a2c521d433cec 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003cfont color=\"DarkOrange\"\u003eUnicode文字一覧\u003c/font\u003e\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e✎\u003c/code\u003eとか\u003ccode\u003eஇ\u003c/code\u003eとか\u003ccode\u003e⏏\u003c/code\u003eとか\u003ccode\u003e💘\u003c/code\u003eとか使いたいときに。\u003cbr\u003e\n眺めるだけでも楽しいです(個人的には)。\u003c/p\u003e\n","body":"普段お世話になっているwebツール達の紹介です。\n\n以下のサイトはすべて**無料**\u0026**登録不要**です。\n\n## 正規表現\n\n### [regexper](https://regexper.com/)\n\n[![スクリーンショット 2018-05-10 23.39.05.png](https://qiita-image-store.s3.amazonaws.com/0/152997/9ff91e69-c6b2-5e2b-7985-038ac2af3d51.png)](https://regexper.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003e正規表現を可視化してくれます。\u003c/font\u003e**\n\n複雑な正規表現を書くときやコードリーディングのお供に重宝します。\n\n### [Rubular](http://www.rubular.com/)\n\n[![スクリーンショット 2018-05-10 23.49.38.png](https://qiita-image-store.s3.amazonaws.com/0/152997/bf719f69-7cbc-86ba-01c9-111060bf3bd0.png)](http://www.rubular.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003eRubyの正規表現をテストできます。\u003c/font\u003e**\n\n## JSON\n\n### [JSON FORMATTER \u0026 VALIDATOR](https://jsonformatter.curiousconcept.com/)\n\nJSON系のツールが集まったサイト。\nそれぞれ、サイト名とドメインが違うのでリンクはそのうちの１つになっています。\n(画像クリックでそれぞれのツールに飛べます。)\n\nひとつずつ紹介します。\n\n[![screely-curiousconcept1.png](https://qiita-image-store.s3.amazonaws.com/0/152997/1f922598-6ca1-6aec-ec15-adfab16f2b25.png)](https://jsonformatter.curiousconcept.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003eJSONをフォーマットしてくれます。\u003c/font\u003e**\n\n出力結果は折りたたむことができるので、長いJSONを読むときにも便利です。\n\n[![screely-curiousconcept2.png](https://qiita-image-store.s3.amazonaws.com/0/152997/8bf19aa6-b840-c9c0-1bfc-9cd9e111cba3.png)](https://dataconverter.curiousconcept.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003eJSONを含めた様々なデータ形式を変換できます。\u003c/font\u003e**\n\nInputの以下に対応。\n\n- CSV\n- INI\n- JSON\n- XML\n- YAML\n\nOutputは以下に対応。\n\n- JSON\n- PHP Code\n- PHP Serialized\n- XML\n- YAML\n\n[![screely-curiousconcept3.png](https://qiita-image-store.s3.amazonaws.com/0/152997/1b28a6cb-0a21-5d9f-65ba-0a2e9357caa5.png)](https://jsonpath.curiousconcept.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003e[JsonPath](https://github.com/json-path/JsonPath)によるスクレイピングができます。\u003c/font\u003e**\n\n[![screely-curiousconcept4.png](https://qiita-image-store.s3.amazonaws.com/0/152997/17d6a1a0-03d4-5590-1c30-c5bbed2bcc82.png)](https://jsonselect.curiousconcept.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003e[JSONSelect](https://github.com/lloyd/JSONSelect/blob/master/JSONSelect.md)によるスクレイピングができます。\u003c/font\u003e**\n\n## SQL\n\n### [Instant SQL Formatter](http://www.dpriver.com/pp/sqlformat.htm)\n\n[![スクリーンショット 2018-05-11 0.07.32.png](https://qiita-image-store.s3.amazonaws.com/0/152997/94f8ac0c-91ee-f54f-6cbf-11ac5f7b45e1.png)](http://www.dpriver.com/pp/sqlformat.htm)\n\n**\u003cfont color=\"DarkOrange\"\u003eSQLをフォーマットしてくれます。\u003c/font\u003e**\n\n細かく設定を変更できるのがナイスです。\n\n## コード管理\n\n### [gitignore.io](https://www.gitignore.io/)\n\n[![screely-gitignoreio.png](https://qiita-image-store.s3.amazonaws.com/0/152997/5ddeae39-fe28-196e-e033-b51a8ffdebba.png)](https://www.gitignore.io/)\n\n**\u003cfont color=\"DarkOrange\"\u003e.gitignore 作成サービス。\u003c/font\u003e**\n\nプロジェクトのフレームワークなどをフォームに入力して[Create]をクリックするだけで適切な`.gitignore`ファイルが作成できます。\n\n`macOS`や`Linux`など汎用的なものもあるので[これらは`.gitignore_global`としてHomeディレクトリに置いておくと良いでしょう。](https://qiita.com/pira/items/dd67077c5b414c8eb59d)\n\n\n## 文字列解析\n\n### [Paste A Date](http://pasteadate.com/)\n\n[![screely-1529149962449.png](https://qiita-image-store.s3.amazonaws.com/0/152997/0506e4e7-01cc-ed27-d688-9c0a722bb766.png)](http://pasteadate.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003eTimestampの文字列をパースしてくれます。\u003c/font\u003e**\n\nRailsなどのフレームワークを使っているとDBへのTimestampの保存はUTCに統一されていると思います。\nそうすると、直接DBを見ているときに「これ日本時間で何時だっけ?」なることがあります。\n\nそんなときはこのサイトに貼り付ければLocal Timeで何時か表示してくれます。\n\nただ、月の表記が英語なのが少々わかりにくい。\n誰か、そのへんまでローカライズした表記にしてくれるサイト作ってくれませんかね?\n\n## プログラミング言語\n\n### [SyntaxDB](https://syntaxdb.com/)\n\n[![スクリーンショット 2018-05-18 23.59.06.png](https://qiita-image-store.s3.amazonaws.com/0/152997/254a2595-8b46-4d07-6366-3ff0b4558b93.png)](https://syntaxdb.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003eいろんな言語のシンタックスがサンプル付きでまとめられています。\u003c/font\u003e**\n\nこの言語でこれってどう書くんだっけ?ってときに便利です。\n\n対応言語は以下。\n\n- Java\n- C\n- C++\n- C#\n- Python\n- Ruby\n- Swift\n- Go\n\n## デバッグ\n\n### [もじばけらった](http://lab.kiki-verb.com/mojibakeratta/)\n\n[![screely-もじばけらった.png](https://qiita-image-store.s3.amazonaws.com/0/152997/02dd29c8-ac15-dc03-20c1-1f5272a46fff.png)](http://lab.kiki-verb.com/mojibakeratta/)\n\n**\u003cfont color=\"DarkOrange\"\u003e文字化け解消ツール。\u003c/font\u003e**\n\nURLエンコードされた文字をUTF-8にするときなんかにサクッと使えます。\n(実際の文字化けにはあんまり使えないかも・・・。)\n\n\n## Web Frontend\n\n### [SassMeister](https://www.sassmeister.com/)\n\n[![スクリーンショット 2018-05-11 0.16.49.png](https://qiita-image-store.s3.amazonaws.com/0/152997/30877c05-f8ec-e46a-2add-3a4f54584bfb.png)](https://www.sassmeister.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003esassをコンパイルした結果を表示してくれます。\u003c/font\u003e**\n\nやたら複雑なfunctionやmixinを書くハメになったときに。\n\n### ~~[Browser screenshots](https://developer.microsoft.com/en-us/microsoft-edge/tools/screenshots/)~~ =\u003e サイトが無くなっていました。\n\n[![スクリーンショット 2018-05-18 23.34.52.png](https://qiita-image-store.s3.amazonaws.com/0/152997/abd5d322-2dcb-7be4-ee0c-7bc792f213c3.png)](https://developer.microsoft.com/en-us/microsoft-edge/tools/screenshots/)\n\n**\u003cfont color=\"DarkOrange\"\u003eフォームにURLを入れると、複数のブラウザでの表示結果を表示してくれます。\u003c/font\u003e**\n**\u003cfont color=\"DarkOrange\"\u003eMicrosoft製のツール。\u003c/font\u003e**\n\n表示結果はダウンロード可能。\n長いページもちゃんと頭からお尻までの一枚の画像にしてくます。\n\n### [SVG Backgrounds](https://www.svgbackgrounds.com/#varying-stripes)\n\n[![screely-1529149985985.png](https://qiita-image-store.s3.amazonaws.com/0/152997/53d1955c-7b0f-1cc8-17ef-d1376403c589.png)](https://www.svgbackgrounds.com/#varying-stripes)\n\n**\u003cfont color=\"DarkOrange\"\u003eバックグラウンドに使えるsvgのパターン画像が作れます。\u003c/font\u003e**\n\n色やバランス調整可能。\nライセンスは[Creative Commons 4.0](https://creativecommons.org/licenses/by/4.0/)\n\n## プロトタイプ作成\n\n### [myjson](http://myjson.com/)\n\n[![スクリーンショット 2018-05-10 23.28.18.png](https://qiita-image-store.s3.amazonaws.com/0/152997/83ed5aae-0c93-5c49-a2d6-394de288421b.png)](http://myjson.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003ejson api 作成サービス。\u003c/font\u003e**\n\nフォームにjsonを入力して[Save]を押せば一瞬でapiが作成できます。\n\n注意としては生成されたurlを忘れたら二度とアクセス出来ないこと、一度作成したapiは削除できないことです。\n個人情報やAWSのキーなど人に知られたらまずいものは絶対に入力しないようにしましょう。\n\n### [placeholder.com](https://placeholder.com/)\n\n[![スクリーンショット 2018-05-10 23.32.07.png](https://qiita-image-store.s3.amazonaws.com/0/152997/a596d5fe-0004-5218-8803-2499e1833d71.png)](https://placeholder.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003eプレースホルダー作成サービス。\u003c/font\u003e**\n\n好きな色・大きさ・テキストの画像がURL指定だけでお手軽に使えます。\n\n例えば `http://via.placeholder.com/200x80/333333/66dd22?text=Hello+World` なら以下になります。\n![placeholder](http://via.placeholder.com/200x80/333333/66dd22?text=Hello+World)\n\n### [Avataaars generator](https://getavataaars.com/)\n\n[![スクリーンショット 2018-05-26 13.26.28.png](https://qiita-image-store.s3.amazonaws.com/0/152997/8cde8dcb-a664-bfda-9f05-4216ed7a9c72.png)](https://getavataaars.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003e好みのアバター画像が作れます。\u003c/font\u003e**\n\n自分のアバター画像を作るときはもちろん、\nランダム生成ができるので、プロトタイプで大量のアバター画像が必要になったときも便利です。\n\n作った画像はpng, svgでダウンロードできる他、React, imgタグの生成もできます。\nimgタグにはURLが入っているのでそこだけ抜き出すことも可能。\n\n```\nhttps://avataaars.io/?avatarStyle=Circle\u0026topType=ShortHairTheCaesar\u0026accessoriesType=Sunglasses\u0026hairColor=SilverGray\u0026facialHairType=MoustacheFancy\u0026facialHairColor=BrownDark\u0026clotheType=CollarSweater\u0026clotheColor=Gray01\u0026eyeType=Default\u0026eyebrowType=Default\u0026mouthType=Smile\u0026skinColor=Brown\n```\n\nのURLなら以下の画像になります。\n\n![avataaars](https://avataaars.io/?avatarStyle=Circle\u0026topType=ShortHairTheCaesar\u0026accessoriesType=Sunglasses\u0026hairColor=SilverGray\u0026facialHairType=MoustacheFancy\u0026facialHairColor=BrownDark\u0026clotheType=CollarSweater\u0026clotheColor=Gray01\u0026eyeType=Default\u0026eyebrowType=Default\u0026mouthType=Smile\u0026skinColor=Brown)\n\n### [Sketchsheets](https://sketchsheets.com/)\n\n[![screely-1529149945603.png](https://qiita-image-store.s3.amazonaws.com/0/152997/f6c6642b-11f9-5417-1320-9dc88ad11d2b.png)](https://sketchsheets.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003eいろいろなデバイスのスケッチ用画像です。\u003c/font\u003e**\n印刷して使おう！\n\n## Naming\n\n### [Fantasy Name Generator](http://www.rinkworks.com/namegen/)\n\n[![スクリーンショット 2018-05-10 23.18.18.png](https://qiita-image-store.s3.amazonaws.com/0/152997/4a23edee-6df9-3b41-9e90-f334c9c0e9c1.png)](http://www.rinkworks.com/namegen/)\n\n**\u003cfont color=\"DarkOrange\"\u003eランダム名前生成サービス。\u003c/font\u003e**\n\nプロダクト名を考えるときに便利です。\n使い方は少々慣れが必要です。\n\n例えば「git関連のツールなので`gi`で始まって`t`で終わる名前がいいな」と思ったら`(gi)s(t)`と入力して[Generate Names]をクリックすると、上の画像のように条件に合う名前をランダム生成してくれます。\n\n詳しい使い方は[ここ](http://www.rinkworks.com/namegen/reference.shtml)。\n\n### [Weblio英語類語辞典](https://ejje.weblio.jp/english-thesaurus/)\n\n[![スクリーンショット 2018-05-10 23.15.14.png](https://qiita-image-store.s3.amazonaws.com/0/152997/8ced68ed-2e1d-e1f3-3c4e-015df07e9566.png)](https://ejje.weblio.jp/english-thesaurus/)\n\n**\u003cfont color=\"DarkOrange\"\u003e英語類語辞典\u003c/font\u003e**\n\nメソッド名などの名前付けに困ったときに、とりあえず見てみるといい単語が見つかる時があります。\n\n## ドキュメント作成\n\n### [Tables Generator](http://www.tablesgenerator.com/)\n\n[![スクリーンショット 2018-05-18 23.03.58.png](https://qiita-image-store.s3.amazonaws.com/0/152997/bfbb437d-1f89-f700-5c9f-211dfe860218.png)](http://www.tablesgenerator.com/)\n\n**\u003cfont color=\"DarkOrange\"\u003eテーブルを様々な形式に変換することができます。\u003c/font\u003e**\n\nインプットは以下に対応していて、\n\n- csvファイルのアップロード\n- 以下からコピーアンドペースト\n  - spreadsheet (Microsoft ExcelやGoogle spreadsheetなど)\n  - Markdown\n  - website\n\nアウトプットは以下に対応しています。\n\n- LaTeX\n- HTML\n- Markdown\n- MediaWiki \n\n(Asciidocにも対応してほしい！)\n\n### [Text to ASCII Art Generator (TAAG)](http://www.patorjk.com/software/taag)\n\n[![screely-1549619870352.png](https://qiita-image-store.s3.amazonaws.com/0/152997/4ef3b04a-2634-0f56-777f-8849d97996fb.png)](http://www.patorjk.com/software/taag)\n\nコマンドラインツールやREADMEを書いているときに時々派手な表現をしたくなるときがあります。\nそんなときはTAAGを使えば**\u003cfont color=\"DarkOrange\"\u003eサクッとテキストをアスキーアートにしてくれます。\u003c/font\u003e**\n\nテキストを入力して、[Test All]をクリックすると300以上のパターンを生成してくれます。\n(ライセンスが明記されてないっぽいので商用利用等には注意してください。)\n\n## コミュニケーション\n\n### [Carbon](https://carbon.now.sh)\n\n[![screely-1540693447910.png](https://qiita-image-store.s3.amazonaws.com/0/152997/bebb34e4-63c3-c35f-fca5-bc8797d93305.png)](https://carbon.now.sh)\n\n**\u003cfont color=\"DarkOrange\"\u003eコードをおしゃれな画像にできます。\u003c/font\u003e**\n\ntweet機能があるので、twitterでコードを共有するのに便利です。\n\n## 作業用BGM\n\n### [rainy mood](http://www.rainymood.com/)\n\n[![スクリーンショット 2018-05-24 22.46.59.png](https://qiita-image-store.s3.amazonaws.com/0/152997/f1bfd801-f181-2b08-43a3-316caa1372e9.png)](http://www.rainymood.com/)\n\n作業用BGMはそれぞれ好みがあると思いますが、自分は雨の音が好きです。\n雨の音にはピンクノイズが入っている気がする。\n\n**\u003cfont color=\"DarkOrange\"\u003e上記のサイトは開くと雨の音がループ再生される(だけの)サイトです。\u003c/font\u003e**\nシンプルで良い。\n\n類似のサイトに以下もあるのでお好みでどうぞ。\n\n- [Rainyscope](http://rainyscope.com/) 季節ごとの雨の音\n- [jazz and rain](http://www.jazzandrain.com/) 雨の音とJazz\n- [Noisli](https://www.noisli.com/) 様々な環境音を自分好みにMixできる\n- [Hipstersound](https://hipstersound.com/ambience.html) カフェの音 右のメニューから雨の音も加えられます\n\n---\n\n## おまけ あまり使う機会はないけど\n\n### [Unicode® character table](https://unicode-table.com/jp/)\n\n[![スクリーンショット 2018-05-10 23.55.08.png](https://qiita-image-store.s3.amazonaws.com/0/152997/2d2061cf-930f-4bb1-6960-d54a09d42345.png)](https://unicode-table.com/jp/)\n\n**\u003cfont color=\"DarkOrange\"\u003eUnicode文字一覧\u003c/font\u003e**\n\n`✎`とか`இ`とか`⏏`とか`💘`とか使いたいときに。\n眺めるだけでも楽しいです(個人的には)。\n","coediting":false,"comments_count":19,"created_at":"2018-05-11T00:22:27+09:00","group":null,"id":"7fcc5eb0b985005b7b7c","likes_count":2606,"private":false,"reactions_count":0,"tags":[{"name":"正規表現","versions":[]},{"name":"Web","versions":[]},{"name":"tool","versions":[]},{"name":"coding","versions":[]},{"name":"naming","versions":[]}],"title":"コーディングをするときに鼻血がでるほど便利なwebツールリスト","updated_at":"2020-05-10T17:20:53+09:00","url":"https://qiita.com/isuke/items/7fcc5eb0b985005b7b7c","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\n\u003ch2\u003e\n\u003cspan id=\"前置き\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E7%BD%AE%E3%81%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前置き\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/numanomanu/items/45dd285b286a1f7280ed\" id=\"reference-0d071c17e2cc44937a43\"\u003e【今日からできる】コミットメッセージに 「プレフィックス」 をつけるだけで、開発効率が上がった話\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/syu_chan_1005/items/e1a18896107d8cedfc45\" id=\"reference-9f8e1807d4f1226d5de6\"\u003eGitのコミットに絵文字を使おう！\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e上記のような記事でコミットメッセージにprefixを使うことのメリットが語られています。\u003cbr\u003e\n実際、自分も今やっている仕事ではコミットにprefixをつけています。\u003c/p\u003e\n\n\u003cp\u003eが、これが結構面倒くさい。\u003cbr\u003e\n「どんなprefixがあったっけ?」「\u003ccode\u003edoc\u003c/code\u003eだっけ、\u003ccode\u003edocs\u003c/code\u003eだっけ?」\u003cbr\u003e\nみたいな。\u003c/p\u003e\n\n\u003cp\u003eprefixを楽にするツールに\u003ca href=\"https://github.com/commitizen/cz-cli\" rel=\"nofollow noopener\" target=\"_blank\"\u003ecommitizen\u003c/a\u003eというのがあるけど、これが結構使いにくい。\u003cbr\u003e\nなぜならprefixの種類が強制されていて自由に変更できないから。\u003c/p\u003e\n\n\u003cp\u003eということで自分好みのツールを作りました。\u003cbr\u003e\nそれが\u003ca href=\"https://github.com/isuke/git-consistent\" rel=\"nofollow noopener\" target=\"_blank\"\u003egit-consistent\u003c/a\u003eです。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F92e41149-3b5d-84ab-bf23-98ebe58cba05.gif?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=af015e98a07885612b6855607c5966a2\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F92e41149-3b5d-84ab-bf23-98ebe58cba05.gif?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=af015e98a07885612b6855607c5966a2\" alt=\"git-consistent01.gif\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/92e41149-3b5d-84ab-bf23-98ebe58cba05.gif\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F92e41149-3b5d-84ab-bf23-98ebe58cba05.gif?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=7712e24846a2174cf73012622a19113e 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e↑　こんなやつです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"インストール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eインストール\u003c/h2\u003e\n\n\u003cp\u003enpmかyarnでインストールするだけです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003enpm \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e \u003cspan class=\"nt\"\u003e-g\u003c/span\u003e git-consistent\n\u003cspan class=\"c\"\u003e# or\u003c/span\u003e\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003eyarn global add git-consistent\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"使い方\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%BF%E3%81%84%E6%96%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e使い方\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003egit consistent --gen-config\u003c/code\u003e　と打つと色々聞かれるので答えましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003ecd \u003c/span\u003emy-project/\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003egit consistent \u003cspan class=\"nt\"\u003e--gen-config\u003c/span\u003e\n? Use Type? Yes\n? Use Emoji? No\n? choice types feat, fix, docs, style, refactor, perf, \u003cspan class=\"nb\"\u003etest\u003c/span\u003e, build, ci, chore, revert, ui, remove, sec, up, down, tada\n? Does the subject start with? lower \u003cspan class=\"k\"\u003ecase\u003c/span\u003e\n? Does the subject put dot \u003cspan class=\"o\"\u003e(\u003c/span\u003e.\u003cspan class=\"p\"\u003e)\u003c/span\u003e at end? No\nGenerated \u003cspan class=\"s1\"\u003e'.gitcommit_template'\u003c/span\u003e and \u003cspan class=\"s1\"\u003e'.git_consistent'\u003c/span\u003e\u003cspan class=\"nb\"\u003e.\u003c/span\u003e\nYou can edit them freely.\nEnjoy!\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eそうするとこんな２つのファイルができます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.gitcommit_template\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u0026lt;type\u0026gt;: \u0026lt;subject\u0026gt;\n\n\u0026lt;body\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"yaml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.git_consistent\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eenum\u003c/span\u003e\n  \u003cspan class=\"na\"\u003erequired\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edescription\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e'\u003c/span\u003e\u003cspan class=\"s\"\u003ecommit\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003etype'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003evalues\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"pi\"\u003e-\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003efeat\u003c/span\u003e\n      \u003cspan class=\"na\"\u003edescription\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e'\u003c/span\u003e\u003cspan class=\"s\"\u003ewhen\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003eimplementing\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003efunction'\u003c/span\u003e\n    \u003cspan class=\"pi\"\u003e-\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003efix\u003c/span\u003e\n      \u003cspan class=\"na\"\u003edescription\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e'\u003c/span\u003e\u003cspan class=\"s\"\u003ewhen\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003efixing\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003ea\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003ebug'\u003c/span\u003e\n    \u003cspan class=\"pi\"\u003e-\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etada\u003c/span\u003e\n      \u003cspan class=\"na\"\u003edescription\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e'\u003c/span\u003e\u003cspan class=\"s\"\u003ewhen\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003ecelebrating'\u003c/span\u003e\n\u003cspan class=\"na\"\u003esubject\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003estring\u003c/span\u003e\n  \u003cspan class=\"na\"\u003erequired\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edescription\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e'\u003c/span\u003e\u003cspan class=\"s\"\u003eThe\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003esubject\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003econtains\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003esuccinct\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003edescription\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003eof\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003ethe\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003echange'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003erules\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003efirstLatter\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003elower\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edotAtEnd\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"na\"\u003enonAscii\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n\u003cspan class=\"na\"\u003ebody\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003etext\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edefault\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e'\u003c/span\u003e\u003cspan class=\"s\"\u003e'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003erequired\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edescription\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e'\u003c/span\u003e\u003cspan class=\"s\"\u003eThe\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003ebody\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003econtains\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003edetails\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003eof\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003ethe\u003c/span\u003e\u003cspan class=\"nv\"\u003e \u003c/span\u003e\u003cspan class=\"s\"\u003echange'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003erules\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003efirstLatter\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003eupper\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edotAtEnd\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"na\"\u003enonAscii\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eあとは\u003ccode\u003egit commit\u003c/code\u003eの代わりに\u003ccode\u003egit consistent -i\u003c/code\u003eと打つだけです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003egit consistent \u003cspan class=\"nt\"\u003e-i\u003c/span\u003e\n? Select \u003cspan class=\"nb\"\u003etype\u003c/span\u003e: \n  feat     when implementing \u003cspan class=\"k\"\u003efunction \n  \u003c/span\u003efix      when fixing a bug \n❯ tada     when celebrating\n\u003cspan class=\"o\"\u003e(\u003c/span\u003eMove up and down to reveal more choices\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n? Write subject: my first commit\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこんな風にインタラクティブにコミットメッセージを生成することができます。\u003c/p\u003e\n\n\u003cp\u003eoptionで入力することもできます。option名は\u003ccode\u003e.gitcommit_template\u003c/code\u003eの\u003ccode\u003e\u0026lt;\u0026gt;\u003c/code\u003eで囲まれた名前です。\u003cbr\u003e\noptionを入力した場合、入力しなかったものだけがインタラクティブに入力できます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003egit consistent \u003cspan class=\"nt\"\u003e-i\u003c/span\u003e \u003cspan class=\"nt\"\u003e--subject\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"my first commit\"\u003c/span\u003e\n? Select \u003cspan class=\"nb\"\u003etype\u003c/span\u003e: \n  feat     when implementing \u003cspan class=\"k\"\u003efunction \n  \u003c/span\u003efix      when fixing a bug \n❯ tada     when celebrating\n\u003cspan class=\"o\"\u003e(\u003c/span\u003eMove up and down to reveal more choices\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c\"\u003e# subjectは聞かれない\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eまたsubjectは特別に\u003ccode\u003e-m\u003c/code\u003eのaliasがついているのでgit aliasと組み合わせるとこんなふうになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003egit config \u003cspan class=\"nt\"\u003e--global\u003c/span\u003e alias.con \u003cspan class=\"s2\"\u003e\"consistent -i\"\u003c/span\u003e\n\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003egit con \u003cspan class=\"nt\"\u003e-m\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"this is amazing commit\"\u003c/span\u003e\n? Select \u003cspan class=\"nb\"\u003etype\u003c/span\u003e: \n❯ feat     when implementing \u003cspan class=\"k\"\u003efunction \n  \u003c/span\u003efix      when fixing a bug \n  tada     when celebrating\n\u003cspan class=\"o\"\u003e(\u003c/span\u003eMove up and down to reveal more choices\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e普段コミットしているときとほぼ同じ使い方ですね。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"応用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BF%9C%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e応用\u003c/h2\u003e\n\n\u003cp\u003e応用として以下のような機能があります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e入力を装飾する 例) \u003ccode\u003etest\u003c/code\u003eと入力すると\u003ccode\u003e【test】\u003c/code\u003eになる\u003c/li\u003e\n\u003cli\u003eフォーマットチェック\n\n\u003cul\u003e\n\u003cli\u003eはじめの文字の大文字/小文字\u003c/li\u003e\n\u003cli\u003e末尾のdot (\u003ccode\u003e.\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003e日本語許可\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eコミットメッセージにブランチ名の一部を含める 例) \u003ccode\u003eissue-123\u003c/code\u003eというブランチでコミットしたときに\u003ccode\u003eclose #123\u003c/code\u003eを自動的にコミットに入れる\u003c/li\u003e\n\u003cli\u003eスペルチェック\u003c/li\u003e\n\u003cli\u003e絵文字サポート\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"https://github.com/git-duet/git-duet\" rel=\"nofollow noopener\" target=\"_blank\"\u003egit-duet\u003c/a\u003eサポート\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eこれらは\u003ccode\u003e.gitcommit_template\u003c/code\u003eと\u003ccode\u003e.git_consistent\u003c/code\u003eを自由に編集することでかんたんに使うことができます。\u003c/p\u003e\n\n\u003cp\u003e詳しくは\u003ca href=\"https://github.com/isuke/git-consistent/blob/master/README.adoc\" rel=\"nofollow noopener\" target=\"_blank\"\u003eREADME\u003c/a\u003eおよび\u003ca href=\"https://github.com/isuke/git-consistent/blob/master/README.adoc#samples\" rel=\"nofollow noopener\" target=\"_blank\"\u003eサンプルリスト\u003c/a\u003eを参照ください。\u003c/p\u003e\n\n\u003cp\u003eあなたのプロジェクトに秩序があらんことを！\u003c/p\u003e\n","body":"## 前置き\n\n- [【今日からできる】コミットメッセージに 「プレフィックス」 をつけるだけで、開発効率が上がった話](https://qiita.com/numanomanu/items/45dd285b286a1f7280ed)\n- [Gitのコミットに絵文字を使おう！](https://qiita.com/syu_chan_1005/items/e1a18896107d8cedfc45)\n\n上記のような記事でコミットメッセージにprefixを使うことのメリットが語られています。\n実際、自分も今やっている仕事ではコミットにprefixをつけています。\n\nが、これが結構面倒くさい。\n「どんなprefixがあったっけ?」「`doc`だっけ、`docs`だっけ?」\nみたいな。\n\nprefixを楽にするツールに[commitizen](https://github.com/commitizen/cz-cli)というのがあるけど、これが結構使いにくい。\nなぜならprefixの種類が強制されていて自由に変更できないから。\n\nということで自分好みのツールを作りました。\nそれが[git-consistent](https://github.com/isuke/git-consistent)です。\n\n\n![git-consistent01.gif](https://qiita-image-store.s3.amazonaws.com/0/152997/92e41149-3b5d-84ab-bf23-98ebe58cba05.gif)\n\n↑　こんなやつです。\n\n## インストール\n\nnpmかyarnでインストールするだけです。\n\n```bash\n$ npm install -g git-consistent\n# or\n$ yarn global add git-consistent\n```\n\n## 使い方\n\n`git consistent --gen-config`　と打つと色々聞かれるので答えましょう。\n\n```bash\n$ cd my-project/\n$ git consistent --gen-config\n? Use Type? Yes\n? Use Emoji? No\n? choice types feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert, ui, remove, sec, up, down, tada\n? Does the subject start with? lower case\n? Does the subject put dot (.) at end? No\nGenerated '.gitcommit_template' and '.git_consistent'.\nYou can edit them freely.\nEnjoy!\n```\n\nそうするとこんな２つのファイルができます。\n\n```text:.gitcommit_template\n\u003ctype\u003e: \u003csubject\u003e\n\n\u003cbody\u003e\n```\n\n```yaml:.git_consistent\ntype:\n  type: enum\n  required: true\n  description: 'commit type'\n  values:\n    -\n      name: feat\n      description: 'when implementing function'\n    -\n      name: fix\n      description: 'when fixing a bug'\n    -\n      name: tada\n      description: 'when celebrating'\nsubject:\n  type: string\n  required: true\n  description: 'The subject contains succinct description of the change'\n  rules:\n    firstLatter: lower\n    dotAtEnd: false\n    nonAscii: false\nbody:\n  type: text\n  default: ''\n  required: false\n  description: 'The body contains details of the change'\n  rules:\n    firstLatter: upper\n    dotAtEnd: true\n    nonAscii: false\n```\n\nあとは`git commit`の代わりに`git consistent -i`と打つだけです。\n\n```bash\n$ git consistent -i\n? Select type: \n  feat     when implementing function \n  fix      when fixing a bug \n❯ tada     when celebrating\n(Move up and down to reveal more choices)\n? Write subject: my first commit\n```\n\nこんな風にインタラクティブにコミットメッセージを生成することができます。\n\noptionで入力することもできます。option名は`.gitcommit_template`の`\u003c\u003e`で囲まれた名前です。\noptionを入力した場合、入力しなかったものだけがインタラクティブに入力できます。\n\n```bash\n$ git consistent -i --subject=\"my first commit\"\n? Select type: \n  feat     when implementing function \n  fix      when fixing a bug \n❯ tada     when celebrating\n(Move up and down to reveal more choices)\n# subjectは聞かれない\n```\n\nまたsubjectは特別に`-m`のaliasがついているのでgit aliasと組み合わせるとこんなふうになります。\n\n```bash\n$ git config --global alias.con \"consistent -i\"\n\n$ git con -m \"this is amazing commit\"\n? Select type: \n❯ feat     when implementing function \n  fix      when fixing a bug \n  tada     when celebrating\n(Move up and down to reveal more choices)\n```\n\n普段コミットしているときとほぼ同じ使い方ですね。\n\n## 応用\n\n応用として以下のような機能があります。\n\n- 入力を装飾する 例) `test`と入力すると`【test】`になる\n- フォーマットチェック\n  - はじめの文字の大文字/小文字\n  - 末尾のdot (`.`)\n  - 日本語許可\n- コミットメッセージにブランチ名の一部を含める 例) `issue-123`というブランチでコミットしたときに`close #123`を自動的にコミットに入れる\n- スペルチェック\n- 絵文字サポート\n- [git-duet](https://github.com/git-duet/git-duet)サポート\n\nこれらは`.gitcommit_template`と`.git_consistent`を自由に編集することでかんたんに使うことができます。\n\n詳しくは[README](https://github.com/isuke/git-consistent/blob/master/README.adoc)および[サンプルリスト](https://github.com/isuke/git-consistent/blob/master/README.adoc#samples)を参照ください。\n\nあなたのプロジェクトに秩序があらんことを！\n\n\n","coediting":false,"comments_count":0,"created_at":"2018-03-19T23:39:27+09:00","group":null,"id":"d1a6f079cec6e3dddc70","likes_count":12,"private":false,"reactions_count":0,"tags":[{"name":"Git","versions":[]},{"name":"GitHub","versions":[]},{"name":"commitizen","versions":[]}],"title":"あなたのプロジェクトに秩序をもたらす！git commit 支援ツールを作りました。","updated_at":"2018-03-20T22:07:30+09:00","url":"https://qiita.com/isuke/items/d1a6f079cec6e3dddc70","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eタイトルそのまんま。自分は以下のように記号を使い始めました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eᛝhogehoge\u003c/code\u003e: backup用のブランチであることを表す。 複雑なrebaseとかする前に念のため今の状態を残しておきたいときに使う。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eဓfoo+bar\u003c/code\u003e: \u003ccode\u003efoo\u003c/code\u003eから切ったブランチであることを表す。master以外のブランチからブランチを切って作業するときに使う。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e以下のようにaliasをつくっておくと便利です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"gitconfig\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ecbran = rev-parse --abbrev-ref HEAD\nchk-fork = \"!f () { git checkout -b ᛝ`git cbran`+$1; };f\"\nbran-backup = !git branch ဓ`git cbran`-backup\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e後は\u003cbr\u003e\n\u003ccode\u003eふぉーく\u003c/code\u003e: \u003ccode\u003eᛝ\u003c/code\u003e\u003cbr\u003e\n\u003ccode\u003eばっくあっぷ\u003c/code\u003e: \u003ccode\u003eဓ\u003c/code\u003e\u003cbr\u003e\nとかで辞書登録しておけばいいでしょう。\u003c/p\u003e\n\n\u003cp\u003eunicodeは\u003ca href=\"https://unicode-table.com/jp\" rel=\"nofollow noopener\" target=\"_blank\"\u003eここ\u003c/a\u003eから好きなものを選ぼう！\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"2018531-編集\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2018531-%E7%B7%A8%E9%9B%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2018/5/31 編集\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003e$\u003c/code\u003eや\u003ccode\u003e@\u003c/code\u003eは\u003ccode\u003e\\\u003c/code\u003eでエスケープが必要だったりCIでチェックアウトが失敗したりするので、unicodeに書き換えました。\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003eこっちもみてね。\u003cbr\u003e\n\u003ca href=\"https://qiita.com/isuke/items/7c622324c396c172a16c\" id=\"reference-a41e6c796bae9f0a6b7d\"\u003e秘伝のgit alias\u003c/a\u003e\u003c/p\u003e\n","body":"タイトルそのまんま。自分は以下のように記号を使い始めました。\n\n- `ᛝhogehoge`: backup用のブランチであることを表す。 複雑なrebaseとかする前に念のため今の状態を残しておきたいときに使う。\n- `ဓfoo+bar`: `foo`から切ったブランチであることを表す。master以外のブランチからブランチを切って作業するときに使う。\n\n以下のようにaliasをつくっておくと便利です。\n\n```.gitconfig\ncbran = rev-parse --abbrev-ref HEAD\nchk-fork = \"!f () { git checkout -b ᛝ`git cbran`+$1; };f\"\nbran-backup = !git branch ဓ`git cbran`-backup\n```\n\n後は\n`ふぉーく`: `ᛝ`\n`ばっくあっぷ`: `ဓ`\nとかで辞書登録しておけばいいでしょう。\n\nunicodeは[ここ](https://unicode-table.com/jp)から好きなものを選ぼう！\n\n### 2018/5/31 編集\n\n`$`や`@`は`\\`でエスケープが必要だったりCIでチェックアウトが失敗したりするので、unicodeに書き換えました。\n\n---\n\nこっちもみてね。\n[秘伝のgit alias](https://qiita.com/isuke/items/7c622324c396c172a16c)\n","coediting":false,"comments_count":0,"created_at":"2018-03-19T22:46:38+09:00","group":null,"id":"961d372bb7e20f4bfce5","likes_count":1,"private":false,"reactions_count":0,"tags":[{"name":"Git","versions":[]}],"title":"gitのブランチ名に記号(unicode)を使うと便利かもしれない","updated_at":"2018-06-01T14:09:55+09:00","url":"https://qiita.com/isuke/items/961d372bb7e20f4bfce5","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eAsciidocというMarkdownに似た軽量マークアップ言語があります。\u003cbr\u003e\nAsciidocの基本的な使い方等は\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003e参考文献\u003c/a\u003eに譲るとして、ここでは「Markdownでかけなかったアレ、Asciidocならこうかけますよ」っていうのを書きたいと思います。\u003c/p\u003e\n\n\u003cp\u003e画像はVSCodeでPreviewした結果です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"順序有りリストの途中でコードを書く\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E9%A0%86%E5%BA%8F%E6%9C%89%E3%82%8A%E3%83%AA%E3%82%B9%E3%83%88%E3%81%AE%E9%80%94%E4%B8%AD%E3%81%A7%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E6%9B%B8%E3%81%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e順序有りリストの途中でコードを書く\u003c/h1\u003e\n\n\u003cp\u003eMarkdownで順序有りリストの途中にコードを書くと残念なことになってしまいます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"markdown\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eqiita.md\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"p\"\u003e1.\u003c/span\u003e まずこうします。\n\u003cspan class=\"p\"\u003e2.\u003c/span\u003e 次にこうします。その時叩くコマンドはこれです。\n\u003cspan class=\"se\"\u003e\\`\u003c/span\u003e\u003cspan class=\"sb\"\u003e``　(適当にエスケープしています)\n$ echo \"hoge\"\n\\```\u003c/span\u003e　(適当にエスケープしています)\n\u003cspan class=\"p\"\u003e3.\u003c/span\u003e 最後にこうして完了。\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれを表示させるとこうなります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fb8144e41-273c-3722-fd51-76bc377f140b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8e67aa69df37357f448f788c944f1512\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fb8144e41-273c-3722-fd51-76bc377f140b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=8e67aa69df37357f448f788c944f1512\" alt=\"01.md.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/b8144e41-273c-3722-fd51-76bc377f140b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fb8144e41-273c-3722-fd51-76bc377f140b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=4aa0c0d18312738fad7201cab58b87d7 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e「最後にこうして完了。」の部分が「1.」になってしまっています。\u003cbr\u003e\n途中でコードを入れたことで順序リストが一旦終わってしまったんですね。\u003c/p\u003e\n\n\u003cp\u003eこれはAsciidocだと回避することができます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eqiita.adoc\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e== 順序付きリスト\n\n. まずこうします。\n. 次にこうします。その時叩くコマンドはこれです。\n+\n----\n$ echo \"hoge\"\n----\n+\n. 最後にこうして完了。\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F3b314d83-6801-b66c-a640-a1ac3ad4373a.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6b2724abaac893ab1ac98e10c106ca0f\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F3b314d83-6801-b66c-a640-a1ac3ad4373a.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=6b2724abaac893ab1ac98e10c106ca0f\" alt=\"01.adoc.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/3b314d83-6801-b66c-a640-a1ac3ad4373a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F3b314d83-6801-b66c-a640-a1ac3ad4373a.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=2655430ffaea387e47477e9ad49135d0 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e+\u003c/code\u003eを書くことで「まだリストが続きますよ」ということを表すことができるのです！\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"テーブル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテーブル\u003c/h1\u003e\n\n\u003cp\u003eMarkdownではテーブルは標準では(HTMLを使わないと)かけないので、各自同時実装しているのが現状です。\u003cbr\u003e\n各自、微妙に書き方が違っていて困りものなのですが、それ以上に困るのがセルの結合です。\u003cbr\u003e\n特に縦の結合については、それがかけるMarkdownの処理系というのは(少なくとも自分は)知りません。\u003c/p\u003e\n\n\u003cp\u003eAsciidocではテーブルは標準表示でセルの結合も使放題です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eqiita.adoc\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e== テーブル\n\n|===\n|1     |2  |3 |4\n|5 2.2+|6 1.3+|7\n|8\n|9   2+|10\n|===\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Faf56fb15-156e-73c6-d60d-2dd1c5894900.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=735841c707f8c3a0fbe7bdeb138e13a9\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Faf56fb15-156e-73c6-d60d-2dd1c5894900.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=735841c707f8c3a0fbe7bdeb138e13a9\" alt=\"02.adoc.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/af56fb15-156e-73c6-d60d-2dd1c5894900.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Faf56fb15-156e-73c6-d60d-2dd1c5894900.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=59ae0c48b413999b7f8cca081da6db86 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e書き方も複数用意されていて、csvで書くこともできます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eqiita.adoc\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e[format=\"csv\", options=\"header\"]\n|===\nアーティスト,トラック,ジャンル\nBaauer,Harlem Shake,Hip Hop\nThe Lumineers,Ho Hey,Folk Rock\n|===\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"ファイルのインクルード\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%AF%E3%83%AB%E3%83%BC%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファイルのインクルード\u003c/h1\u003e\n\n\u003cp\u003eAsciidocでは他のファイルをインクルードすることができます。これがめちゃくちゃ便利！\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eqiita.adoc\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003einclude::other.adoc[]\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eother.adoc\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e=== Other\n\n他のこと\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F45ba7b23-1e84-4f17-ede8-2dc1965b067b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2a9bcf4aa8172a6bcb98a448cf6cc050\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F45ba7b23-1e84-4f17-ede8-2dc1965b067b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=2a9bcf4aa8172a6bcb98a448cf6cc050\" alt=\"03.adoc.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/45ba7b23-1e84-4f17-ede8-2dc1965b067b.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F45ba7b23-1e84-4f17-ede8-2dc1965b067b.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=d9f0c08e58daa7288a65ff0ffc789913 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"応用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BF%9C%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e応用\u003c/h2\u003e\n\n\u003cp\u003eファイルのインクルードと先程のテーブルのcsv記法やコードの表示を使えばcsvファイルやプログラムファイルも読み込めちゃいます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eqiita.adoc\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e=== csvをテーブルとして表示\n\n[format=\"csv\", options=\"header\"]\n|===\ninclude::other.csv[]\n|===\n\n=== プログラムの埋め込み\n\n[source,ruby]\n----\ninclude::other.rb[]\n----\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"csv\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eother.csv\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e国,首都,人口(2006) CRLF\n日本国,東京,127767944 CRLF\nアメリカ合衆国,ワシントン,300007997 CRLF\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eother.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s1\"\u003e'/hi'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\"Hello World!\"\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fcde8d150-caea-a894-ce69-dece20a0435e.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e5c72a8342af42f4f99b26e10797d601\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fcde8d150-caea-a894-ce69-dece20a0435e.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e5c72a8342af42f4f99b26e10797d601\" alt=\"03-2.adoc.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/cde8d150-caea-a894-ce69-dece20a0435e.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fcde8d150-caea-a894-ce69-dece20a0435e.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=0775b8af39986d932c5f443700198052 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"注釈\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%B3%A8%E9%87%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e注釈\u003c/h1\u003e\n\n\u003cp\u003eAsciidocではこんな注釈が用意されています。\u003cbr\u003e\n地味に嬉しい。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F4c042e9b-4f90-9138-73ab-1729d23d03e7.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=301e38dbbae0c47e41f3668c74ddb9ce\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F4c042e9b-4f90-9138-73ab-1729d23d03e7.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=301e38dbbae0c47e41f3668c74ddb9ce\" alt=\"04.adoc.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/4c042e9b-4f90-9138-73ab-1729d23d03e7.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F4c042e9b-4f90-9138-73ab-1729d23d03e7.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=52bfe82becbf116962aaf50d230790d0 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"最後に\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%80%E5%BE%8C%E3%81%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e最後に\u003c/h1\u003e\n\n\u003cp\u003eどうでしょうか?\u003cbr\u003e\nAsciidoc使ってみたくなってきたでしょうか?\u003cbr\u003e\nGithubやGistはもう対応しているようなので、自分は今後は積極的にAsciidocを使っていきたいと思っています。\u003cbr\u003e\n皆さんも是非。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eQiitaもはやくAsciidocに対応するべき！\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考文献\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考文献\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://takumon.github.io/asciidoc-syntax-quick-reference-japanese-translation/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAsciidoctor 文法クイックリファレンス(日本語訳)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/xmeta/items/de667a8b8a0f982e123a\" id=\"reference-05ebf20cc9b86ca17ba8\"\u003eAsciiDoc入門\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://qiita.com/tamikura@github/items/5d3f62dae55617ee42bb\" id=\"reference-a97f220a563db44d0297\"\u003e脱Word、脱Markdown、asciidocでドキュメント作成する際のアレコレ\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","body":"AsciidocというMarkdownに似た軽量マークアップ言語があります。\nAsciidocの基本的な使い方等は[参考文献](#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE)に譲るとして、ここでは「Markdownでかけなかったアレ、Asciidocならこうかけますよ」っていうのを書きたいと思います。\n\n画像はVSCodeでPreviewした結果です。\n\n# 順序有りリストの途中でコードを書く\n\nMarkdownで順序有りリストの途中にコードを書くと残念なことになってしまいます。\n\n```markdown:qiita.md\n1. まずこうします。\n2. 次にこうします。その時叩くコマンドはこれです。\n\\```　(適当にエスケープしています)\n$ echo \"hoge\"\n\\```　(適当にエスケープしています)\n3. 最後にこうして完了。\n```\n\nこれを表示させるとこうなります。\n\n![01.md.png](https://qiita-image-store.s3.amazonaws.com/0/152997/b8144e41-273c-3722-fd51-76bc377f140b.png)\n\n「最後にこうして完了。」の部分が「1.」になってしまっています。\n途中でコードを入れたことで順序リストが一旦終わってしまったんですね。\n\nこれはAsciidocだと回避することができます。\n\n```text:qiita.adoc\n== 順序付きリスト\n\n. まずこうします。\n. 次にこうします。その時叩くコマンドはこれです。\n+\n----\n$ echo \"hoge\"\n----\n+\n. 最後にこうして完了。\n```\n\n![01.adoc.png](https://qiita-image-store.s3.amazonaws.com/0/152997/3b314d83-6801-b66c-a640-a1ac3ad4373a.png)\n\n`+`を書くことで「まだリストが続きますよ」ということを表すことができるのです！\n\n# テーブル\n\nMarkdownではテーブルは標準では(HTMLを使わないと)かけないので、各自同時実装しているのが現状です。\n各自、微妙に書き方が違っていて困りものなのですが、それ以上に困るのがセルの結合です。\n特に縦の結合については、それがかけるMarkdownの処理系というのは(少なくとも自分は)知りません。\n\nAsciidocではテーブルは標準表示でセルの結合も使放題です。\n\n```text:qiita.adoc\n== テーブル\n\n|===\n|1     |2  |3 |4\n|5 2.2+|6 1.3+|7\n|8\n|9   2+|10\n|===\n```\n\n![02.adoc.png](https://qiita-image-store.s3.amazonaws.com/0/152997/af56fb15-156e-73c6-d60d-2dd1c5894900.png)\n\n書き方も複数用意されていて、csvで書くこともできます。\n\n```text:qiita.adoc\n[format=\"csv\", options=\"header\"]\n|===\nアーティスト,トラック,ジャンル\nBaauer,Harlem Shake,Hip Hop\nThe Lumineers,Ho Hey,Folk Rock\n|===\n```\n\n# ファイルのインクルード\n\nAsciidocでは他のファイルをインクルードすることができます。これがめちゃくちゃ便利！\n\n```text:qiita.adoc\ninclude::other.adoc[]\n```\n\n```text:other.adoc\n=== Other\n\n他のこと\n```\n\n![03.adoc.png](https://qiita-image-store.s3.amazonaws.com/0/152997/45ba7b23-1e84-4f17-ede8-2dc1965b067b.png)\n\n## 応用\n\nファイルのインクルードと先程のテーブルのcsv記法やコードの表示を使えばcsvファイルやプログラムファイルも読み込めちゃいます。\n\n```text:qiita.adoc\n=== csvをテーブルとして表示\n\n[format=\"csv\", options=\"header\"]\n|===\ninclude::other.csv[]\n|===\n\n=== プログラムの埋め込み\n\n[source,ruby]\n----\ninclude::other.rb[]\n----\n```\n\n```csv:other.csv\n国,首都,人口(2006) CRLF\n日本国,東京,127767944 CRLF\nアメリカ合衆国,ワシントン,300007997 CRLF\n```\n\n```rb:other.rb\n\brequire 'sinatra'\n\nget '/hi' do\n  \"Hello World!\"\nend\n```\n\n![03-2.adoc.png](https://qiita-image-store.s3.amazonaws.com/0/152997/cde8d150-caea-a894-ce69-dece20a0435e.png)\n\n\n# 注釈\n\nAsciidocではこんな注釈が用意されています。\n地味に嬉しい。\n\n![04.adoc.png](https://qiita-image-store.s3.amazonaws.com/0/152997/4c042e9b-4f90-9138-73ab-1729d23d03e7.png)\n\n# 最後に\n\nどうでしょうか?\nAsciidoc使ってみたくなってきたでしょうか?\nGithubやGistはもう対応しているようなので、自分は今後は積極的にAsciidocを使っていきたいと思っています。\n皆さんも是非。\n\n**QiitaもはやくAsciidocに対応するべき！**\n\n# 参考文献\n\n- [Asciidoctor 文法クイックリファレンス(日本語訳)](https://takumon.github.io/asciidoc-syntax-quick-reference-japanese-translation/)\n- [AsciiDoc入門](https://qiita.com/xmeta/items/de667a8b8a0f982e123a)\n- [脱Word、脱Markdown、asciidocでドキュメント作成する際のアレコレ](https://qiita.com/tamikura@github/items/5d3f62dae55617ee42bb)\n","coediting":false,"comments_count":1,"created_at":"2018-02-21T22:35:11+09:00","group":null,"id":"75c0850805ce9e774624","likes_count":17,"private":false,"reactions_count":0,"tags":[{"name":"Markdown","versions":[]},{"name":"asciidoctor","versions":[]},{"name":"asciidoc","versions":[]}],"title":"Markdownでかけなかったアレ、Asciidocならこうかけますよ。","updated_at":"2018-02-21T22:37:31+09:00","url":"https://qiita.com/isuke/items/75c0850805ce9e774624","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ca href=\"http://hanamirb.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHanami\u003c/a\u003eでGoogle OAuthを使った認証を実装しましょう。大丈夫、超かんたんです。\u003c/p\u003e\n\n\u003cp\u003e完成品は\u003ca href=\"https://github.com/isuke/hanami_ominioauth_sample\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eで見ることができます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"1-プロジェクトの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1. プロジェクトの作成\u003c/h1\u003e\n\n\u003cp\u003eまずはプロジェクトを作成していきましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003egem \u003cspan class=\"nb\"\u003einstall \u003c/span\u003ehanami\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ehanami new hanami_ominioauth_sample \u003cspan class=\"nt\"\u003e--test\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003erspec \u003cspan class=\"nt\"\u003e--template\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eslim\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003ecd \u003c/span\u003ehanami_ominioauth_sample\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"2-userモデルの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2-user%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2. Userモデルの作成\u003c/h1\u003e\n\n\u003cp\u003e次にUserモデルを作成します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003ehanami g model user\n      create  lib/hanami_ominioauth_sample/entities/user.rb\n      create  lib/hanami_ominioauth_sample/repositories/user_repository.rb\n      create  db/migrations/20180102151137_create_users.rb\n      create  spec/hanami_ominioauth_sample/entities/user_spec.rb\n      create  spec/hanami_ominioauth_sample/repositories/user_repository_spec.rb\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003edb/migrations/20180102151137_create_users.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eModel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emigration\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003echange\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecreate_table\u003c/span\u003e \u003cspan class=\"ss\"\u003e:users\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:provider\u003c/span\u003e  \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:uid\u003c/span\u003e       \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e      \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:email\u003c/span\u003e     \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:image_path\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:created_at\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:updated_at\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n\n      \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:provider\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:uid\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"ss\"\u003eunique: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eindex\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:email\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e         \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eunique: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003ehanami db prepare\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.000842s\u003cspan class=\"o\"\u003e)\u003c/span\u003e PRAGMA foreign_keys \u003cspan class=\"o\"\u003e=\u003c/span\u003e 1\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.000041s\u003cspan class=\"o\"\u003e)\u003c/span\u003e PRAGMA case_sensitive_like \u003cspan class=\"o\"\u003e=\u003c/span\u003e 1\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.000900s\u003cspan class=\"o\"\u003e)\u003c/span\u003e SELECT sqlite_version\u003cspan class=\"o\"\u003e()\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eERROR] SQLite3::SQLException: no such table: schema_migrations: SELECT NULL AS \u003cspan class=\"s1\"\u003e'nil'\u003c/span\u003e FROM \u003cspan class=\"sb\"\u003e`\u003c/span\u003eschema_migrations\u003cspan class=\"sb\"\u003e`\u003c/span\u003e LIMIT 1\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.002738s\u003cspan class=\"o\"\u003e)\u003c/span\u003e CREATE TABLE \u003cspan class=\"sb\"\u003e`\u003c/span\u003eschema_migrations\u003cspan class=\"sb\"\u003e`\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003efilename\u003cspan class=\"sb\"\u003e`\u003c/span\u003e varchar\u003cspan class=\"o\"\u003e(\u003c/span\u003e255\u003cspan class=\"o\"\u003e)\u003c/span\u003e NOT NULL PRIMARY KEY\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eERROR] SQLite3::SQLException: no such table: schema_info: SELECT NULL AS \u003cspan class=\"s1\"\u003e'nil'\u003c/span\u003e FROM \u003cspan class=\"sb\"\u003e`\u003c/span\u003eschema_info\u003cspan class=\"sb\"\u003e`\u003c/span\u003e LIMIT 1\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.000211s\u003cspan class=\"o\"\u003e)\u003c/span\u003e SELECT \u003cspan class=\"sb\"\u003e`\u003c/span\u003efilename\u003cspan class=\"sb\"\u003e`\u003c/span\u003e FROM \u003cspan class=\"sb\"\u003e`\u003c/span\u003eschema_migrations\u003cspan class=\"sb\"\u003e`\u003c/span\u003e ORDER BY \u003cspan class=\"sb\"\u003e`\u003c/span\u003efilename\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] Begin applying migration 20180102151137_create_users.rb, direction: up\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.001833s\u003cspan class=\"o\"\u003e)\u003c/span\u003e CREATE TABLE \u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"nb\"\u003eusers\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003e integer NOT NULL PRIMARY KEY AUTOINCREMENT, \u003cspan class=\"sb\"\u003e`\u003c/span\u003eprovider\u003cspan class=\"sb\"\u003e`\u003c/span\u003e varchar\u003cspan class=\"o\"\u003e(\u003c/span\u003e255\u003cspan class=\"o\"\u003e)\u003c/span\u003e NOT NULL, \u003cspan class=\"sb\"\u003e`\u003c/span\u003euid\u003cspan class=\"sb\"\u003e`\u003c/span\u003e varchar\u003cspan class=\"o\"\u003e(\u003c/span\u003e255\u003cspan class=\"o\"\u003e)\u003c/span\u003e NOT NULL, \u003cspan class=\"sb\"\u003e`\u003c/span\u003ename\u003cspan class=\"sb\"\u003e`\u003c/span\u003e varchar\u003cspan class=\"o\"\u003e(\u003c/span\u003e255\u003cspan class=\"o\"\u003e)\u003c/span\u003e NOT NULL, \u003cspan class=\"sb\"\u003e`\u003c/span\u003eemail\u003cspan class=\"sb\"\u003e`\u003c/span\u003e varchar\u003cspan class=\"o\"\u003e(\u003c/span\u003e255\u003cspan class=\"o\"\u003e)\u003c/span\u003e NOT NULL, \u003cspan class=\"sb\"\u003e`\u003c/span\u003eimage_path\u003cspan class=\"sb\"\u003e`\u003c/span\u003e varchar\u003cspan class=\"o\"\u003e(\u003c/span\u003e255\u003cspan class=\"o\"\u003e)\u003c/span\u003e NULL, \u003cspan class=\"sb\"\u003e`\u003c/span\u003ecreated_at\u003cspan class=\"sb\"\u003e`\u003c/span\u003e timestamp NOT NULL, \u003cspan class=\"sb\"\u003e`\u003c/span\u003eupdated_at\u003cspan class=\"sb\"\u003e`\u003c/span\u003e timestamp NOT NULL\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.001225s\u003cspan class=\"o\"\u003e)\u003c/span\u003e CREATE UNIQUE INDEX \u003cspan class=\"sb\"\u003e`\u003c/span\u003eusers_provider_uid_index\u003cspan class=\"sb\"\u003e`\u003c/span\u003e ON \u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"nb\"\u003eusers\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003eprovider\u003cspan class=\"sb\"\u003e`\u003c/span\u003e, \u003cspan class=\"sb\"\u003e`\u003c/span\u003euid\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.001379s\u003cspan class=\"o\"\u003e)\u003c/span\u003e CREATE UNIQUE INDEX \u003cspan class=\"sb\"\u003e`\u003c/span\u003eusers_email_index\u003cspan class=\"sb\"\u003e`\u003c/span\u003e ON \u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"nb\"\u003eusers\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003eemail\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.001321s\u003cspan class=\"o\"\u003e)\u003c/span\u003e INSERT INTO \u003cspan class=\"sb\"\u003e`\u003c/span\u003eschema_migrations\u003cspan class=\"sb\"\u003e`\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003efilename\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e VALUES \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'20180102151137_create_users.rb'\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003cspan class=\"o\"\u003e[\u003c/span\u003ehanami] \u003cspan class=\"o\"\u003e[\u003c/span\u003eINFO] Finished applying migration 20180102151137_create_users.rb, direction: up, took 0.007446 seconds\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eひとまずこれでUserモデルができました。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"3-homeページの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#3-home%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e3. Homeページの作成\u003c/h1\u003e\n\n\u003cp\u003eログインボタンを置くHomeページを作成します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003ehanami g action web page#home\n      create  apps/web/controllers/page/home.rb\n      create  apps/web/views/page/home.rb\n      create  apps/web/templates/page/home.html.slim\n      create  spec/web/controllers/page/home_spec.rb\n      create  spec/web/views/page/home_spec.rb\n      insert  apps/web/config/routes.rb\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/config/routes.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003eroot\u003c/span\u003e                             \u003cspan class=\"ss\"\u003eto: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'page#home'\u003c/span\u003e\n\u003cspan class=\"n\"\u003eget\u003c/span\u003e  \u003cspan class=\"s1\"\u003e'/home'\u003c/span\u003e                   \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eto: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'page#home'\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"slim\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/templates/page/home.html.slim\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eHome\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003ehanami s\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003elocalhost:2300 を開いて「Home」と表示されていればOKです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"4-認証の実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#4-%E8%AA%8D%E8%A8%BC%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e4. 認証の実装\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"a-クライアントidの取得\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#a-%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88id%E3%81%AE%E5%8F%96%E5%BE%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eA. クライアントIDの取得\u003c/h2\u003e\n\n\u003cp\u003eまず、次のURLを開いてください。\u003cbr\u003e\n\u003ca href=\"https://console.developers.google.com\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://console.developers.google.com\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e上のメニューからプロジェクト名を「Hanami Ominioauth Sample」にして作成します。作成には30秒ほどかかります。作成できたら、「Hanami Ominioauth Sample」を開きましよう。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F7a8f595b-a232-a5e8-da88-5cdcf081f2cd.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e689a30e7f74b4dcd25b3b6404118705\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F7a8f595b-a232-a5e8-da88-5cdcf081f2cd.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=e689a30e7f74b4dcd25b3b6404118705\" alt=\"ominiauth01.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/7a8f595b-a232-a5e8-da88-5cdcf081f2cd.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F7a8f595b-a232-a5e8-da88-5cdcf081f2cd.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=168aa6e637b1020d63e652dc713a0dad 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e左側に「ライブラリ」というメニューがあるのでクリックします。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fec3ef844-384a-e0d8-0e92-5fb0638ed7c4.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=55bd7bd499e700d9043e6b28ff6b8c69\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fec3ef844-384a-e0d8-0e92-5fb0638ed7c4.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=55bd7bd499e700d9043e6b28ff6b8c69\" alt=\"ominiauth02.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/ec3ef844-384a-e0d8-0e92-5fb0638ed7c4.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fec3ef844-384a-e0d8-0e92-5fb0638ed7c4.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=5594266d924f261c341546c96efe46f5 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eここで以下の２つを有効にしてください。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eContacts API\u003c/li\u003e\n\u003cli\u003eGoogle+ API\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e次に認証情報を作成しましす。「認証情報」をクリックしてください。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F6c66773a-7924-b9a8-584c-5da7e85eefef.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=66c79e53a8a259eb2a2b70ca5eb24874\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F6c66773a-7924-b9a8-584c-5da7e85eefef.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=66c79e53a8a259eb2a2b70ca5eb24874\" alt=\"ominiauth03.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/6c66773a-7924-b9a8-584c-5da7e85eefef.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F6c66773a-7924-b9a8-584c-5da7e85eefef.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=9a6c8c430ffbb0093907f03ee81d4d48 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eタブから「OAuth 同意画面」を選択します。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eメールアドレス: 初期値\u003c/li\u003e\n\u003cli\u003eユーザーに表示するサービス名: 「Hanami Ominioauth Sample」\u003c/li\u003e\n\u003cli\u003eホームページの URL: ブランク\u003c/li\u003e\n\u003cli\u003eサービスロゴの URL: ブランク\u003c/li\u003e\n\u003cli\u003eプライバシー ポリシーの URL: ブランク\u003c/li\u003e\n\u003cli\u003e利用規約の URL: ブランク\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e「認証情報を作成」 -\u0026gt; 「OAuth クライアントID」を選択します。\u003c/p\u003e\n\n\u003cp\u003e以下の内容を入力して「作成」を\u003cstrong\u003e2回\u003c/strong\u003eクリックします。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eアプリケーションの種類: ウェブ アプリケーション\u003c/li\u003e\n\u003cli\u003e名前: 「Brower」(なんでもいい)\u003c/li\u003e\n\u003cli\u003e承認済みの JavaScript 生成元: ブランク\u003c/li\u003e\n\u003cli\u003e承認済みのリダイレクト URI: 「\u003ca href=\"http://localhost:2300/auth/google_oauth2/callback%E3%80%8D\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://localhost:2300/auth/google_oauth2/callback」\u003c/a\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e「クライアントID」と「クライアントシークレット」が表示されるのでこれを控えておきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"b-option-direnv-の導入\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#b-option-direnv-%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eB. (option) direnv の導入\u003c/h2\u003e\n\n\u003cp\u003e先程入手した「クライアントID」と「クライアントシークレット」を管理するのにdirenvを使うと便利です。\u003c/p\u003e\n\n\u003cp\u003emacの場合はHomebrewでインストールできます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ebrew \u003cspan class=\"nb\"\u003einstall \u003c/span\u003edirenv\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eそして\u003ccode\u003e.ernvrc\u003c/code\u003eを作成します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.envrv\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003eexport GOOGLE_CLIENT_ID=[クライアントID]\nexport GOOGLE_CLIENT_SECRET=[クライアントシークレット]\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eあとはこれを適用してあげればOKです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003edirenv allow\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003egitを使う場合は\u003ccode\u003e.gitignore\u003c/code\u003eに入れておきましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.gitignroe\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gi\"\u003e+ .envrc\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"cominiauthを使う準備\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#cominiauth%E3%82%92%E4%BD%BF%E3%81%86%E6%BA%96%E5%82%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eC.ominiauthを使う準備\u003c/h2\u003e\n\n\u003cp\u003eいよいよ認証部分を実装していきます。\u003ccode\u003eomniauth-google-oauth2\u003c/code\u003eというgemを使っていきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGemfile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gi\"\u003e+ gem 'omniauth-google-oauth2'\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eapplication.rb\u003c/code\u003e　を書き換えてセッションを有効にし、さらに\u003ccode\u003eomniauth\u003c/code\u003eを使うように設定します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/application.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e      # Enable sessions\n      # Argument: Symbol the Rack session adapter\n      #           A Hash with options\n      #\n      # See: http://www.rubydoc.info/gems/rack/Rack/Session/Cookie\n      #\n\u003cspan class=\"gd\"\u003e-     # sessions :cookie, secret: ENV['WEB_SESSIONS_SECRET']\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+     sessions :cookie, secret: ENV['WEB_SESSIONS_SECRET']\n\u003c/span\u003e\n...\n\n      # Configure Rack middleware for this application\n      #\n\u003cspan class=\"gd\"\u003e-     # middleware.use Rack::Protection\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+     middleware.use OmniAuth::Builder do\n+       provider :google_oauth2, ENV['GOOGLE_CLIENT_ID'], ENV['GOOGLE_CLIENT_SECRET']\n+     end\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"d-sessionコントローラーの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#d-session%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%83%BC%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eD. sessionコントローラーの作成\u003c/h2\u003e\n\n\u003cp\u003esessionコントローラーを作成します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003ehanami g action web session#create\n      create  apps/web/controllers/session/create.rb\n      create  apps/web/views/session/create.rb\n      create  apps/web/templates/session/create.html.slim\n      create  spec/web/controllers/session/create_spec.rb\n      create  spec/web/views/session/create_spec.rb\n      insert  apps/web/config/routes.rb\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e自動生成されたコードのうち\u003ccode\u003eroutes.rb\u003c/code\u003eをとりあえず書き換えます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/config/routes.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gd\"\u003e- post '/session', to: 'session#create'\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+ post '/auth/:provider/callback', to: 'session#create'\n+ get  '/auth/:provider/callback', to: 'session#create'\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"e-インタラクタの作成とコントローラの実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#e-%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%A9%E3%82%AF%E3%82%BF%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%A9%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eE. インタラクタの作成とコントローラの実装\u003c/h2\u003e\n\n\u003cp\u003e認証部分の実装をコントローラに書いていくことも可能ですが、コントローラにはあまりロジックを書きたくないので、今回はインタラクタを使います。インタラクタとはいわゆるサービスです。くわしくは\u003ca href=\"https://qiita.com/isuke/items/eaa36f0192d910091e30\" id=\"reference-672945c3008f6b117ccc\"\u003eHanamiのサービス(インタラクタ)層について\u003c/a\u003eを読んでいただけると幸いです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003emkdir \u003c/span\u003elib/hanami_ominioauth_sample/interactors\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/hanami_ominioauth_sample/interactors/find_or_create_user_for_auth.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'hanami/interactor'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFindOrCreateUserForAuth\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eInteractor\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexpose\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e \u003cspan class=\"ss\"\u003erepository: \u003c/span\u003e\u003cspan class=\"no\"\u003eUserRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@repository\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erepository\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e \u003cspan class=\"n\"\u003eauth\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@user\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"vi\"\u003e@repository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind_by_provider_and_uid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eprovider\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"vi\"\u003e@repository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eregister\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e#find_by_provider_and_uid\u003c/code\u003eメソッドと\u003ccode\u003e#register\u003c/code\u003eメソッドを使うコードを書いたのでこれを\u003ccode\u003eUserRepository\u003c/code\u003eに実装します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/hanami_ominioauth_sample/repositories/user_repository.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUserRepository\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRepository\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efind_by_provider_and_uid\u003c/span\u003e \u003cspan class=\"n\"\u003eprovider\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003euid\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eusers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003eprovider: \u003c/span\u003e\u003cspan class=\"n\"\u003eprovider\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003euid: \u003c/span\u003e\u003cspan class=\"n\"\u003euid\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eone\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eregister\u003c/span\u003e \u003cspan class=\"n\"\u003eauth\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"ss\"\u003eprovider:   \u003c/span\u003e\u003cspan class=\"n\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eprovider\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"ss\"\u003euid:        \u003c/span\u003e\u003cspan class=\"n\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"ss\"\u003ename:       \u003c/span\u003e\u003cspan class=\"n\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"ss\"\u003eemail:      \u003c/span\u003e\u003cspan class=\"n\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eemail\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"ss\"\u003eimage_path: \u003c/span\u003e\u003cspan class=\"n\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eあとはコントローラ側でリポジトリを使うように実装していきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/controllers/session/create.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003eWeb::Controllers::Session\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCreate\u003c/span\u003e\n    \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eWeb\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e \u003cspan class=\"n\"\u003e_params\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eauth\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e'omniauth.auth'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eFindOrCreateUserForAuth\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003erepository: \u003c/span\u003e\u003cspan class=\"no\"\u003eUserRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eauth\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esuccess?\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eflash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:success\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Login seccessed\"\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eflash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:error\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Login failed\"\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eredirect_to\u003c/span\u003e \u003cspan class=\"n\"\u003eroutes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eroot_path\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e最後にtemplateを更新します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/templates/page/home.html.slim\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  h1 Home\n\n+ p = flash[:success]\n\u003cspan class=\"gi\"\u003e+ p = flash[:error]\n\u003c/span\u003e\n+ a(href=\"/auth/google_oauth2\") Login\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eHanamiサーバーを起動して localhost:2300 を開きLogin ボタンをクリックしてみましょう。Googleの認証画面が開き、アカウント選択後、元の画面に戻って「Login seccessed」と表示されていればOKです。\u003c/p\u003e\n\n\u003cp\u003e念のためデータができているかも確認してみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shll\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e$ bundle exec hanami c\nirb(main):001:0\u0026gt; UserRepository.new.all\n[hanami_ominioauth_sample] [INFO] [2018-01-03 01:20:49 +0900] (0.008787s) SELECT `id`, `provider`, `uid`, `name`, `email`, `image_path`, `created_at`, `updated_at` FROM `users` ORDER BY `users`.`id`\n=\u0026gt; [#\u0026lt;User:0x00007fcbce94f560 @attributes={:id=\u0026gt;1, :provider=\u0026gt;\"google_oauth2\", :uid=\u0026gt;\"dummy\", :name=\u0026gt;\"Isuke FUJIYAMA\", :email=\u0026gt;\"isuke_dummy@gmail.com\", :image_path=\u0026gt;\"https://dummy/photo.jpg\", :created_at=\u0026gt;2018-01-02 16:15:45 UTC, :updated_at=\u0026gt;2018-01-02 16:15:45 UTC}\u0026gt;]\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"5-セッション管理の実装\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#5-%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E7%AE%A1%E7%90%86%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e5. セッション管理の実装\u003c/h1\u003e\n\n\u003cp\u003eさて、ユーザーに毎回ログインさせるのは忍びないので、セッションでログイン情報を管理しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/controllers/session/create.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e    def call _params\n      auth = request.env['omniauth.auth']\n      result = FindOrCreateUserForAuth.new(repository: UserRepository.new).call(auth)\n      if result.success?\n\u003cspan class=\"gi\"\u003e+       session[:provider] = result.user.provider\n+       session[:uid]      = result.user.uid\n\u003c/span\u003e\n        flash[:success] = \"Login seccessed\"\n      else\n        flash[:error] = \"Login failed\"\n      end\n      redirect_to routes.root_path\n    end\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eセッションを扱う各コントローラに共通の部分を実装していきます。\u003ccode\u003eapps/web/controllers/authentication.rb\u003c/code\u003eというファイルを新規で作成して、以下のようにします。。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/controllers/authentication.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003eWeb\u003c/span\u003e\n  \u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003eAuthentication\u003c/span\u003e\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eincluded\u003c/span\u003e \u003cspan class=\"n\"\u003eaction\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eaction\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eclass_eval\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"ss\"\u003e:current_user\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"ss\"\u003e:authenticate!\u003c/span\u003e\n        \u003cspan class=\"n\"\u003eexpose\u003c/span\u003e \u003cspan class=\"ss\"\u003e:current_user\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"kp\"\u003eprivate\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eauthenticate!\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ehalt\u003c/span\u003e \u003cspan class=\"mi\"\u003e401\u003c/span\u003e \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"n\"\u003eauthenticated?\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eauthenticated?\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enil?\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecurrent_user\u003c/span\u003e\n      \u003cspan class=\"vi\"\u003e@current_user\u003c/span\u003e \u003cspan class=\"o\"\u003e||=\u003c/span\u003e \u003cspan class=\"no\"\u003eUserRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind_by_provider_and_uid\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:provider\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"n\"\u003esession\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:uid\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eさて、これをすべてのコントローラでincludeする必要がありますが、毎回書くのはだるいです。\u003ccode\u003eapplication.rb\u003c/code\u003eに記述することで対応しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/application.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e      # Configure the code that will yield each time Web::Action is included\n      # This is useful for sharing common functionality\n      #\n      # See: http://www.rubydoc.info/gems/hanami-controller#Configuration\n      controller.prepare do\n\u003cspan class=\"gd\"\u003e-       # include MyAuthentication # included in all the actions\n-       # before :authenticate!    # run an authentication before callback\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+       include Web::Authentication\n\u003c/span\u003e      end\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれで各コントローラで\u003ccode\u003eauthentication.rb\u003c/code\u003eで定義した内容が使えるようになったので、画面に反映させてみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/templates/page/home.html.slim\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  h1 Home\n\n  p = flash[:success]\n  p = flash[:error]\n\n+ - if current_user.nil?\n    a(href=\"/auth/google_oauth2\") Login\n\u003cspan class=\"gi\"\u003e+ - else\n+   image(src=current_user.image_path)\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれでログイン済みの状態のときに、ログインユーザのアイコンが表示されていればOKです。\u003c/p\u003e\n\n\u003cp\u003eさて、現状だとすべてのページがログイン必須になっているのでログインボタンがあるHomeページすらログインしないと開けません(!)。Homeページは認証をスキップするようにしましょう。と、いってもHanamiにはRailsと違って\u003ccode\u003eskip_before_action\u003c/code\u003eのようなものはないのでoverrideするだけです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/controllers/page/home.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  module Web::Controllers::Page\n    class Home\n      include Web::Action\n\n      def call(params)\n      end\n\n+   private\n\n+     def authenticate!\n\u003cspan class=\"gi\"\u003e+       # no-op\n+     end\n\u003c/span\u003e    end\n  end\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/controllers/session/create.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"p\"\u003emodule Web::Controllers::Session\n\u003c/span\u003e    class Create\n      include Web::Action\n\n      def call _params\n        ...\n      end\n\n+   private\n\n+     def authenticate!\n\u003cspan class=\"gi\"\u003e+       # no-op\n+     end\n+   end\n\u003c/span\u003e  end\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e以上で終わりです。お疲れ様でした。\u003c/p\u003e\n","body":"[Hanami](http://hanamirb.org/)でGoogle OAuthを使った認証を実装しましょう。大丈夫、超かんたんです。\n\n完成品は[こちら](https://github.com/isuke/hanami_ominioauth_sample)で見ることができます。\n\n# 1. プロジェクトの作成\n\nまずはプロジェクトを作成していきましょう。\n\n```shell\n$ gem install hanami\n```\n\n```shell\n$ hanami new hanami_ominioauth_sample --test=rspec --template=slim\n$ cd hanami_ominioauth_sample\n$ bundle install\n```\n\n# 2. Userモデルの作成\n\n次にUserモデルを作成します。\n\n```shell\n$ bundle exec hanami g model user\n      create  lib/hanami_ominioauth_sample/entities/user.rb\n      create  lib/hanami_ominioauth_sample/repositories/user_repository.rb\n      create  db/migrations/20180102151137_create_users.rb\n      create  spec/hanami_ominioauth_sample/entities/user_spec.rb\n      create  spec/hanami_ominioauth_sample/repositories/user_repository_spec.rb\n```\n\n```rb:db/migrations/20180102151137_create_users.rb\nHanami::Model.migration do\n  change do\n    create_table :users do\n      primary_key :id\n\n      column :provider  , String , null: false\n      column :uid       , String , null: false\n      column :name      , String , null: false\n      column :email     , String , null: false\n      column :image_path, String , null: true\n\n      column :created_at, DateTime, null: false\n      column :updated_at, DateTime, null: false\n\n      index [:provider, :uid], unique: true\n      index [:email]         , unique: true\n    end\n  end\nend\n```\n\n```shell\n$ bundle exec hanami db prepare\n[hanami] [INFO] (0.000842s) PRAGMA foreign_keys = 1\n[hanami] [INFO] (0.000041s) PRAGMA case_sensitive_like = 1\n[hanami] [INFO] (0.000900s) SELECT sqlite_version()\n[hanami] [ERROR] SQLite3::SQLException: no such table: schema_migrations: SELECT NULL AS 'nil' FROM `schema_migrations` LIMIT 1\n[hanami] [INFO] (0.002738s) CREATE TABLE `schema_migrations` (`filename` varchar(255) NOT NULL PRIMARY KEY)\n[hanami] [ERROR] SQLite3::SQLException: no such table: schema_info: SELECT NULL AS 'nil' FROM `schema_info` LIMIT 1\n[hanami] [INFO] (0.000211s) SELECT `filename` FROM `schema_migrations` ORDER BY `filename`\n[hanami] [INFO] Begin applying migration 20180102151137_create_users.rb, direction: up\n[hanami] [INFO] (0.001833s) CREATE TABLE `users` (`id` integer NOT NULL PRIMARY KEY AUTOINCREMENT, `provider` varchar(255) NOT NULL, `uid` varchar(255) NOT NULL, `name` varchar(255) NOT NULL, `email` varchar(255) NOT NULL, `image_path` varchar(255) NULL, `created_at` timestamp NOT NULL, `updated_at` timestamp NOT NULL)\n[hanami] [INFO] (0.001225s) CREATE UNIQUE INDEX `users_provider_uid_index` ON `users` (`provider`, `uid`)\n[hanami] [INFO] (0.001379s) CREATE UNIQUE INDEX `users_email_index` ON `users` (`email`)\n[hanami] [INFO] (0.001321s) INSERT INTO `schema_migrations` (`filename`) VALUES ('20180102151137_create_users.rb')\n[hanami] [INFO] Finished applying migration 20180102151137_create_users.rb, direction: up, took 0.007446 seconds\n```\n\nひとまずこれでUserモデルができました。\n\n# 3. Homeページの作成\n\nログインボタンを置くHomeページを作成します。\n\n```shell\n$ bundle exec hanami g action web page#home\n      create  apps/web/controllers/page/home.rb\n      create  apps/web/views/page/home.rb\n      create  apps/web/templates/page/home.html.slim\n      create  spec/web/controllers/page/home_spec.rb\n      create  spec/web/views/page/home_spec.rb\n      insert  apps/web/config/routes.rb\n```\n\n```rb:apps/web/config/routes.rb\nroot                             to: 'page#home'\nget  '/home'                   , to: 'page#home'\n```\n\n```slim:apps/web/templates/page/home.html.slim\nh1 Home\n```\n\n```shell\n$ bundle exec hanami s\n```\n\nlocalhost:2300 を開いて「Home」と表示されていればOKです。\n\n# 4. 認証の実装\n## A. クライアントIDの取得\n\nまず、次のURLを開いてください。\nhttps://console.developers.google.com\n\n上のメニューからプロジェクト名を「Hanami Ominioauth Sample」にして作成します。作成には30秒ほどかかります。作成できたら、「Hanami Ominioauth Sample」を開きましよう。\n\n![ominiauth01.png](https://qiita-image-store.s3.amazonaws.com/0/152997/7a8f595b-a232-a5e8-da88-5cdcf081f2cd.png)\n\n左側に「ライブラリ」というメニューがあるのでクリックします。\n\n![ominiauth02.png](https://qiita-image-store.s3.amazonaws.com/0/152997/ec3ef844-384a-e0d8-0e92-5fb0638ed7c4.png)\n\nここで以下の２つを有効にしてください。\n\n- Contacts API\n- Google+ API\n\n次に認証情報を作成しましす。「認証情報」をクリックしてください。\n\n![ominiauth03.png](https://qiita-image-store.s3.amazonaws.com/0/152997/6c66773a-7924-b9a8-584c-5da7e85eefef.png)\n\n\nタブから「OAuth 同意画面」を選択します。\n\n- メールアドレス: 初期値\n- ユーザーに表示するサービス名: 「Hanami Ominioauth Sample」\n- ホームページの URL: ブランク\n- サービスロゴの URL: ブランク\n- プライバシー ポリシーの URL: ブランク\n- 利用規約の URL: ブランク\n\n「認証情報を作成」 -\u003e 「OAuth クライアントID」を選択します。\n\n以下の内容を入力して「作成」を**2回**クリックします。\n\n- アプリケーションの種類: ウェブ アプリケーション\n- 名前: 「Brower」(なんでもいい)\n- 承認済みの JavaScript 生成元: ブランク\n- 承認済みのリダイレクト URI: 「http://localhost:2300/auth/google_oauth2/callback」\n\n「クライアントID」と「クライアントシークレット」が表示されるのでこれを控えておきます。\n\n## B. (option) direnv の導入\n\n先程入手した「クライアントID」と「クライアントシークレット」を管理するのにdirenvを使うと便利です。\n\nmacの場合はHomebrewでインストールできます。\n\n```shell\n$ brew install direnv\n```\n\nそして`.ernvrc`を作成します。\n\n```text:.envrv\nexport GOOGLE_CLIENT_ID=[クライアントID]\nexport GOOGLE_CLIENT_SECRET=[クライアントシークレット]\n```\n\nあとはこれを適用してあげればOKです。\n\n```shell\n$ direnv allow\n```\n\ngitを使う場合は`.gitignore`に入れておきましょう。\n\n```diff:.gitignroe\n+ .envrc\n```\n\n##  C.ominiauthを使う準備\n\nいよいよ認証部分を実装していきます。`omniauth-google-oauth2`というgemを使っていきます。\n\n```diff:Gemfile\n+ gem 'omniauth-google-oauth2'\n```\n\n```shell\n$ bundle install\n```\n\n`application.rb`　を書き換えてセッションを有効にし、さらに`omniauth`を使うように設定します。\n\n```diff:apps/web/application.rb\n      # Enable sessions\n      # Argument: Symbol the Rack session adapter\n      #           A Hash with options\n      #\n      # See: http://www.rubydoc.info/gems/rack/Rack/Session/Cookie\n      #\n-     # sessions :cookie, secret: ENV['WEB_SESSIONS_SECRET']\n+     sessions :cookie, secret: ENV['WEB_SESSIONS_SECRET']\n\n...\n\n      # Configure Rack middleware for this application\n      #\n-     # middleware.use Rack::Protection\n+     middleware.use OmniAuth::Builder do\n+       provider :google_oauth2, ENV['GOOGLE_CLIENT_ID'], ENV['GOOGLE_CLIENT_SECRET']\n+     end\n```\n\n## D. sessionコントローラーの作成\n\nsessionコントローラーを作成します。\n\n```shell\n$ bundle exec hanami g action web session#create\n      create  apps/web/controllers/session/create.rb\n      create  apps/web/views/session/create.rb\n      create  apps/web/templates/session/create.html.slim\n      create  spec/web/controllers/session/create_spec.rb\n      create  spec/web/views/session/create_spec.rb\n      insert  apps/web/config/routes.rb\n```\n\n自動生成されたコードのうち`routes.rb`をとりあえず書き換えます。\n\n```diff:apps/web/config/routes.rb\n- post '/session', to: 'session#create'\n+ post '/auth/:provider/callback', to: 'session#create'\n+ get  '/auth/:provider/callback', to: 'session#create'\n```\n\n## E. インタラクタの作成とコントローラの実装\n\n認証部分の実装をコントローラに書いていくことも可能ですが、コントローラにはあまりロジックを書きたくないので、今回はインタラクタを使います。インタラクタとはいわゆるサービスです。くわしくは[Hanamiのサービス(インタラクタ)層について](https://qiita.com/isuke/items/eaa36f0192d910091e30)を読んでいただけると幸いです。\n\n```shell\n$ mkdir lib/hanami_ominioauth_sample/interactors\n```\n\n```rb:lib/hanami_ominioauth_sample/interactors/find_or_create_user_for_auth.rb\nrequire 'hanami/interactor'\n\nclass FindOrCreateUserForAuth\n  include Hanami::Interactor\n\n  expose :user\n\n  def initialize repository: UserRepository.new\n    @repository = repository\n  end\n\n  def call auth\n    @user = @repository.find_by_provider_and_uid(auth.provider, auth.uid) || @repository.register(auth)\n  end\nend\n```\n\n`#find_by_provider_and_uid`メソッドと`#register`メソッドを使うコードを書いたのでこれを`UserRepository`に実装します。\n\n\n```rb:lib/hanami_ominioauth_sample/repositories/user_repository.rb\nclass UserRepository \u003c Hanami::Repository\n  def find_by_provider_and_uid provider, uid\n    users.where(provider: provider, uid: uid).one\n  end\n\n  def register auth\n    create(\n      provider:   auth.provider,\n      uid:        auth.uid,\n      name:       auth.info.name,\n      email:      auth.info.email,\n      image_path: auth.info.image,\n    )\n  end\nend\n```\n\nあとはコントローラ側でリポジトリを使うように実装していきます。\n\n```rb:apps/web/controllers/session/create.rb\nmodule Web::Controllers::Session\n  class Create\n    include Web::Action\n\n    def call _params\n      auth = request.env['omniauth.auth']\n      result = FindOrCreateUserForAuth.new(repository: UserRepository.new).call(auth)\n      if result.success?\n        flash[:success] = \"Login seccessed\"\n      else\n        flash[:error] = \"Login failed\"\n      end\n      redirect_to routes.root_path\n    end\n  end\nend\n```\n\n最後にtemplateを更新します。\n\n```diff:apps/web/templates/page/home.html.slim\n  h1 Home\n\n+ p = flash[:success]\n+ p = flash[:error]\n\n+ a(href=\"/auth/google_oauth2\") Login\n```\n\nHanamiサーバーを起動して localhost:2300 を開きLogin ボタンをクリックしてみましょう。Googleの認証画面が開き、アカウント選択後、元の画面に戻って「Login seccessed」と表示されていればOKです。\n\n念のためデータができているかも確認してみましょう。\n\n```shll\n$ bundle exec hanami c\nirb(main):001:0\u003e UserRepository.new.all\n[hanami_ominioauth_sample] [INFO] [2018-01-03 01:20:49 +0900] (0.008787s) SELECT `id`, `provider`, `uid`, `name`, `email`, `image_path`, `created_at`, `updated_at` FROM `users` ORDER BY `users`.`id`\n=\u003e [#\u003cUser:0x00007fcbce94f560 @attributes={:id=\u003e1, :provider=\u003e\"google_oauth2\", :uid=\u003e\"dummy\", :name=\u003e\"Isuke FUJIYAMA\", :email=\u003e\"isuke_dummy@gmail.com\", :image_path=\u003e\"https://dummy/photo.jpg\", :created_at=\u003e2018-01-02 16:15:45 UTC, :updated_at=\u003e2018-01-02 16:15:45 UTC}\u003e]\n```\n\n# 5. セッション管理の実装\n\nさて、ユーザーに毎回ログインさせるのは忍びないので、セッションでログイン情報を管理しましょう。\n\n```diff:apps/web/controllers/session/create.rb\n    def call _params\n      auth = request.env['omniauth.auth']\n      result = FindOrCreateUserForAuth.new(repository: UserRepository.new).call(auth)\n      if result.success?\n+       session[:provider] = result.user.provider\n+       session[:uid]      = result.user.uid\n\n        flash[:success] = \"Login seccessed\"\n      else\n        flash[:error] = \"Login failed\"\n      end\n      redirect_to routes.root_path\n    end\n```\n\nセッションを扱う各コントローラに共通の部分を実装していきます。`apps/web/controllers/authentication.rb`というファイルを新規で作成して、以下のようにします。。\n\n```rb:apps/web/controllers/authentication.rb\nmodule Web\n  module Authentication\n    def self.included action\n      action.class_eval do\n        before :current_user\n        before :authenticate!\n        expose :current_user\n      end\n    end\n\n  private\n\n    def authenticate!\n      halt 401 unless authenticated?\n    end\n\n    def authenticated?\n      !current_user.nil?\n    end\n\n    def current_user\n      @current_user ||= UserRepository.new.find_by_provider_and_uid(session[:provider], session[:uid])\n    end\n  end\nend\n```\n\nさて、これをすべてのコントローラでincludeする必要がありますが、毎回書くのはだるいです。`application.rb`に記述することで対応しましょう。\n\n```diff:apps/web/application.rb\n      # Configure the code that will yield each time Web::Action is included\n      # This is useful for sharing common functionality\n      #\n      # See: http://www.rubydoc.info/gems/hanami-controller#Configuration\n      controller.prepare do\n-       # include MyAuthentication # included in all the actions\n-       # before :authenticate!    # run an authentication before callback\n+       include Web::Authentication\n      end\n```\n\nこれで各コントローラで`authentication.rb`で定義した内容が使えるようになったので、画面に反映させてみましょう。\n\n```diff:apps/web/templates/page/home.html.slim\n  h1 Home\n\n  p = flash[:success]\n  p = flash[:error]\n\n+ - if current_user.nil?\n    a(href=\"/auth/google_oauth2\") Login\n+ - else\n+   image(src=current_user.image_path)\n```\n\nこれでログイン済みの状態のときに、ログインユーザのアイコンが表示されていればOKです。\n\nさて、現状だとすべてのページがログイン必須になっているのでログインボタンがあるHomeページすらログインしないと開けません(!)。Homeページは認証をスキップするようにしましょう。と、いってもHanamiにはRailsと違って`skip_before_action`のようなものはないのでoverrideするだけです。\n\n```diff:apps/web/controllers/page/home.rb\n  module Web::Controllers::Page\n    class Home\n      include Web::Action\n\n      def call(params)\n      end\n\n+   private\n\n+     def authenticate!\n+       # no-op\n+     end\n    end\n  end\n```\n\n```diff:apps/web/controllers/session/create.rb\nmodule Web::Controllers::Session\n    class Create\n      include Web::Action\n\n      def call _params\n        ...\n      end\n\n+   private\n\n+     def authenticate!\n+       # no-op\n+     end\n+   end\n  end\n```\n\n以上で終わりです。お疲れ様でした。\n","coediting":false,"comments_count":0,"created_at":"2018-01-03T02:03:41+09:00","group":null,"id":"efe9ad42559e93d8b795","likes_count":4,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"OAuth","versions":[]},{"name":"hanami","versions":[]},{"name":"ominiauth","versions":[]}],"title":"HanamiでGoogle OAuthを使った認証を実装しよう","updated_at":"2018-01-03T02:13:27+09:00","url":"https://qiita.com/isuke/items/efe9ad42559e93d8b795","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eモノリスとは一枚岩という意味で、マイクロサービスに対極に位置するものです。マイクロサービスという言葉を最初に使ったのは(おそらく)マーティンファウラーですが、彼は口を酸っぱくして「最初からマイクロサービスでつくるな」「まずはモノリスで始めよ(モノリスファースト)」といっています。\u003c/p\u003e\n\n\u003cp\u003eなぜ最初からマイクロサービスで作ってはいけないのでしょうか? それは初めからにマイクロサービスにしてしまうとメリットよりもデメリットのほうが大きくなってしまうからです。\u003c/p\u003e\n\n\u003cp\u003eではHanamiがどのようにモノリスファーストを実現しているかをいていきましょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"hanamiのモノリスファースト\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#hanami%E3%81%AE%E3%83%A2%E3%83%8E%E3%83%AA%E3%82%B9%E3%83%95%E3%82%A1%E3%83%BC%E3%82%B9%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eHanamiのモノリスファースト\u003c/h1\u003e\n\n\u003cp\u003eHanamiのアプリケーションのディレクトリ構造は以下のようになっています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eHanamiのディレクトリ構造\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"go\"\u003e[] % tree -L 3   \n\u003c/span\u003e\u003cspan class=\"c\"\u003e.\n\u003c/span\u003e\u003cspan class=\"go\"\u003e├── Gemfile\n├── Gemfile.lock\n├── README.md\n├── Rakefile\n├── apps\n│   ├── api_v1\n│   │   ├── application.rb\n│   │   ├── config\n│   │   ├── controllers\n│   │   └── types\n│   └── web\n│       ├── application.rb\n│       ├── config\n│       ├── controllers\n│       ├── frontend\n│       ├── node_modules\n│       ├── package.json\n│       ├── templates\n│       ├── views\n│       ├── webpack-assets.json\n│       ├── webpack.config.coffee\n│       └── yarn.lock\n├── config\n│   ├── boot.rb\n│   ├── environment.rb\n│   └── initializers\n├── config.ru\n├── lib\n│   ├── my_app\n│   │   ├── entities\n│   │   ├── mailers\n│   │   └── repositories\n│   └── my_app.rb\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eapps\u003c/code\u003eというディレクトリがポイントで、このなかに複数のアプリケーション(\u003ccode\u003eapi_v1\u003c/code\u003e, \u003ccode\u003eweb\u003c/code\u003e)が入っています。\u003cbr\u003e\nそしてそれぞれのアプリケーションに\u003ccode\u003econtrollers\u003c/code\u003eと\u003ccode\u003eviews\u003c/code\u003eがあるのがわかります。\u003cbr\u003e\n実は\u003ccode\u003econfig\u003c/code\u003eのかなには\u003ccode\u003eroutes.rb\u003c/code\u003eが入っています。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003elib\u003c/code\u003eディレクトをみるとここには\u003ccode\u003eentities\u003c/code\u003eと\u003ccode\u003erepositories\u003c/code\u003eがあります。\u003cbr\u003e\nentitiesはビジネスロジックを記述する場所で、repositoriesはDBとのやり取りを記述する場所です。\u003c/p\u003e\n\n\u003cp\u003eこのようにコントローラやビューをアプリケーションごとに分離しながらビジネスロジックを共有することで、できるだけ管理可能な形でモノリスに保つというのがHanamiの特徴です。\u003c/p\u003e\n\n\u003cp\u003eいいね！\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考資料\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83%E8%B3%87%E6%96%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考資料\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"http://hanamirb.org/guides/1.1/architecture/overview/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://hanamirb.org/guides/1.1/architecture/overview/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://martinfowler.com/bliki/MonolithFirst.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://martinfowler.com/bliki/MonolithFirst.html\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","body":"モノリスとは一枚岩という意味で、マイクロサービスに対極に位置するものです。マイクロサービスという言葉を最初に使ったのは(おそらく)マーティンファウラーですが、彼は口を酸っぱくして「最初からマイクロサービスでつくるな」「まずはモノリスで始めよ(モノリスファースト)」といっています。\n\nなぜ最初からマイクロサービスで作ってはいけないのでしょうか? それは初めからにマイクロサービスにしてしまうとメリットよりもデメリットのほうが大きくなってしまうからです。\n\nではHanamiがどのようにモノリスファーストを実現しているかをいていきましょう。\n\n# Hanamiのモノリスファースト\n\nHanamiのアプリケーションのディレクトリ構造は以下のようになっています。\n\n```shell-session:Hanamiのディレクトリ構造\n[] % tree -L 3   \n.\n├── Gemfile\n├── Gemfile.lock\n├── README.md\n├── Rakefile\n├── apps\n│   ├── api_v1\n│   │   ├── application.rb\n│   │   ├── config\n│   │   ├── controllers\n│   │   └── types\n│   └── web\n│       ├── application.rb\n│       ├── config\n│       ├── controllers\n│       ├── frontend\n│       ├── node_modules\n│       ├── package.json\n│       ├── templates\n│       ├── views\n│       ├── webpack-assets.json\n│       ├── webpack.config.coffee\n│       └── yarn.lock\n├── config\n│   ├── boot.rb\n│   ├── environment.rb\n│   └── initializers\n├── config.ru\n├── lib\n│   ├── my_app\n│   │   ├── entities\n│   │   ├── mailers\n│   │   └── repositories\n│   └── my_app.rb\n```\n\n`apps`というディレクトリがポイントで、このなかに複数のアプリケーション(`api_v1`, `web`)が入っています。\nそしてそれぞれのアプリケーションに`controllers`と`views`があるのがわかります。\n実は`config`のかなには`routes.rb`が入っています。\n\n`lib`ディレクトをみるとここには`entities`と`repositories`があります。\nentitiesはビジネスロジックを記述する場所で、repositoriesはDBとのやり取りを記述する場所です。\n\nこのようにコントローラやビューをアプリケーションごとに分離しながらビジネスロジックを共有することで、できるだけ管理可能な形でモノリスに保つというのがHanamiの特徴です。\n\nいいね！\n\n# 参考資料\n\n- http://hanamirb.org/guides/1.1/architecture/overview/\n- https://martinfowler.com/bliki/MonolithFirst.html\n","coediting":false,"comments_count":0,"created_at":"2017-12-22T17:57:33+09:00","group":null,"id":"134d82246203026857c6","likes_count":2,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"microservices","versions":[]},{"name":"architecture","versions":[]},{"name":"hanami","versions":[]},{"name":"MonolithFirst","versions":[]}],"title":"Hanamiの２つの原則のうちの1つ モノリスファーストとは何なのか","updated_at":"2017-12-24T07:01:52+09:00","url":"https://qiita.com/isuke/items/134d82246203026857c6","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ca href=\"http://hanamirb.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHanami\u003c/a\u003eのアーキテクチャには\u003ca href=\"http://hanamirb.org/guides/1.1/architecture/overview/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e２つの原則があります\u003c/a\u003e。\u003cbr\u003e\nそれは\u003cstrong\u003eクリーンアーキテクチャ\u003c/strong\u003eと\u003cstrong\u003eモノリスファースト\u003c/strong\u003eです。モノリスファーストについては後日語るとして、クリーンアーキテクチャとは何なのでしょうか?自分なりの理解と考えをまとめてみたいと思います。\u003c/p\u003e\n\n\u003cp\u003e現時点での著者の考えなので間違いや理解不足が大いにあると思います。温かい目で読んで下さい。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"クリーンアーキテクチャって\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E3%81%A3%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクリーンアーキテクチャって?\u003c/h1\u003e\n\n\u003cp\u003eまずは\u003ca href=\"http://hanamirb.org/guides/1.1/architecture/overview/#clean-architecture\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHanamiの公式\u003c/a\u003eを引用してみます。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThe main purpose of this architecture is to enforce a separation of concerns between the core of our product and the delivery mechanisms. The first is expressed by the set of use cases that our product implements, while the latter are interfaces to make these features available to the outside world.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e機械翻訳\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eこのアーキテクチャの主な目的はプロダクトのコアと配信メカニズムの間の関心事の分離を強制することです。\u003cbr\u003e\nプロダクトのコアは一連のユースケースで表され、配信メカニズムはこれらの機能を外部世界で利用できるようにするインターフェースです。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eこれだけだとよくわかりませんね。\u003c/p\u003e\n\n\u003cp\u003eクリーンアーキテクチャを理解するには、MVCアーキテクチャの問題点を理解し、クリーンアーキテクチャがどのようにして生まれたのかを考えるとわかりやすいと思います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"mvcアーキテクチャの問題点\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#mvc%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMVCアーキテクチャの問題点\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"mvcアーキテクチャ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#mvc%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMVCアーキテクチャ\u003c/h3\u003e\n\n\u003cp\u003eMVCアーキテクチャについて考えてみたいと思います(ものすごく浅い理解なので然るべき人に怒られそうですが)。MVCアーキテクチャはこんなふうによく書かれると思います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMVCアーキテクチャ\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e====================\n| V (View)         |\n====================\n| C (Controller)   |\n====================\n| M (Model)        |\n====================\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cul\u003e\n\u003cli\u003eView: 見た目の部分です。インターフェースでもあります。\u003c/li\u003e\n\u003cli\u003eController: ViewとModelの調整役です。\u003c/li\u003e\n\u003cli\u003eModel: ビジネスロジックです。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e各レイヤーは自分と同じレイヤかそれ以下のことしか知りません。このように関心の方向を一方向にすることで複雑さを回避しようというのが根本的な考え方だと思います。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"modelのもう一つの役割\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#model%E3%81%AE%E3%82%82%E3%81%86%E4%B8%80%E3%81%A4%E3%81%AE%E5%BD%B9%E5%89%B2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eModelのもう一つの役割\u003c/h3\u003e\n\n\u003cp\u003eModelはビジネスロジックを書く場所ですが、もう一つ役割があります。\u003cbr\u003e\nそれはインフラストラクチャの取扱いです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eModelレイヤの２つの役割\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e========================\n| V (View)             |\n========================\n| C (Controller)       |\n========================\n| M ビジネスロジック   |\n| -------------------- |(薄い壁)\n| インフラストラクチャ |\n========================\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eインフラストラクチャレイヤではDBなどへのデータの保存や取出しを行います。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"依存性の逆転原則\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BE%9D%E5%AD%98%E6%80%A7%E3%81%AE%E9%80%86%E8%BB%A2%E5%8E%9F%E5%89%87\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e依存性の逆転原則\u003c/h3\u003e\n\n\u003cp\u003eいったん話は変わって\u003cstrong\u003e依存性の逆転原則\u003c/strong\u003eの話です。\u003c/p\u003e\n\n\u003cp\u003e依存性の逆転原則とは\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e上位のモジュールは下位のモジュールに依存してはならない。どちらのモジュールも「抽象」に依存すべきである\u003cbr\u003e\n「抽象」は実装の詳細に依存してはならない。実装の詳細が「抽象」に依存すべきである\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eという原則です。\u003c/p\u003e\n\n\u003cp\u003e詳しくは説明しませんが(できませんが)、オブジェクト指向でプログラミングをする上で非常に大事な原則です。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"mvcアーキテクチャへの問題点\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#mvc%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E3%81%B8%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMVCアーキテクチャへの問題点\u003c/h3\u003e\n\n\u003cp\u003e依存性の逆転原則という観点でMVCアーキテクチャを見てみるとどうなるでしょうか?依存性の逆転原則では「抽象」に依存しろ、といっています。\u003c/p\u003e\n\n\u003cp\u003eMVCアーキテクチャでの「抽象」はどれでしょうか?それはビジネスロジックです。では実装の詳細はビジネスロジックに依存しているでしょうか? いえ、していないですね。先程見ていただいたようにビジネスロジックはインフラストラクチャに依存しています。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eビジネスロジックはインフラストラクチャに依存している\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e========================\n| V (View)             |\n========================\n| C (Controller)       |\n========================\n| M ビジネスロジック   | \u0026lt;-インフラストラクチャに依存している!\n| -------------------- |\n| インフラストラクチャ |\n========================\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこのことがMVCアーキテクチャの問題点であると著者は考えます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"mvcアーキテクチャへの依存性の逆転原則の適用とクリーンアーキテクチャの誕生\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#mvc%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E3%81%B8%E3%81%AE%E4%BE%9D%E5%AD%98%E6%80%A7%E3%81%AE%E9%80%86%E8%BB%A2%E5%8E%9F%E5%89%87%E3%81%AE%E9%81%A9%E7%94%A8%E3%81%A8%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3%E3%81%AE%E8%AA%95%E7%94%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMVCアーキテクチャへの依存性の逆転原則の適用とクリーンアーキテクチャの誕生\u003c/h2\u003e\n\n\u003cp\u003eMVCアーキテクチャの問題点を解決するために依存性の逆転原則を適用してみましょう。\u003cbr\u003e\nこうなります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMVCアーキテクチャに依存性の逆転原則を適用\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e====================================\n| V (View)  | インフラストラクチャ |\n====================================\n| C (Controller)                   |\n====================================\n| M ビジネスロジック               |\n====================================\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eインフラストラクチャが一番上に来ました。これによりビジネスロジックが(ビジネスロジック自身以外には)どこにも依存しないようになりました。\u003c/p\u003e\n\n\u003cp\u003eこれをもうちょっときれいにすると(適当)以下のようになります。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2F8thlight.com%2Fblog%2Fassets%2Fposts%2F2012-08-13-the-clean-architecture%2FCleanArchitecture.jpg?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=48b47204a12490d9d975df231264bd6f\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2F8thlight.com%2Fblog%2Fassets%2Fposts%2F2012-08-13-the-clean-architecture%2FCleanArchitecture.jpg?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=48b47204a12490d9d975df231264bd6f\" alt=\"The Clean Architecture\" data-canonical-src=\"https://8thlight.com/blog/assets/posts/2012-08-13-the-clean-architecture/CleanArchitecture.jpg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2F8thlight.com%2Fblog%2Fassets%2Fposts%2F2012-08-13-the-clean-architecture%2FCleanArchitecture.jpg?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=52e7983f3e41dc32fb01e4aebb796401 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e(\u003ca href=\"https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html%E3%81%8B%E3%82%89%E5%BC%95%E7%94%A8\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.htmlから引用\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003e内側からざっくり説明すると以下のようになります(ちゃんと知りたい人はリンク先を読んで下さい)。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eEntities: ビジネスロジック\u003c/li\u003e\n\u003cli\u003eUse Case: Entities間データの流れを制御します\u003c/li\u003e\n\u003cli\u003eInterface Adapters: データをいい感じの形式に変換します\u003c/li\u003e\n\u003cli\u003eFrameworks and Drivers: WebやDBなどすべての詳細を追いやるところです\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e上記の図では4層で構成されていますが、この数は重要ではありません。3層でもいいし、5層でもいいです。大切なのはビジネスロジックが中心にあるということです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"hanamiのクリーンアーキテクチャ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#hanami%E3%81%AE%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%A2%E3%83%BC%E3%82%AD%E3%83%86%E3%82%AF%E3%83%81%E3%83%A3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eHanamiのクリーンアーキテクチャ\u003c/h1\u003e\n\n\u003cp\u003eHanamiではどのようにクリーンアーキテクチャを実現しているのでしょうか?\u003c/p\u003e\n\n\u003cp\u003e1つは\u003ca href=\"http://rom-rb.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eROM(Ruby Object Mapper)\u003c/a\u003eの採用があります。\u003c/p\u003e\n\n\u003cp\u003eROMはORマッパーの一種ですが、EntityとRepositoryが完全に分離されていることが大きな特徴です。\u003cbr\u003e\nクリーンアーキテクチャではEntityとRepositoryの分離は欠かせませんから、ROMはHanamiのアーキテクチャに大きく貢献しているといえます。\u003c/p\u003e\n\n\u003cp\u003eもう1つはインタラクタのサポートです。インタラクタはおそらくサービスやユースケースといったほうが通りがいいと思います。\u003cbr\u003e\nHanamiはインタラクタ層の実装を簡単にするためのツールを用意しています。これを使うことは必須ではありませんが、Hanamiでクリーンアーキテクチャを体現しようとしたときに多いに役立ってくれるでしょう。\u003c/p\u003e\n\n\u003cp\u003eインタラクタについてもうちょっと知りたいという人は\u003ca href=\"https://qiita.com/isuke/items/eaa36f0192d910091e30\" id=\"reference-1eec9cbcc38f0b9a0a59\"\u003e前回の記事\u003c/a\u003eを読んでいただけると幸いです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"感想\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%84%9F%E6%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e感想\u003c/h1\u003e\n\n\u003cp\u003e正直、自分のスキルでクリーンアーキテクチャを語るのは時期尚早だった。\u003cbr\u003e\nもうちょっと修行してきます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.amazon.co.jp/dp/B00UX9VJGW/ref=dp-kindle-redirect?_encoding=UTF8\u0026amp;btkr=1\" rel=\"nofollow noopener\" target=\"_blank\"\u003e実践ドメイン駆動設計\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://hanamirb.org/guides/1.1/architecture/interactors/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://hanamirb.org/guides/1.1/architecture/interactors/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","body":"[Hanami](http://hanamirb.org/)のアーキテクチャには[２つの原則があります](http://hanamirb.org/guides/1.1/architecture/overview/)。\nそれは**クリーンアーキテクチャ**と**モノリスファースト**です。モノリスファーストについては後日語るとして、クリーンアーキテクチャとは何なのでしょうか?自分なりの理解と考えをまとめてみたいと思います。\n\n現時点での著者の考えなので間違いや理解不足が大いにあると思います。温かい目で読んで下さい。\n\n# クリーンアーキテクチャって?\nまずは[Hanamiの公式](http://hanamirb.org/guides/1.1/architecture/overview/#clean-architecture)を引用してみます。\n\n\u003e The main purpose of this architecture is to enforce a separation of concerns between the core of our product and the delivery mechanisms. The first is expressed by the set of use cases that our product implements, while the latter are interfaces to make these features available to the outside world.\n\n機械翻訳\n\n\u003e このアーキテクチャの主な目的はプロダクトのコアと配信メカニズムの間の関心事の分離を強制することです。\nプロダクトのコアは一連のユースケースで表され、配信メカニズムはこれらの機能を外部世界で利用できるようにするインターフェースです。\n\nこれだけだとよくわかりませんね。\n\nクリーンアーキテクチャを理解するには、MVCアーキテクチャの問題点を理解し、クリーンアーキテクチャがどのようにして生まれたのかを考えるとわかりやすいと思います。\n\n## MVCアーキテクチャの問題点\n### MVCアーキテクチャ\n\nMVCアーキテクチャについて考えてみたいと思います(ものすごく浅い理解なので然るべき人に怒られそうですが)。MVCアーキテクチャはこんなふうによく書かれると思います。\n\n```text:MVCアーキテクチャ\n====================\n| V (View)         |\n====================\n| C (Controller)   |\n====================\n| M (Model)        |\n====================\n```\n\n- View: 見た目の部分です。インターフェースでもあります。\n- Controller: ViewとModelの調整役です。\n- Model: ビジネスロジックです。\n\n各レイヤーは自分と同じレイヤかそれ以下のことしか知りません。このように関心の方向を一方向にすることで複雑さを回避しようというのが根本的な考え方だと思います。\n\n### Modelのもう一つの役割\nModelはビジネスロジックを書く場所ですが、もう一つ役割があります。\nそれはインフラストラクチャの取扱いです。\n\n```text:Modelレイヤの２つの役割\n========================\n| V (View)             |\n========================\n| C (Controller)       |\n========================\n| M ビジネスロジック   |\n| -------------------- |(薄い壁)\n| インフラストラクチャ |\n========================\n```\n\nインフラストラクチャレイヤではDBなどへのデータの保存や取出しを行います。\n\n### 依存性の逆転原則\n\nいったん話は変わって**依存性の逆転原則**の話です。\n\n依存性の逆転原則とは\n\n\u003e 上位のモジュールは下位のモジュールに依存してはならない。どちらのモジュールも「抽象」に依存すべきである\n「抽象」は実装の詳細に依存してはならない。実装の詳細が「抽象」に依存すべきである\n\nという原則です。\n\n詳しくは説明しませんが(できませんが)、オブジェクト指向でプログラミングをする上で非常に大事な原則です。\n\n### MVCアーキテクチャへの問題点\n\n依存性の逆転原則という観点でMVCアーキテクチャを見てみるとどうなるでしょうか?依存性の逆転原則では「抽象」に依存しろ、といっています。\n\nMVCアーキテクチャでの「抽象」はどれでしょうか?それはビジネスロジックです。では実装の詳細はビジネスロジックに依存しているでしょうか? いえ、していないですね。先程見ていただいたようにビジネスロジックはインフラストラクチャに依存しています。\n\n```text:ビジネスロジックはインフラストラクチャに依存している\n========================\n| V (View)             |\n========================\n| C (Controller)       |\n========================\n| M ビジネスロジック   | \u003c-インフラストラクチャに依存している!\n| -------------------- |\n| インフラストラクチャ |\n========================\n```\n\nこのことがMVCアーキテクチャの問題点であると著者は考えます。\n\n## MVCアーキテクチャへの依存性の逆転原則の適用とクリーンアーキテクチャの誕生\n\nMVCアーキテクチャの問題点を解決するために依存性の逆転原則を適用してみましょう。\nこうなります。\n\n```text:MVCアーキテクチャに依存性の逆転原則を適用\n====================================\n| V (View)  | インフラストラクチャ |\n====================================\n| C (Controller)                   |\n====================================\n| M ビジネスロジック               |\n====================================\n```\n\nインフラストラクチャが一番上に来ました。これによりビジネスロジックが(ビジネスロジック自身以外には)どこにも依存しないようになりました。\n\nこれをもうちょっときれいにすると(適当)以下のようになります。\n\n![The Clean Architecture](https://8thlight.com/blog/assets/posts/2012-08-13-the-clean-architecture/CleanArchitecture.jpg)\n\n(https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.htmlから引用)\n\n内側からざっくり説明すると以下のようになります(ちゃんと知りたい人はリンク先を読んで下さい)。\n\n- Entities: ビジネスロジック\n- Use Case: Entities間データの流れを制御します\n- Interface Adapters: データをいい感じの形式に変換します\n- Frameworks and Drivers: WebやDBなどすべての詳細を追いやるところです\n\n上記の図では4層で構成されていますが、この数は重要ではありません。3層でもいいし、5層でもいいです。大切なのはビジネスロジックが中心にあるということです。\n\n# Hanamiのクリーンアーキテクチャ\n\nHanamiではどのようにクリーンアーキテクチャを実現しているのでしょうか?\n\n1つは[ROM(Ruby Object Mapper)](http://rom-rb.org/)の採用があります。\n\nROMはORマッパーの一種ですが、EntityとRepositoryが完全に分離されていることが大きな特徴です。\nクリーンアーキテクチャではEntityとRepositoryの分離は欠かせませんから、ROMはHanamiのアーキテクチャに大きく貢献しているといえます。\n\nもう1つはインタラクタのサポートです。インタラクタはおそらくサービスやユースケースといったほうが通りがいいと思います。\nHanamiはインタラクタ層の実装を簡単にするためのツールを用意しています。これを使うことは必須ではありませんが、Hanamiでクリーンアーキテクチャを体現しようとしたときに多いに役立ってくれるでしょう。\n\nインタラクタについてもうちょっと知りたいという人は[前回の記事](https://qiita.com/isuke/items/eaa36f0192d910091e30)を読んでいただけると幸いです。\n\n# 感想\n\n正直、自分のスキルでクリーンアーキテクチャを語るのは時期尚早だった。\nもうちょっと修行してきます。\n\n# 参考\n\n- [実践ドメイン駆動設計](https://www.amazon.co.jp/dp/B00UX9VJGW/ref=dp-kindle-redirect?_encoding=UTF8\u0026btkr=1)\n- https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html\n- http://hanamirb.org/guides/1.1/architecture/interactors/\n\n\n","coediting":false,"comments_count":0,"created_at":"2017-12-22T17:47:11+09:00","group":null,"id":"ce09bc2eb303c90e387d","likes_count":3,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"DDD","versions":[]},{"name":"hanami","versions":[]},{"name":"CleanArchitecture","versions":[]}],"title":"Hanamiの２つの原則のうちの1つ クリーンアーキテクチャとは何なのか","updated_at":"2017-12-23T07:01:28+09:00","url":"https://qiita.com/isuke/items/ce09bc2eb303c90e387d","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\n\u003ch2\u003e\n\u003cspan id=\"romruby-object-mapperとは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#romruby-object-mapper%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eROM(Ruby Object Mapper)とは\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"http://rom-rb.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eROM(Ruby Object Mapper)\u003c/a\u003eはActiveModelに代表されるようなRubyのORマッパーの1つです。\u003c/p\u003e\n\n\u003cp\u003eEntityとRepositoryが分離されていることが特徴で、\u003ca href=\"http://hanamirb.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHanamiフレームワーク\u003c/a\u003eで採用されています。\u003c/p\u003e\n\n\u003cp\u003eROMの基本的な使い方を説明していきたいと思います。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"準備\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%BA%96%E5%82%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e準備\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"gem\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#gem\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003egem\u003c/h3\u003e\n\n\u003cp\u003e必要なgem構成は以下の通り(\u003ccode\u003epry\u003c/code\u003eは任意)です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGemfile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e# frozen_string_literal: true\u003c/span\u003e\n\u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"https://rubygems.org\"\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eruby\u003c/span\u003e \u003cspan class=\"s1\"\u003e'2.4.2'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'rom-repository'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'2.0.2'\u003c/span\u003e\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'rom-sql'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'2.3.0'\u003c/span\u003e\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sqlite3'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'1.3.13'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egroup\u003c/span\u003e \u003cspan class=\"ss\"\u003e:development\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'pry'\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"テーブルの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテーブルの作成\u003c/h3\u003e\n\n\u003cp\u003e以下のようにすると\u003ccode\u003eusers\u003c/code\u003eテーブルが作成できるのでこれを使っていきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapp.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'rom-repository'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'pry'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003erom\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003econtainer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:sql\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sqlite::memory'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate_table\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:email\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUsers\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRelation\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:sql\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003einfer: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eregister_relation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eUsers\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eよくわからないものがいきなりたくさん出てきてしましましが、今はこれでテーブルとRelationが作られる、と思ってください。\u003c/p\u003e\n\n\u003cp\u003eRelationについては後ほど説明します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"基本的なcreateupdatedelete\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AAcreateupdatedelete\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e基本的なCreate/Update/Delete\u003c/h2\u003e\n\n\u003cp\u003e最初に\u003ccode\u003eUserRepo\u003c/code\u003eクラスを作成しています。これはDBに対する操作を定義するためのクラスです。DB操作メソッドは\u003ccode\u003eROM::Repository\u003c/code\u003eを継承したクラスの中に定義します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUserRepo\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ecommands\u003c/span\u003e \u003cspan class=\"ss\"\u003e:create\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eupdate: :by_pk\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003edelete: :by_pk\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e上記のコードでは\u003ccode\u003eUserRepo\u003c/code\u003eに対して基本的なCreate/Update/Deleteメソッドを定義しています。\u003c/p\u003e\n\n\u003cp\u003eこれを使ってみましょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"create\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#create\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCreate\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Jane\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eemail: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"jane@doe.org\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct[User] id=1 name=\"Jane\" email=\"jane@doe.org\"\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e   \u003cspan class=\"c1\"\u003e# =\u0026gt; 1\u003c/span\u003e\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; \"Jane\"\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eUserRepo\u003c/code\u003eのインスタンスに対して\u003ccode\u003e#create\u003c/code\u003eを投げることで、DBへレコードの保存とuserのインスタンスの作成が行われます。このように\u003cstrong\u003e「DB操作」と「レコードをマップしたインスタンス」が別のオブジェクトである\u003c/strong\u003eというのがActiveRecordなどと比較したときのROMの特徴ですので覚えておきましょう。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"update\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#update\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUpdate\u003c/h3\u003e\n\n\u003cp\u003eUpdateは下記のように行います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003eupdated_user\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eupdate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Jane Doe\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct[User] id=1 name=\"Jane Doe\" email=\"jane@doe.org\"\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこのとき、ActiveRecordの感覚で以下のようにやってもだめです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eNG\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Jane Doe\"\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e#=\u0026gt; ROM::Struct::MissingAttribute: undefined method `name=' for #\u0026lt;ROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u0026gt;\u003c/span\u003e\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esave\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003euserはイミュータブルなオブジェクトで、代入するメソッドなどは持っていないので要注意です。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"delate\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#delate\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eDelate\u003c/h3\u003e\n\n\u003cp\u003eDeleteは以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"read\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#read\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRead\u003c/h2\u003e\n\n\u003cp\u003eRead用のメソッド\u003ccode\u003equery\u003c/code\u003eと\u003ccode\u003eby_id\u003c/code\u003eを\u003ccode\u003eUserRepo\u003c/code\u003eに定義しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUserRepo\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ecommands\u003c/span\u003e \u003cspan class=\"ss\"\u003e:create\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eusers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_a\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eby_id\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eusers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_pk\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eone!\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e幾つかの新しいキーワードが出てきました。1つずつ確認しましょう。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e#users\u003c/code\u003e : Relation(後述)\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e#where\u003c/code\u003e : Relationを条件で絞り込み。Relationを返す。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e#by_pk\u003c/code\u003e : Relationを主キーで絞り込み。Relationを返す。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e#to_a\u003c/code\u003e : RelationをStructの配列に変換\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e#one!\u003c/code\u003e : RelationをStructに変換\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e上の例では出てきませんでしたが\u003ccode\u003e#one\u003c/code\u003e(\u003ccode\u003e!\u003c/code\u003eなし)というのもあります。\u003cbr\u003e\n\u003ccode\u003e#one\u003c/code\u003eと\u003ccode\u003e#one!\u003c/code\u003eの違いは以下です。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e#one\u003c/code\u003e : 結果が0件or1件ならStructに変換(0件の場合はnil), 複数件の場合はerror\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e#one!\u003c/code\u003e : 結果が1件ならStructに変換, 複数件or0件の場合はerror\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e定義したメソッドは以下のように使います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eUserRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erom\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Jane\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eemail: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"jane@doe.org\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Jane\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eemail: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"jane@example.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Jane\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; [#\u0026lt;ROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u0026gt;, #\u0026lt;ROM::Struct::User id=2 name=\"Jane\" email=\"jane@example.com\"\u0026gt;]\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_id\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct::User id=2 name=\"Jane\" email=\"jane@example.com\"\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"結果を独自クラスにする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B5%90%E6%9E%9C%E3%82%92%E7%8B%AC%E8%87%AA%E3%82%AF%E3%83%A9%E3%82%B9%E3%81%AB%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e結果を独自クラスにする\u003c/h3\u003e\n\n\u003cp\u003eさて、ここまでのReadメソッドでは戻り値がStructでした。これは独自クラスに変更することができます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUser\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eattr_reader\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:email\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vi\"\u003e@name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"vi\"\u003e@email\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eattributes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003evalues_at\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:email\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUserRepo\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ecommands\u003c/span\u003e \u003cspan class=\"ss\"\u003e:create\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eusers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003emap_to\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eUser\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003emap_to(User)\u003c/code\u003eというのがポイントで、これによって結果を\u003ccode\u003eUser\u003c/code\u003eインスタンスにしてくれます。\u003c/p\u003e\n\n\u003cp\u003e試して見ます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eUserRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erom\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Jane\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eemail: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"jane@doe.org\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003equery\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Jane\"\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003efirst\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;User @email=\"jane@doe.org\", @id=1, @name=\"Jane\"\u0026gt;\u003c/span\u003e\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eclass\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; User\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eここで注目したいのは\u003ccode\u003eUser\u003c/code\u003eクラスは何も継承もMixinもしていないPureなRubyであるということです。これによって\u003ccode\u003eUser\u003c/code\u003eクラスを\u003cstrong\u003e従来のデザインパターンを使って、好きなだけ表現力豊かなモデルにすることができます\u003c/strong\u003e。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"relation\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#relation\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRelation\u003c/h2\u003e\n\n\u003cp\u003eさて、さんざん後回しにされていたRelationの説明です。\u003c/p\u003e\n\n\u003cp\u003eRelationは低レベルなCRUDのためのAPIを提供するものです。\u003c/p\u003e\n\n\u003cp\u003eRelationクラスはこのように定義します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUsers\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRelation\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:sql\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eschema\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eattribute\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e   \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eTypes\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eInt\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eattribute\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eTypes\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eString\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eattribute\u003c/span\u003e \u003cspan class=\"ss\"\u003e:email\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eTypes\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eString\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eschema\u003c/code\u003eメソッドでテーブルのカラムと主キーを定義します。\u003c/p\u003e\n\n\u003cp\u003e以下のように省略して書くこともできます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUsers\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRelation\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:sql\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003einfer: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eschema(infer: true)\u003c/code\u003eとすることでクラス名から推測して\u003ccode\u003eusers\u003c/code\u003eテーブルの定義を参照してくれます。\u003c/p\u003e\n\n\u003cp\u003eRelationにメソッドを書いてみましょう。Relationのメソッドは必ず戻り値もRelationでなければならないというルールがあります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapp.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'rom-repository'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'pry'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003erom\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003econtainer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:sql\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sqlite::memory'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate_table\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:email\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUsers\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRelation\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:sql\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003einfer: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003elisting\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eselect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eregister_relation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eUsers\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUserRepo\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ecommands\u003c/span\u003e \u003cspan class=\"ss\"\u003e:create\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003elisting\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eusers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elisting\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_a\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e使ってみます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eUserRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erom\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Jane\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eemail: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"jane@doe.org\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Bob\"\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eemail: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"bob@example.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elisting\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; [#\u0026lt;ROM::Struct::User name=\"Bob\"\u0026gt;, #\u0026lt;ROM::Struct::User name=\"Jane\"\u0026gt;]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"associations\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#associations\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAssociations\u003c/h1\u003e\n\n\u003cp\u003eアソシエーションを使っていきましょう。ここからは以下のテーブルを使います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003erom\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003econtainer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:sql\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sqlite::memory'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate_table\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:email\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate_table\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eforeign_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:title\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eusers\u003c/code\u003eと\u003ccode\u003etasks\u003c/code\u003eは1対多の関係になっています。この関係を定義しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003erom\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003econtainer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:sql\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sqlite::memory'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate_table\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:email\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate_table\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eforeign_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:title\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erelation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003einfer: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eassociations\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ehas_many\u003c/span\u003e \u003cspan class=\"ss\"\u003e:tasks\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003econf\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erelation\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003einfer: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eassociations\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n        \u003cspan class=\"n\"\u003ebelongs_to\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003econf.relation\u003c/code\u003eでリレーションに対してアソシエーションを定義しています。\u003c/p\u003e\n\n\u003cp\u003e使ってみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eUserRepo\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ecommands\u003c/span\u003e \u003cspan class=\"ss\"\u003e:create\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eby_id\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eusers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_pk\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eone!\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTaskRepo\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ecommands\u003c/span\u003e \u003cspan class=\"ss\"\u003e:create\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eby_id\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_pk\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eone!\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eUserRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erom\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003etask_repo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eTaskRepo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erom\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Jane\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eemail: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"jane@doe.org\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003etask_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003euser_id: \u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003etitle: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"n\"\u003etask_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003euser_id: \u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003etitle: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"bar\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eaggregate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eone\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\" tasks=[#\u0026lt;ROM::Struct::Task id=1 user_id=1 title=\"foo\"\u0026gt;, #\u0026lt;ROM::Struct::Task id=2 user_id=1 title=\"bar\"\u0026gt;]\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etasks\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; [#\u0026lt;ROM::Struct::Task id=1 user_id=1 title=\"foo\"\u0026gt;, #\u0026lt;ROM::Struct::Task id=2 user_id=1 title=\"bar\"\u0026gt;]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e#aggregate\u003c/code\u003eを使うことでリレーションを含んだ(\u003ccode\u003eCombined\u003c/code\u003eクラスの)インスタンスが生成されます。\u003c/p\u003e\n\n\u003cp\u003e以下のように\u003ccode\u003e#aggregate\u003c/code\u003eを使わずに\u003ccode\u003euser\u003c/code\u003eから\u003ccode\u003etasks\u003c/code\u003eを使おうとしても失敗します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eNG\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_id\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u0026gt;\u003c/span\u003e\n\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etasks\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; ROM::Struct::MissingAttribute: undefined method `tasks' for #\u0026lt;ROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u0026gt; (attribute not loaded?)\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003efrom\u003c/span\u003e \u003cspan class=\"n\"\u003erom\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003esample\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003evendor\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ebundle\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eruby\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mf\"\u003e2.4\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003egems\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003erom\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003emapper\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.1\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003elib\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003erom\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003estruct\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erb\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e112\u003c/span\u003e\u003cspan class=\"ss\"\u003e:in\u003c/span\u003e \u003cspan class=\"sb\"\u003e`rescue in method_missing'\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003etasks\u003c/code\u003e から \u003ccode\u003euser\u003c/code\u003e を含める場合は以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003etask_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eaggregate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003efirst\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e単に、ある\u003ccode\u003etask\u003c/code\u003eに対して\u003ccode\u003euser\u003c/code\u003eを取得するには単純に以下のようにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003etask\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etask_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_id\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct::Task id=1 user_id=1 title=\"foo\"\u0026gt;\u003c/span\u003e\n\u003cspan class=\"n\"\u003euser_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_id\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser_id\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eしかし、これはちょっと面倒くさいですね。やっぱり\u003ccode\u003etask.user\u003c/code\u003eの形でアクセスしたいです。\u003c/p\u003e\n\n\u003cp\u003eこれを実現するためには以下のようなメソッドを用意します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTaskRepo\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eROM\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:tasks\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ecommands\u003c/span\u003e \u003cspan class=\"ss\"\u003e:create\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eby_id\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_pk\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eone!\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eby_id_with_user\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etasks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_pk\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ewrap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eone\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003etask\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etask_repo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby_id_with_user\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct::Task id=1 user_id=1 title=\"foo\" user=#\u0026lt;ROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u0026gt;\u0026gt;\u003c/span\u003e\n\u003cspan class=\"n\"\u003etask\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e# =\u0026gt; #\u0026lt;ROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれでできました！\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"感想\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%84%9F%E6%83%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e感想\u003c/h1\u003e\n\n\u003cp\u003eROM(Ruby Object Mapper)の基本的な使い方を見てきました。ROMにはまだ説明していない機能がたくさんありますが、まだ著者も分からないことだらけです。できればもうちょっと調べて追記するなり新しく記事を書くなりしたいです。\u003c/p\u003e\n\n\u003cp\u003e英語でもいいからもっとドキュメントが増えてほしい！\u003c/p\u003e\n","body":"## ROM(Ruby Object Mapper)とは\n\n[ROM(Ruby Object Mapper)](http://rom-rb.org/)はActiveModelに代表されるようなRubyのORマッパーの1つです。\n\nEntityとRepositoryが分離されていることが特徴で、[Hanamiフレームワーク](http://hanamirb.org/)で採用されています。\n\nROMの基本的な使い方を説明していきたいと思います。\n\n## 準備\n### gem\n\n必要なgem構成は以下の通り(`pry`は任意)です。\n\n```rb:Gemfile\n# frozen_string_literal: true\nsource \"https://rubygems.org\"\n\nruby '2.4.2'\n\ngem 'rom-repository', '2.0.2'\ngem 'rom-sql', '2.3.0'\ngem 'sqlite3', '1.3.13'\n\ngroup :development do\n  gem 'pry'\nend\n```\n\n### テーブルの作成\n\n以下のようにすると`users`テーブルが作成できるのでこれを使っていきます。\n\n```rb:app.rb\nrequire 'rom-repository'\nrequire 'pry'\n\nrom = ROM.container(:sql, 'sqlite::memory') do |conf|\n  conf.default.create_table(:users) do\n    primary_key :id\n    column :name , String, null: false\n    column :email, String, null: false\n  end\n\n  class Users \u003c ROM::Relation[:sql]\n    schema(infer: true)\n  end\n\n  conf.register_relation(Users)\nend\n```\n\nよくわからないものがいきなりたくさん出てきてしましましが、今はこれでテーブルとRelationが作られる、と思ってください。\n\nRelationについては後ほど説明します。\n\n## 基本的なCreate/Update/Delete\n\n最初に`UserRepo`クラスを作成しています。これはDBに対する操作を定義するためのクラスです。DB操作メソッドは`ROM::Repository`を継承したクラスの中に定義します。\n\n```rb\nclass UserRepo \u003c ROM::Repository[:users]\n  commands :create, update: :by_pk, delete: :by_pk\nend\n```\n\n上記のコードでは`UserRepo`に対して基本的なCreate/Update/Deleteメソッドを定義しています。\n\nこれを使ってみましょう。\n\n### Create\n\n```rb\nuser = user_repo.create(name: \"Jane\", email: \"jane@doe.org\")\n# =\u003e #\u003cROM::Struct[User] id=1 name=\"Jane\" email=\"jane@doe.org\"\u003e\n\nuser.id   # =\u003e 1\nuser.name # =\u003e \"Jane\"\n```\n\n`UserRepo`のインスタンスに対して`#create`を投げることで、DBへレコードの保存とuserのインスタンスの作成が行われます。このように**「DB操作」と「レコードをマップしたインスタンス」が別のオブジェクトである**というのがActiveRecordなどと比較したときのROMの特徴ですので覚えておきましょう。\n\n### Update\n\nUpdateは下記のように行います。\n\n```rb\nupdated_user = user_repo.update(user.id, name: \"Jane Doe\")\n# =\u003e #\u003cROM::Struct[User] id=1 name=\"Jane Doe\" email=\"jane@doe.org\"\u003e\n```\n\nこのとき、ActiveRecordの感覚で以下のようにやってもだめです。\n\n```rb:NG\nuser.name = \"Jane Doe\"\n#=\u003e ROM::Struct::MissingAttribute: undefined method `name=' for #\u003cROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u003e\nuser.save\n```\n\nuserはイミュータブルなオブジェクトで、代入するメソッドなどは持っていないので要注意です。\n\n### Delate\n\nDeleteは以下のようになります。\n\n```rb\nuser_repo.delete(user.id)\n```\n\n## Read\n\nRead用のメソッド`query`と`by_id`を`UserRepo`に定義しましょう。\n\n```rb\nclass UserRepo \u003c ROM::Repository[:users]\n  commands :create\n\n  def query(conditions)\n    users.where(conditions).to_a\n  end\n\n  def by_id(id)\n    users.by_pk(id).one!\n  end\nend\n```\n\n幾つかの新しいキーワードが出てきました。1つずつ確認しましょう。\n\n- `#users` : Relation(後述)\n- `#where` : Relationを条件で絞り込み。Relationを返す。\n- `#by_pk` : Relationを主キーで絞り込み。Relationを返す。\n- `#to_a` : RelationをStructの配列に変換\n- `#one!` : RelationをStructに変換\n\n上の例では出てきませんでしたが`#one`(`!`なし)というのもあります。\n`#one`と`#one!`の違いは以下です。\n\n- `#one` : 結果が0件or1件ならStructに変換(0件の場合はnil), 複数件の場合はerror\n- `#one!` : 結果が1件ならStructに変換, 複数件or0件の場合はerror\n\n定義したメソッドは以下のように使います。\n\n```rb\nuser_repo = UserRepo.new(rom)\n\nuser = user_repo.create(name: \"Jane\", email: \"jane@doe.org\")\nuser = user_repo.create(name: \"Jane\", email: \"jane@example.com\")\n\nuser_repo.query(name: \"Jane\")\n# =\u003e [#\u003cROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u003e, #\u003cROM::Struct::User id=2 name=\"Jane\" email=\"jane@example.com\"\u003e]\n\nuser_repo.by_id(2)\n# =\u003e #\u003cROM::Struct::User id=2 name=\"Jane\" email=\"jane@example.com\"\u003e\n```\n\n### 結果を独自クラスにする\n\nさて、ここまでのReadメソッドでは戻り値がStructでした。これは独自クラスに変更することができます。\n\n```rb\nclass User\n  attr_reader :id, :name, :email\n\n  def initialize(attributes)\n    @id, @name, @email = attributes.values_at(:id, :name, :email)\n  end\nend\n\nclass UserRepo \u003c ROM::Repository[:users]\n  commands :create\n\n  def query(conditions)\n    users.where(conditions).map_to(User)\n  end\nend\n```\n\n`map_to(User)`というのがポイントで、これによって結果を`User`インスタンスにしてくれます。\n\n試して見ます。\n\n```rb\nuser_repo = UserRepo.new(rom)\n\nuser_repo.create(name: \"Jane\", email: \"jane@doe.org\")\n\nuser = user_repo.query(name: \"Jane\").first\n# =\u003e #\u003cUser @email=\"jane@doe.org\", @id=1, @name=\"Jane\"\u003e\nuser.class # =\u003e User\n```\n\nここで注目したいのは`User`クラスは何も継承もMixinもしていないPureなRubyであるということです。これによって`User`クラスを**従来のデザインパターンを使って、好きなだけ表現力豊かなモデルにすることができます**。\n\n## Relation\n\nさて、さんざん後回しにされていたRelationの説明です。\n\nRelationは低レベルなCRUDのためのAPIを提供するものです。\n\nRelationクラスはこのように定義します。\n\n```rb\nclass Users \u003c ROM::Relation[:sql]\n  schema do\n    attribute :id   , Types::Int\n    attribute :name , Types::String\n    attribute :email, Types::String\n\n    primary_key :id\n  end\nend\n```\n\n`schema`メソッドでテーブルのカラムと主キーを定義します。\n\n以下のように省略して書くこともできます。\n\n```rb\nclass Users \u003c ROM::Relation[:sql]\n  schema(infer: true)\nend\n```\n\n`schema(infer: true)`とすることでクラス名から推測して`users`テーブルの定義を参照してくれます。\n\nRelationにメソッドを書いてみましょう。Relationのメソッドは必ず戻り値もRelationでなければならないというルールがあります。\n\n```rb:app.rb\nrequire 'rom-repository'\nrequire 'pry'\n\nrom = ROM.container(:sql, 'sqlite::memory') do |conf|\n  conf.default.create_table(:users) do\n    primary_key :id\n    column :name , String, null: false\n    column :email, String, null: false\n  end\n\n  class Users \u003c ROM::Relation[:sql]\n    schema(infer: true)\n\n    def listing\n      select(:name).order(:name)\n    end\n  end\n\n  conf.register_relation(Users)\nend\n\nclass UserRepo \u003c ROM::Repository[:users]\n  commands :create\n\n  def listing\n    users.listing.to_a\n  end\nend\n```\n\n使ってみます。\n\n```rb\nuser_repo = UserRepo.new(rom)\n\nuser = user_repo.create(name: \"Jane\", email: \"jane@doe.org\")\nuser = user_repo.create(name: \"Bob\" , email: \"bob@example.com\")\n\nuser_repo.listing\n# =\u003e [#\u003cROM::Struct::User name=\"Bob\"\u003e, #\u003cROM::Struct::User name=\"Jane\"\u003e]\n```\n\n# Associations\n\nアソシエーションを使っていきましょう。ここからは以下のテーブルを使います。\n\n```rb\nrom = ROM.container(:sql, 'sqlite::memory') do |conf|\n  conf.default.create_table(:users) do\n    primary_key :id\n    column :name, String, null: false\n    column :email, String, null: false\n  end\n\n  conf.default.create_table(:tasks) do\n    primary_key :id\n    foreign_key :user_id, :users\n    column :title, String, null: false\n  end\n```\n\n`users`と`tasks`は1対多の関係になっています。この関係を定義しましょう。\n\n\n```rb\nrom = ROM.container(:sql, 'sqlite::memory') do |conf|\n  conf.default.create_table(:users) do\n    primary_key :id\n    column :name, String, null: false\n    column :email, String, null: false\n  end\n\n  conf.default.create_table(:tasks) do\n    primary_key :id\n    foreign_key :user_id, :users\n    column :title, String, null: false\n  end\n\n  conf.relation(:users) do\n    schema(infer: true) do\n      associations do\n        has_many :tasks\n      end\n    end\n  end\n\n  conf.relation(:tasks) do\n    schema(infer: true) do\n      associations do\n        belongs_to :user\n      end\n    end\n  end\nend\n```\n\n`conf.relation`でリレーションに対してアソシエーションを定義しています。\n\n使ってみましょう。\n\n```rb\nclass UserRepo \u003c ROM::Repository[:users]\n  commands :create\n\n  def by_id(id)\n    users.by_pk(id).one!\n  end\nend\n\nclass TaskRepo \u003c ROM::Repository[:tasks]\n  commands :create\n\n  def by_id(id)\n    tasks.by_pk(id).one!\n  end\nend\n\nuser_repo = UserRepo.new(rom)\ntask_repo = TaskRepo.new(rom)\n\nuser = user_repo.create(name: \"Jane\", email: \"jane@doe.org\")\ntask_repo.create(user_id: user.id, title: \"foo\")\ntask_repo.create(user_id: user.id, title: \"bar\")\n\nuser = user_repo.aggregate(:tasks).one\n# =\u003e #\u003cROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\" tasks=[#\u003cROM::Struct::Task id=1 user_id=1 title=\"foo\"\u003e, #\u003cROM::Struct::Task id=2 user_id=1 title=\"bar\"\u003e]\u003e\n\nuser.tasks\n# =\u003e [#\u003cROM::Struct::Task id=1 user_id=1 title=\"foo\"\u003e, #\u003cROM::Struct::Task id=2 user_id=1 title=\"bar\"\u003e]\n```\n\n`#aggregate`を使うことでリレーションを含んだ(`Combined`クラスの)インスタンスが生成されます。\n\n以下のように`#aggregate`を使わずに`user`から`tasks`を使おうとしても失敗します。\n\n```rb:NG\nuser = user_repo.by_id(1)\n# =\u003e #\u003cROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u003e\nuser.tasks\n# =\u003e ROM::Struct::MissingAttribute: undefined method `tasks' for #\u003cROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u003e (attribute not loaded?)\n\nfrom rom-sample/vendor/bundle/ruby/2.4.0/gems/rom-mapper-1.1.0/lib/rom/struct.rb:112:in `rescue in method_missing'\n```\n\n`tasks` から `user` を含める場合は以下のようになります。\n\n```rb\ntask_repo.aggregate(:user).first.user\n# =\u003e #\u003cROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u003e\n```\n\n単に、ある`task`に対して`user`を取得するには単純に以下のようにします。\n\n```rb\ntask = task_repo.by_id(1)\n# =\u003e #\u003cROM::Struct::Task id=1 user_id=1 title=\"foo\"\u003e\nuser_repo.by_id(task.user_id)\n# =\u003e #\u003cROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u003e\n```\n\nしかし、これはちょっと面倒くさいですね。やっぱり`task.user`の形でアクセスしたいです。\n\nこれを実現するためには以下のようなメソッドを用意します。\n\n```rb\nclass TaskRepo \u003c ROM::Repository[:tasks]\n  commands :create\n\n  def by_id(id)\n    tasks.by_pk(id).one!\n  end\n\n  def by_id_with_user(id)\n    tasks.by_pk(id).wrap(:user).one\n  end\nend\n\ntask = task_repo.by_id_with_user(1)\n# =\u003e #\u003cROM::Struct::Task id=1 user_id=1 title=\"foo\" user=#\u003cROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u003e\u003e\ntask.user\n# =\u003e #\u003cROM::Struct::User id=1 name=\"Jane\" email=\"jane@doe.org\"\u003e\n```\n\nこれでできました！\n\n# 感想\n\nROM(Ruby Object Mapper)の基本的な使い方を見てきました。ROMにはまだ説明していない機能がたくさんありますが、まだ著者も分からないことだらけです。できればもうちょっと調べて追記するなり新しく記事を書くなりしたいです。\n\n英語でもいいからもっとドキュメントが増えてほしい！\n","coediting":false,"comments_count":0,"created_at":"2017-12-13T18:18:13+09:00","group":null,"id":"f9e363ce146f71da044e","likes_count":12,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"ORM","versions":[]},{"name":"hanami","versions":[]},{"name":"ROM(RubyObjectMapper)","versions":[]}],"title":"ROM(Ruby Object Mapper)の基本的な使い方","updated_at":"2017-12-17T07:01:57+09:00","url":"https://qiita.com/isuke/items/f9e363ce146f71da044e","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eまずは、普通に[Shit+⌘+F]で検索します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F95ef6354-1bac-c3cc-c9fb-4596de579e32.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d92e9fd674ee2467d54d4affd5c439b2\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F95ef6354-1bac-c3cc-c9fb-4596de579e32.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=d92e9fd674ee2467d54d4affd5c439b2\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/95ef6354-1bac-c3cc-c9fb-4596de579e32.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F95ef6354-1bac-c3cc-c9fb-4596de579e32.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=e1a1d755c8292c4e81b669606ab91fde 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e次に[Option+⌘+I]でDeveloper Toolを開き、そこのConsoleで以下を実行します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003epack\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eatom\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epackages\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetActivePackage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003efind-and-replace\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eresults\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003epack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emainModule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresultsModel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresults\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ehoge\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eObject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresults\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"na\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efilePath\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003ematches\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ematches\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003ematch\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ematch\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elineText\u003c/span\u003e \u003cspan class=\"p\"\u003e})}\u003c/span\u003e \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ecopy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F5166674c-9859-8123-6578-39e1373e87fc.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=71bed8d83987d41f3934fb493ddaae65\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F5166674c-9859-8123-6578-39e1373e87fc.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=71bed8d83987d41f3934fb493ddaae65\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/5166674c-9859-8123-6578-39e1373e87fc.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2F5166674c-9859-8123-6578-39e1373e87fc.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=199fe21f7084c8cb2a791c396517538a 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eクリップボードに以下のようにコピーされます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"json\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"filePath\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"/Users/you/Projects/hoge/app/controllers/api/api_controller.rb\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"matches\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"class Api::ApiController \u0026lt; ApplicationController\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"filePath\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"/Users/you/Projects/hoge/app/controllers/api/bills_controller.rb\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"matches\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"class Api::BillsController \u0026lt; Api::ApiController\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"filePath\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"/Users/you/Projects/hoge/app/controllers/api/clients_controller.rb\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"matches\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"w\"\u003e\n      \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"class Api::ClientsController \u0026lt; Api::ApiController\"\u003c/span\u003e\u003cspan class=\"w\"\u003e\n    \u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"err\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e以上です。\u003c/p\u003e\n","body":"まずは、普通に[Shit+⌘+F]で検索します。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/152997/95ef6354-1bac-c3cc-c9fb-4596de579e32.png)\n\n次に[Option+⌘+I]でDeveloper Toolを開き、そこのConsoleで以下を実行します。\n\n```js\npack = atom.packages.getActivePackage('find-and-replace');\nresults = pack.mainModule.resultsModel.results;\nhoge = Object.values(results).map((result) =\u003e { return {filePath: result.filePath, matches: result.matches.map((match) =\u003e { return match.lineText })} });\ncopy(hoge);\n```\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/152997/5166674c-9859-8123-6578-39e1373e87fc.png)\n\nクリップボードに以下のようにコピーされます。\n\n```json\n[\n  {\n    \"filePath\": \"/Users/you/Projects/hoge/app/controllers/api/api_controller.rb\",\n    \"matches\": [\n      \"class Api::ApiController \u003c ApplicationController\"\n    ]\n  },\n  {\n    \"filePath\": \"/Users/you/Projects/hoge/app/controllers/api/bills_controller.rb\",\n    \"matches\": [\n      \"class Api::BillsController \u003c Api::ApiController\"\n    ]\n  },\n  {\n    \"filePath\": \"/Users/you/Projects/hoge/app/controllers/api/clients_controller.rb\",\n    \"matches\": [\n      \"class Api::ClientsController \u003c Api::ApiController\"\n    ]\n  },\n  ...\n]\n```\n\n以上です。\n","coediting":false,"comments_count":0,"created_at":"2017-12-12T00:20:02+09:00","group":null,"id":"fe24b94c31ff4ee7b394","likes_count":16,"private":false,"reactions_count":0,"tags":[{"name":"tips","versions":[]},{"name":"ATOM","versions":[]},{"name":"editor","versions":[]}],"title":"Atomでプロジェクト検索結果をクリップボードにコピーする方法","updated_at":"2017-12-14T09:28:50+09:00","url":"https://qiita.com/isuke/items/fe24b94c31ff4ee7b394","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ca href=\"https://guides.hanamirb.org/architecture/interactors/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式\u003c/a\u003eの意訳に適当に加筆(減筆?)/修正したものです。(ちなみに著者の英語の偏差値は30台です。)\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"2019-12-28-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2019-12-28-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2019-12-28 追記\u003c/h1\u003e\n\n\u003cp\u003e以下はHanamiのバージョンが1.1の頃のものです。\u003cbr\u003e\n\u003ca href=\"http://hanamirb.org/guides/1.1/architecture/interactors/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eURL\u003c/a\u003eも404になってしまいました。\u003cbr\u003e\nURLだけは最新のものに書き換えました(Thanks \u003ca href=\"/topstone\" class=\"user-mention js-hovercard\" title=\"topstone\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"topstone\"\u003e@topstone\u003c/a\u003e)が内容は古くなっている可能性があります。\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"インタラクタとは\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%A9%E3%82%AF%E3%82%BF%E3%81%A8%E3%81%AF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eインタラクタとは\u003c/h1\u003e\n\n\u003cp\u003eHanamiにはコードを整理するためのオプションのツールを提供しています。それはインタラクタといい、サービスやユースケース、オペレーションなどとも呼ばれます。\u003c/p\u003e\n\n\u003cp\u003e以下、\u003ca href=\"https://guides.hanamirb.org/introduction/getting-started/\" rel=\"nofollow noopener\" target=\"_blank\"\u003e事例\u003c/a\u003eを通して使い方を見ていきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"新しい要求-メール通知-a-new-feature-email-notifications\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%B0%E3%81%97%E3%81%84%E8%A6%81%E6%B1%82-%E3%83%A1%E3%83%BC%E3%83%AB%E9%80%9A%E7%9F%A5-a-new-feature-email-notifications\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e新しい要求: メール通知 (A New Feature: Email Notifications)\u003c/h2\u003e\n\n\u003cp\u003eこんな要求があったとします。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e管理者は本が追加されたときにメール通知を受け取りたい。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eアプリケーションには認証がないため、だれでも本を追加できます。管理者のメールアドレスは環境変数で与えます。\u003c/p\u003e\n\n\u003cp\u003eこれはインタラクタ、具体的には\u003ccode\u003eHanami::Interactor\u003c/code\u003eを使ういい例です。\u003c/p\u003e\n\n\u003cp\u003eこの例は以下のような別の要求の基礎を提供することができます。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e新しい書籍が投稿される前に管理者の承認を得る\u003c/li\u003e\n\u003cli\u003eユーザーは電子メールアドレスを入力し、特別なリンクを使用して本を編集することができる。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eこのプラクティスでは基本的な幾つかの実装のためにインタラクタを使うことができます。これは、コードベースの複雑さを管理するために、一度にいくつかのことをしたいときに特に便利です。\u003c/p\u003e\n\n\u003cp\u003eインタラクタは些細ではない(non-trivial)ビジネスロジックを分離するために使用されます。これは単一責任の原則に沿っています。\u003c/p\u003e\n\n\u003cp\u003eWebアプリケーションでは、インタラクタは一般的にコントローラのアクションから呼び出されます。これにより、関心事を分けることができます。 あなたのビジネスロジックオブジェクト、インタラクタはWebについて全く知らないでしょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コールバック-いやいやクッサいコールバックなんていりません-callbacks-we-dont-need-no-stinkin-callbacks\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF-%E3%81%84%E3%82%84%E3%81%84%E3%82%84%E3%82%AF%E3%83%83%E3%82%B5%E3%81%84%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E3%81%AA%E3%82%93%E3%81%A6%E3%81%84%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93-callbacks-we-dont-need-no-stinkin-callbacks\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコールバック? いやいや、クッサいコールバックなんていりません！ (Callbacks? We Don't Need No Stinkin' Callbacks!)\u003c/h2\u003e\n\n\u003cp\u003e\u003cdetails\u003e\u003csummary\u003e簡単な実装方法はcallbackを追加することです。つまり、データベースに新しい本が追加されたあとにメールが送信されます。\u003c/summary\u003e\u003cbr\u003e\n\u003cdiv\u003e[訳註] Railsでいうとこんな感じ?\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ebook.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"n\"\u003ebook\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eApplicationRecord\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eafter_create\u003c/span\u003e \u003cspan class=\"ss\"\u003e:send_mail_to_admin\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/details\u003e\u003c/p\u003e\n\n\u003cp\u003eこのような仕組みをHanamiは提供していません。これは永続コールバック\u003csup id=\"fnref1\"\u003e\u003ca href=\"#fn1\" rel=\"footnote\" title=\"[訳註] 多分、永続(= DBへの保存)に対するコールバックのこと\"\u003e1\u003c/a\u003e\u003c/sup\u003eが\u003cstrong\u003eアンチパターン\u003c/strong\u003eだと考えられるからです。永続コールバックは単一責任の原則に反します。この場合、永続性とメール通知(の責任)が不適切に混在しています。\u003c/p\u003e\n\n\u003cp\u003e上記のような実装をした場合、テストやその他の点でこのコールバックをスキップしたくなるでしょう。また、このような実装は同じイベント(今回の場合はDBへの保存)に対する複数のコールバックが特定の順序でトリガーされるため、すぐ混乱をおこします。\u003c/p\u003e\n\n\u003cp\u003e代わりに、\u003cstrong\u003e暗黙を明示に(explicit over implicit)\u003c/strong\u003eしましょう。\u003c/p\u003e\n\n\u003cp\u003eインタラクタは特定のユースケースを表すオブジェクトです。\u003c/p\u003e\n\n\u003cp\u003eインタラクタは各クラスに単一の責任を持たせます。インタラクタの単一責任は特定の結果を達成するためにオブジェクトとメソッドコールを順番に結合します。\u003csup id=\"fnref2\"\u003e\u003ca href=\"#fn2\" rel=\"footnote\" title=\"[訳註] 訳があやしい。　原文-\u0026gt;[An Interactor's single responsibility is to combine object and method calls in order to achieve a specific outcome.]\"\u003e2\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\n\u003cp\u003eそのために\u003ccode\u003eHanami::Interactor\u003c/code\u003eモジュールが提供されています。そのため、ピュアRuby(Plain Old Ruby)オブジェクトとして始めて、必要に応じて\u003ccode\u003eHanami::Interactor\u003c/code\u003eをインクルードすることができます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コンセプト-concept\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%82%BB%E3%83%97%E3%83%88-concept\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコンセプト (Concept)\u003c/h2\u003e\n\n\u003cp\u003eインタラクタの背後にあるアイデアは機能の一部を新しいクラスに分離することです。\u003c/p\u003e\n\n\u003cp\u003e振舞いを単一のオブジェクトにカプセル化することでテストが簡単になります。これは複雑さを隠して、明示しないよりもコードを理解するのを容易にします。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"準備-preparing\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%BA%96%E5%82%99-preparing\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e準備 (Preparing)\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"http://hanamirb.org/guides/getting-started\" rel=\"nofollow noopener\" target=\"_blank\"\u003ebookshelf application\u003c/a\u003eにメール通知の要求を実装していきましょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"インタラクタを作ろう-creating-our-interactor\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%A9%E3%82%AF%E3%82%BF%E3%82%92%E4%BD%9C%E3%82%8D%E3%81%86-creating-our-interactor\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eインタラクタを作ろう (Creating Our Interactor)\u003c/h2\u003e\n\n\u003cp\u003eインタラクタを作ってみましょう。まず、以下のディレクトリを作ってください。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"go\"\u003e% mkdir lib/bookshelf/interactors\n% mkdir spec/bookshelf/interactors\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eなぜこれらを\u003ccode\u003elib\u003c/code\u003eに入れるのでしょう?それはwebアプリケーションから切り離されているからです。\u003csup id=\"fnref3\"\u003e\u003ca href=\"#fn3\" rel=\"footnote\" title=\"[訳註] Hanamiではwebに関するコード(Controller, View, Routesなど)をapps/webにいれて、webに依存しないビジネスロジックに関するコード(Entity, Repositoryなど)をlibに入れます。\"\u003e3\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\n\u003cp\u003e新しいスペック\u003ccode\u003espec/bookshelf/interactors/add_book_spec.rb\u003c/code\u003eを書いて、\u003ccode\u003eAddBook\u003c/code\u003eインタラクタを呼びましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003espec/bookshelf/interactors/add_book_spec.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'spec_helper'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:interactor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"succeeds\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003einteractor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ebe_a_success\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e次に\u003ccode\u003eAddBook\u003c/code\u003eクラスを作りましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/bookshelf/interactors/add_book.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'hanami/interactor'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAddBook\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eInteractor\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# set up the object\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebook_attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# get it done\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこのクラスには２つのメソッドしかありません。\u003cbr\u003e\n- \u003ccode\u003einitialize\u003c/code\u003e: データのセットアップ\u003cbr\u003e\n- \u003ccode\u003ecall\u003c/code\u003e: ユースケースを満たす\u003c/p\u003e\n\n\u003cp\u003eテストを実行してみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"go\"\u003e% bundle exec rake\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eすべてのテストがパスするでしょう！\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"本の作成-creating-a-book\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%9C%AC%E3%81%AE%E4%BD%9C%E6%88%90-creating-a-book\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e本の作成 (Creating a Book)\u003c/h2\u003e\n\n\u003cp\u003e\u003ccode\u003espec/bookshelf/interactors/add_book_spec.rb\u003c/code\u003eを編集します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003espec/bookshelf/interactors/add_book_spec.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'spec_helper'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:interactor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eHash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003eauthor: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"James Baldwin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003etitle: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"The Fire Next Time\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"good input\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:result\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003einteractor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"succeeds\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ebe_a_success\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"creates a Book with correct title and author\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"The Fire Next Time\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"James Baldwin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e次に、インタラクタを実装していきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/bookshelf/interactors/add_book.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'hanami/interactor'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAddBook\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eInteractor\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexpose\u003c/span\u003e \u003cspan class=\"ss\"\u003e:book\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# set up the object\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebook_attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@book\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebook_attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eここでは次の２つの重要なことが書かれています。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003eexpose :book\u003c/code\u003eではメソッドの実行結果として返される\u003ccode\u003e@book\u003c/code\u003eを公開します。\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ecall\u003c/code\u003eメソッドは新しいBookエンティティを\u003ccode\u003e@book\u003c/code\u003eに割り当てて、公開します。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eこれでテストはパスするでしょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"作成した本の永続化-persisting-the-book\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E6%9C%AC%E3%81%AE%E6%B0%B8%E7%B6%9A%E5%8C%96-persisting-the-book\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e作成した本の永続化 (Persisting the Book)\u003c/h2\u003e\n\n\u003cp\u003eさきほど新しい本をビルドしましたが、まだデータベースには存在していません。\u003c/p\u003e\n\n\u003cp\u003e永続化のために\u003ccode\u003eBookRepository\u003c/code\u003eが必要です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003espec/bookshelf/interactors/add_book_spec.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'spec_helper'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:interactor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eHash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003eauthor: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"James Baldwin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003etitle: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"The Fire Next Time\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"good input\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:result\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003einteractor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"succeeds\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ebe_a_success\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"creates a Book with correct title and author\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"The Fire Next Time\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"James Baldwin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"persists the Book\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_not\u003c/span\u003e \u003cspan class=\"n\"\u003ebe_nil\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこのテストをパスさせるためにインタラクタの\u003ccode\u003ecall\u003c/code\u003eメソッドを編集しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/bookshelf/interactors/add_book.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@book\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eBookRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebook_attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eBook.new\u003c/code\u003eの代わりに\u003ccode\u003eBookRepository\u003c/code\u003eと\u003ccode\u003ecreate\u003c/code\u003eを使いました。相変わらず\u003ccode\u003eBook\u003c/code\u003eは返却されますが、レコードはデータベースに保存されます。\u003c/p\u003e\n\n\u003cp\u003eテストを実行すればパスするでしょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"依存性の注入-dependency-injection\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BE%9D%E5%AD%98%E6%80%A7%E3%81%AE%E6%B3%A8%E5%85%A5-dependency-injection\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e依存性の注入 (Dependency Injection)\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"https://martinfowler.com/articles/injection.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e依存性の注入\u003c/a\u003eを活用してリファクタリングしましょう。\u003c/p\u003e\n\n\u003cp\u003e依存性の注入はおすすめですが、必須ではありません。Hanamiのインタラクタ同様にオプションです。\u003c/p\u003e\n\n\u003cp\u003e先程のスペックは役割を果たしますが、リポジトリの振る舞いに依存しています(\u003ccode\u003eid\u003c/code\u003eメソッドは永続化に成功して初めて定義されます)。それはリポジトリがどのように動作するかという実装の詳細です。例えば、もし永続化の\u003cstrong\u003e前に\u003c/strong\u003eUUIDを作成し、\u003ccode\u003eid\u003c/code\u003eカラムに値を入れるのではなく、他の方法で保存が成功したことを表す場合、スペックを変更する必要があります。\u003c/p\u003e\n\n\u003cp\u003eスペックとインタラクタをより強固にすることができ、このファイル外の変更で壊れる可能性が低くなります。\u003c/p\u003e\n\n\u003cp\u003eインタラクタで依存性の注入を使用するには以下のようにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/bookshelf/interactors/add_book.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'hanami/interactor'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAddBook\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eInteractor\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexpose\u003c/span\u003e \u003cspan class=\"ss\"\u003e:book\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003erepository: \u003c/span\u003e\u003cspan class=\"no\"\u003eBookRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@repository\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erepository\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebook_attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@book\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"vi\"\u003e@repository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebook_attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e@repository\u003c/code\u003eを使う以外は基本的に一緒です。\u003c/p\u003e\n\n\u003cp\u003e今のところのスペックは\u003ccode\u003eid\u003c/code\u003eが作成されたことをチェックしてリポジトリの動作をテストしています(\u003ccode\u003eexpect(result.book.id).to_not be_nil\u003c/code\u003e)。\u003c/p\u003e\n\n\u003cp\u003eこれは実装の詳細です。\u003c/p\u003e\n\n\u003cp\u003e代わりに、スペックを単に「リポジトリが\u003ccode\u003ecreate\u003c/code\u003eメッセージを受け取ることを確認する」ように変更することができます。それはリポジトリが保存をちゃんと行ってくれることを信頼することです(そして、保存をちゃんと行うのはリポジトリの責任です)。\u003c/p\u003e\n\n\u003cp\u003eスペックから\u003ccode\u003eit \"persists the Book\"\u003c/code\u003eを取り除きましょう。代わりに\u003ccode\u003edescribe \"persistence\"\u003c/code\u003eを作成します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003espec/bookshelf/interactors/add_book_spec.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'spec_helper'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:interactor\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:attributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eHash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003eauthor: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"James Baldwin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003etitle: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"The Fire Next Time\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"good input\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:result\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003einteractor\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"succeeds\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ebe_a_success\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"creates a Book with correct title and author\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"The Fire Next Time\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"James Baldwin\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"persistence\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:repository\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003einstance_double\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"BookRepository\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"persists the Book\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erepository\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ereceive\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:create\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003erepository: \u003c/span\u003e\u003cspan class=\"n\"\u003erepository\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれで、関心事の仕切り(the boundaries of the concern)に違反しなくなりました。\u003c/p\u003e\n\n\u003cp\u003eここで行ったのはインタラクタのリポジトリの依存性の\u003cstrong\u003e注入\u003c/strong\u003eです。\u003cbr\u003e\n\u003cdetails\u003e\u003csummary\u003eノート: テストしていないコード(non-test code)は何も変更する必要がありません。\u003ccode\u003erepository:\u003c/code\u003eキーワード引数は指定しなかった場合は新しいリポジトリオブジェクトを提供します。\u003c/summary\u003e\u003cbr\u003e\n\u003cdiv\u003e[訳註] ここまでの説明ではコードが出てきていませんが、リポジトリはコントローラなどから以下のようにして使います。\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/controllers/book/create.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003eWeb::Controllers::Book\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"n\"\u003ecraete\u003c/span\u003e\n    \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eWeb\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:book\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eAddBook.new\u003c/code\u003eの引数を与えなかった場合、\u003ccode\u003eAddBook\u003c/code\u003eの\u003ccode\u003e@repositoty\u003c/code\u003eは\u003ccode\u003eBookRepository.new\u003c/code\u003eになります。そのため、依存性の注入を行う前と後でこのコードを変更する必要がない、ということをいっています。\u003cbr\u003e\n\u003c/p\u003e\n\u003c/div\u003e\u003c/details\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"メール通知-email-notification\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%BC%E3%83%AB%E9%80%9A%E7%9F%A5-email-notification\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメール通知 (Email notification)\u003c/h2\u003e\n\n\u003cp\u003eいよいよメール通知を追加しましょう!\u003c/p\u003e\n\n\u003cp\u003eここで別のライブラリを使うこともできますが、\u003ccode\u003eHanami::Mailer\u003c/code\u003eを使うことにしましょう。\u003csup id=\"fnref4\"\u003e\u003ca href=\"#fn4\" rel=\"footnote\" title=\"[訳注] なぜmailersがapps以下ではなくlib以下にあるのか疑問に思った人もいるかもしれません。安心してください。2.0で変更の可能性があります。\"\u003e4\u003c/a\u003e\u003c/sup\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"go\"\u003e% bundle exec hanami generate mailer book_added_notification\n      create  lib/bookshelf/mailers/book_added_notification.rb\n      create  spec/bookshelf/mailers/book_added_notification_spec.rb\n      create  lib/bookshelf/mailers/templates/book_added_notification.txt.erb\n      create  lib/bookshelf/mailers/templates/book_added_notification.html.erb\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"http://hanamirb.org/guides/mailers/overview\" rel=\"nofollow noopener\" target=\"_blank\"\u003eメーラーがどのように動作するか\u003c/a\u003eの詳細には立ち入りませんが、\u003ccode\u003eHanami::Mailer\u003c/code\u003eクラス、関連スペック、２つのテンプレート(プレーンテキストとHTML)があるシンプルな構成です。\u003c/p\u003e\n\n\u003cp\u003eテンプレートは空にしておきます。メールは\u003ccode\u003e'Book added!'\u003c/code\u003eという件名の空メールになります。\u003c/p\u003e\n\n\u003cp\u003eメーラースペックを編集します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003espec/bookshelf/mailers/book_added_notification_spec.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eRSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eMailers\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBookAddedNotification\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003etype: :mailer\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003esubject\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eMailers\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBookAddedNotification\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eMailer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edeliveries\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eclear\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'has correct `from` email address'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efrom\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"no-reply@example.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'has correct `to` email address'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"admin@example.com\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'has correct `subject`'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esubject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esubject\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Book added!\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'delivers mail'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"n\"\u003esubject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edeliver\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003echange\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eMailer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edeliveries\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elength\u003c/span\u003e \u003cspan class=\"p\"\u003e}.\u003c/span\u003e\u003cspan class=\"nf\"\u003eby\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eメーラーも編集します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/bookshelf/mailers/book_added_notification.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMailers::BookAddedNotification\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eMailer\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003efrom\u003c/span\u003e    \u003cspan class=\"s1\"\u003e'no-reply@example.com'\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eto\u003c/span\u003e      \u003cspan class=\"s1\"\u003e'admin@example.com'\u003c/span\u003e\n  \u003cspan class=\"n\"\u003esubject\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Book added!'\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれでテストはパスするでしょう!\u003c/p\u003e\n\n\u003cp\u003eしかし、このメーラはどこからも呼ばれてません。\u003ccode\u003eAddBook\u003c/code\u003eインタラクタから呼び出す必要があります。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eAddBook\u003c/code\u003eのスペックをメーラーが呼ばれていることを確認するように編集しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003espec/bookshelf/interactors/add_book_spec.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  \u003cspan class=\"o\"\u003e...\u003c/span\u003e\n  \u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"sending email\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:mailer\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003einstance_double\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Mailers::BookAddedNotification\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"send :deliver to the mailer\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emailer\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ereceive\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:deliver\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eAddBook\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003emailer: \u003c/span\u003e\u003cspan class=\"n\"\u003emailer\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eattributes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"o\"\u003e...\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eインタラクタに\u003ccode\u003emailer\u003c/code\u003eキーワード引数を追加して、メーラーを統合しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/bookshelf/interactors/add_book.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'hanami/interactor'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAddBook\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eInteractor\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexpose\u003c/span\u003e \u003cspan class=\"ss\"\u003e:book\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003erepository: \u003c/span\u003e\u003cspan class=\"no\"\u003eBookRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003emailer: \u003c/span\u003e\u003cspan class=\"no\"\u003eMailers\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBookAddedNotification\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@repository\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erepository\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@mailer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emailer\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e:,\u003c/span\u003e \u003cspan class=\"n\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e:)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@book\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"vi\"\u003e@repository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"ss\"\u003etitle: \u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eauthor: \u003c/span\u003e\u003cspan class=\"n\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@mailer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edeliver\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれでインタラクタは本が追加されたときにメールを送信します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"インタラクタの部品-interactor-parts\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%A9%E3%82%AF%E3%82%BF%E3%81%AE%E9%83%A8%E5%93%81-interactor-parts\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eインタラクタの部品 (Interactor parts)\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"インタフェース-interface\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9-interface\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eインタフェース (Interface)\u003c/h3\u003e\n\n\u003cp\u003eもうひとつ実装できる(オプションの)メソッドがあります。それは\u003ccode\u003evalid?\u003c/code\u003eというプライベートメソッドです。\u003c/p\u003e\n\n\u003cp\u003eデフォルトでは\u003ccode\u003evalid?\u003c/code\u003eは\u003ccode\u003etrue\u003c/code\u003eを返します。もし\u003ccode\u003evalid?\u003c/code\u003eを実装して\u003ccode\u003efalse\u003c/code\u003eを返すようにすれば\u003ccode\u003ecall\u003c/code\u003eは決して実行されません。\u003c/p\u003e\n\n\u003cp\u003e\u003cdetails\u003e\u003csummary\u003eこれについての\u003ca href=\"http://www.rubydoc.info/gems/hanami-utils/Hanami/Interactor/Interface\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAPIドキュメント\u003c/a\u003eを読むことができます。\u003c/summary\u003e\u003cbr\u003e\n\u003cdiv\u003e[訳註] サンプルを書いてみました。\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/bookshelf/interactors/add_book.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'hanami/interactor'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAddBook\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eValidation\u003c/span\u003e\n    \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eValidations\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003evalidations\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003erequired\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:title\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003efilled?\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003estr?\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"n\"\u003erequired\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:author\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003efilled?\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003estr?\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003esize?\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"o\"\u003e..\u003c/span\u003e\u003cspan class=\"mi\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eInteractor\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexpose\u003c/span\u003e \u003cspan class=\"ss\"\u003e:book\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003erepository: \u003c/span\u003e\u003cspan class=\"no\"\u003eBookRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003emailer: \u003c/span\u003e\u003cspan class=\"no\"\u003eMailers\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBookAddedNotification\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@repository\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003erepository\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@mailer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003emailer\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e:,\u003c/span\u003e \u003cspan class=\"n\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e:)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@book\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"vi\"\u003e@repository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\u003cspan class=\"ss\"\u003etitle: \u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eauthor: \u003c/span\u003e\u003cspan class=\"n\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@mailer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edeliver\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"kp\"\u003eprivate\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003evalid?\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e:,\u003c/span\u003e \u003cspan class=\"n\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e:)\u003c/span\u003e\n    \u003cspan class=\"no\"\u003eValidation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003etitle: \u003c/span\u003e\u003cspan class=\"n\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eauthor: \u003c/span\u003e\u003cspan class=\"n\"\u003eauthor\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003evalidate\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esuccess?\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003c/p\u003e\n\u003c/div\u003e\u003c/details\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"結果オブジェクト-result\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%B5%90%E6%9E%9C%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88-result\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e結果オブジェクト (Result)\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eHanami::Interactor#call\u003c/code\u003eの戻り値は\u003ccode\u003eHanami::Interactor::Result\u003c/code\u003eのオブジェクトです。\u003c/p\u003e\n\n\u003cp\u003eこれは公開するインタンス変数に関わらずアクセサメソッドが定義されています。\u003c/p\u003e\n\n\u003cp\u003eまた、エラーの追跡機能も持っています。\u003c/p\u003e\n\n\u003cp\u003eインタラクタでは、メッセージを伴って\u003ccode\u003eerror\u003c/code\u003eを呼び出し、エラーを追加できます。これにより自動的に結果オブジェクトが失敗します。\u003c/p\u003e\n\n\u003cp\u003e(\u003ccode\u003eerror!\u003c/code\u003eメソッドというのもあります。それは\u003ccode\u003eerror\u003c/code\u003eと同じことをし、\u003cstrong\u003eかつ\u003c/strong\u003e、流れをとめ、インタラクタがより多くのコードを実行するのを止めます。)\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e.errors\u003c/code\u003eを呼びですことで、結果オブジェクトのエラーにアクセスできます。\u003c/p\u003e\n\n\u003cp\u003e結果オブジェクトについての詳細は\u003ca href=\"http://www.rubydoc.info/gems/hanami-utils/Hanami/Interactor/Result\" rel=\"nofollow noopener\" target=\"_blank\"\u003eAPIドキュメント\u003c/a\u003eを参照してください。\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"訳者によるまとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A8%B3%E8%80%85%E3%81%AB%E3%82%88%E3%82%8B%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e訳者によるまとめ\u003c/h1\u003e\n\n\u003cp\u003eコールバックはクッサい。\u003c/p\u003e\n\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr\u003e\n\u003col\u003e\n\n\u003cli id=\"fn1\"\u003e\n\u003cp\u003e[訳註] 多分、永続(= DBへの保存)に対するコールバックのこと \u003ca href=\"#fnref1\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn2\"\u003e\n\u003cp\u003e[訳註] 訳があやしい。　原文-\u0026gt;[An Interactor's single responsibility is to combine object and method calls in order to achieve a specific outcome.] \u003ca href=\"#fnref2\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn3\"\u003e\n\u003cp\u003e[訳註] Hanamiではwebに関するコード(Controller, View, Routesなど)を\u003ccode\u003eapps/web\u003c/code\u003eにいれて、webに依存しないビジネスロジックに関するコード(Entity, Repositoryなど)を\u003ccode\u003elib\u003c/code\u003eに入れます。 \u003ca href=\"#fnref3\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003cli id=\"fn4\"\u003e\n\u003cp\u003e[訳注] なぜ\u003ccode\u003emailers\u003c/code\u003eが\u003ccode\u003eapps\u003c/code\u003e以下ではなく\u003ccode\u003elib\u003c/code\u003e以下にあるのか疑問に思った人もいるかもしれません。安心してください。\u003ca href=\"https://discourse.hanamirb.org/t/hanami-2-0-ideas/306/10\" rel=\"nofollow noopener\" target=\"_blank\"\u003e2.0で変更の可能性があります\u003c/a\u003e。 \u003ca href=\"#fnref4\"\u003e↩\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\n\u003c/ol\u003e\n\u003c/div\u003e\n","body":"[公式](https://guides.hanamirb.org/architecture/interactors/)の意訳に適当に加筆(減筆?)/修正したものです。(ちなみに著者の英語の偏差値は30台です。)\n\n# 2019-12-28 追記\n\n以下はHanamiのバージョンが1.1の頃のものです。\n[URL](http://hanamirb.org/guides/1.1/architecture/interactors/)も404になってしまいました。\nURLだけは最新のものに書き換えました(Thanks @topstone)が内容は古くなっている可能性があります。\n\n---\n\n# インタラクタとは\n\nHanamiにはコードを整理するためのオプションのツールを提供しています。それはインタラクタといい、サービスやユースケース、オペレーションなどとも呼ばれます。\n\n以下、[事例](https://guides.hanamirb.org/introduction/getting-started/)を通して使い方を見ていきます。\n\n## 新しい要求: メール通知 (A New Feature: Email Notifications)\n\nこんな要求があったとします。\n\n\u003e 管理者は本が追加されたときにメール通知を受け取りたい。\n\nアプリケーションには認証がないため、だれでも本を追加できます。管理者のメールアドレスは環境変数で与えます。\n\nこれはインタラクタ、具体的には`Hanami::Interactor`を使ういい例です。\n\nこの例は以下のような別の要求の基礎を提供することができます。\n\n- 新しい書籍が投稿される前に管理者の承認を得る\n- ユーザーは電子メールアドレスを入力し、特別なリンクを使用して本を編集することができる。\n\nこのプラクティスでは基本的な幾つかの実装のためにインタラクタを使うことができます。これは、コードベースの複雑さを管理するために、一度にいくつかのことをしたいときに特に便利です。\n\nインタラクタは些細ではない(non-trivial)ビジネスロジックを分離するために使用されます。これは単一責任の原則に沿っています。\n\nWebアプリケーションでは、インタラクタは一般的にコントローラのアクションから呼び出されます。これにより、関心事を分けることができます。 あなたのビジネスロジックオブジェクト、インタラクタはWebについて全く知らないでしょう。\n\n## コールバック? いやいや、クッサいコールバックなんていりません！ (Callbacks? We Don't Need No Stinkin' Callbacks!)\n\n\u003cdetails\u003e\u003csummary\u003e簡単な実装方法はcallbackを追加することです。つまり、データベースに新しい本が追加されたあとにメールが送信されます。\u003c/summary\u003e\n\u003cdiv\u003e[訳註] Railsでいうとこんな感じ?\n\n```rb:book.rb\nclass book \u003c ApplicationRecord\n  after_create :send_mail_to_admin\nend\n```\n\u003c/div\u003e\u003c/details\u003e\n\nこのような仕組みをHanamiは提供していません。これは永続コールバック[^consider persistence]が**アンチパターン**だと考えられるからです。永続コールバックは単一責任の原則に反します。この場合、永続性とメール通知(の責任)が不適切に混在しています。\n\n[^consider persistence]: [訳註] 多分、永続(= DBへの保存)に対するコールバックのこと\n\n上記のような実装をした場合、テストやその他の点でこのコールバックをスキップしたくなるでしょう。また、このような実装は同じイベント(今回の場合はDBへの保存)に対する複数のコールバックが特定の順序でトリガーされるため、すぐ混乱をおこします。\n\n代わりに、**暗黙を明示に(explicit over implicit)**しましょう。\n\nインタラクタは特定のユースケースを表すオブジェクトです。\n\nインタラクタは各クラスに単一の責任を持たせます。インタラクタの単一責任は特定の結果を達成するためにオブジェクトとメソッドコールを順番に結合します。[^bow1]\n\n[^bow1]: [訳註] 訳があやしい。　原文-\u003e[An Interactor's single responsibility is to combine object and method calls in order to achieve a specific outcome.]\n\nそのために`Hanami::Interactor`モジュールが提供されています。そのため、ピュアRuby(Plain Old Ruby)オブジェクトとして始めて、必要に応じて`Hanami::Interactor`をインクルードすることができます。\n\n## コンセプト (Concept)\n\nインタラクタの背後にあるアイデアは機能の一部を新しいクラスに分離することです。\n\n振舞いを単一のオブジェクトにカプセル化することでテストが簡単になります。これは複雑さを隠して、明示しないよりもコードを理解するのを容易にします。\n\n## 準備 (Preparing)\n\n[bookshelf application](http://hanamirb.org/guides/getting-started)にメール通知の要求を実装していきましょう。\n\n## インタラクタを作ろう (Creating Our Interactor)\n\nインタラクタを作ってみましょう。まず、以下のディレクトリを作ってください。\n\n```shell-session\n% mkdir lib/bookshelf/interactors\n% mkdir spec/bookshelf/interactors\n```\n\nなぜこれらを`lib`に入れるのでしょう?それはwebアプリケーションから切り離されているからです。[^lib]\n\n[^lib]: [訳註] Hanamiではwebに関するコード(Controller, View, Routesなど)を`apps/web`にいれて、webに依存しないビジネスロジックに関するコード(Entity, Repositoryなど)を`lib`に入れます。\n\n新しいスペック`spec/bookshelf/interactors/add_book_spec.rb`を書いて、`AddBook`インタラクタを呼びましょう。\n\n```rb:spec/bookshelf/interactors/add_book_spec.rb\nrequire 'spec_helper'\n\ndescribe AddBook do\n  let(:interactor) { AddBook.new }\n\n  it \"succeeds\" do\n    expect(interactor.call).to be_a_success\n  end\nend\n```\n\n次に`AddBook`クラスを作りましょう。\n\n```rb:lib/bookshelf/interactors/add_book.rb\nrequire 'hanami/interactor'\n\nclass AddBook\n  include Hanami::Interactor\n\n  def initialize\n    # set up the object\n  end\n\n  def call(book_attributes)\n    # get it done\n  end\nend\n```\n\nこのクラスには２つのメソッドしかありません。\n- `initialize`: データのセットアップ\n- `call`: ユースケースを満たす\n\nテストを実行してみましょう。\n\n```shell-session\n% bundle exec rake\n```\n\nすべてのテストがパスするでしょう！\n\n## 本の作成 (Creating a Book)\n\n`spec/bookshelf/interactors/add_book_spec.rb`を編集します。\n\n```rb:spec/bookshelf/interactors/add_book_spec.rb\nrequire 'spec_helper'\n\ndescribe AddBook do\n  let(:interactor) { AddBook.new }\n  let(:attributes) { Hash[author: \"James Baldwin\", title: \"The Fire Next Time\"] }\n\n  describe \"good input\" do\n    let(:result) { interactor.call(attributes) }\n\n    it \"succeeds\" do\n      expect(result).to be_a_success\n    end\n\n    it \"creates a Book with correct title and author\" do\n      expect(result.book.title).to eq(\"The Fire Next Time\")\n      expect(result.book.author).to eq(\"James Baldwin\")\n    end\n  end\nend\n```\n\n次に、インタラクタを実装していきます。\n\n```rb:lib/bookshelf/interactors/add_book.rb\nrequire 'hanami/interactor'\n\nclass AddBook\n  include Hanami::Interactor\n\n  expose :book\n\n  def initialize\n    # set up the object\n  end\n\n  def call(book_attributes)\n    @book = Book.new(book_attributes)\n  end\nend\n```\n\nここでは次の２つの重要なことが書かれています。\n\n1. `expose :book`ではメソッドの実行結果として返される`@book`を公開します。\n2. `call`メソッドは新しいBookエンティティを`@book`に割り当てて、公開します。\n\nこれでテストはパスするでしょう。\n\n## 作成した本の永続化 (Persisting the Book)\n\nさきほど新しい本をビルドしましたが、まだデータベースには存在していません。\n\n永続化のために`BookRepository`が必要です。\n\n```rb:spec/bookshelf/interactors/add_book_spec.rb\nrequire 'spec_helper'\n\ndescribe AddBook do\n  let(:interactor) { AddBook.new }\n  let(:attributes) { Hash[author: \"James Baldwin\", title: \"The Fire Next Time\"] }\n\n  describe \"good input\" do\n    let(:result) { interactor.call(attributes) }\n\n    it \"succeeds\" do\n      expect(result).to be_a_success\n    end\n\n    it \"creates a Book with correct title and author\" do\n      expect(result.book.title).to eq(\"The Fire Next Time\")\n      expect(result.book.author).to eq(\"James Baldwin\")\n    end\n\n    it \"persists the Book\" do\n      expect(result.book.id).to_not be_nil\n    end\n  end\nend\n```\n\nこのテストをパスさせるためにインタラクタの`call`メソッドを編集しましょう。\n\n```rb:lib/bookshelf/interactors/add_book.rb\n  def call\n    @book = BookRepository.new.create(book_attributes)\n  end\n```\n\n`Book.new`の代わりに`BookRepository`と`create`を使いました。相変わらず`Book`は返却されますが、レコードはデータベースに保存されます。\n\nテストを実行すればパスするでしょう。\n\n## 依存性の注入 (Dependency Injection)\n\n[依存性の注入](https://martinfowler.com/articles/injection.html)を活用してリファクタリングしましょう。\n\n依存性の注入はおすすめですが、必須ではありません。Hanamiのインタラクタ同様にオプションです。\n\n先程のスペックは役割を果たしますが、リポジトリの振る舞いに依存しています(`id`メソッドは永続化に成功して初めて定義されます)。それはリポジトリがどのように動作するかという実装の詳細です。例えば、もし永続化の**前に**UUIDを作成し、`id`カラムに値を入れるのではなく、他の方法で保存が成功したことを表す場合、スペックを変更する必要があります。\n\nスペックとインタラクタをより強固にすることができ、このファイル外の変更で壊れる可能性が低くなります。\n\nインタラクタで依存性の注入を使用するには以下のようにします。\n\n```rb:lib/bookshelf/interactors/add_book.rb\nrequire 'hanami/interactor'\n\nclass AddBook\n  include Hanami::Interactor\n\n  expose :book\n\n  def initialize(repository: BookRepository.new)\n    @repository = repository\n  end\n\n  def call(book_attributes)\n    @book = @repository.create(book_attributes)\n  end\nend\n```\n\n`@repository`を使う以外は基本的に一緒です。\n\n今のところのスペックは`id`が作成されたことをチェックしてリポジトリの動作をテストしています(`expect(result.book.id).to_not be_nil`)。\n\nこれは実装の詳細です。\n\n代わりに、スペックを単に「リポジトリが`create`メッセージを受け取ることを確認する」ように変更することができます。それはリポジトリが保存をちゃんと行ってくれることを信頼することです(そして、保存をちゃんと行うのはリポジトリの責任です)。\n\nスペックから`it \"persists the Book\"`を取り除きましょう。代わりに`describe \"persistence\"`を作成します。\n\n```rb:spec/bookshelf/interactors/add_book_spec.rb\nrequire 'spec_helper'\n\ndescribe AddBook do\n  let(:interactor) { AddBook.new }\n  let(:attributes) { Hash[author: \"James Baldwin\", title: \"The Fire Next Time\"] }\n\n  describe \"good input\" do\n    let(:result) { interactor.call(attributes) }\n\n    it \"succeeds\" do\n      expect(result).to be_a_success\n    end\n\n    it \"creates a Book with correct title and author\" do\n      expect(result.book.title).to eq(\"The Fire Next Time\")\n      expect(result.book.author).to eq(\"James Baldwin\")\n    end\n  end\n\n  describe \"persistence\" do\n    let(:repository) { instance_double(\"BookRepository\") }\n\n    it \"persists the Book\" do\n      expect(repository).to receive(:create)\n      AddBook.new(repository: repository).call(attributes)\n    end\n  end\nend\n```\n\nこれで、関心事の仕切り(the boundaries of the concern)に違反しなくなりました。\n\nここで行ったのはインタラクタのリポジトリの依存性の**注入**です。\n\u003cdetails\u003e\u003csummary\u003eノート: テストしていないコード(non-test code)は何も変更する必要がありません。`repository:`キーワード引数は指定しなかった場合は新しいリポジトリオブジェクトを提供します。\u003c/summary\u003e\n\u003cdiv\u003e[訳註] ここまでの説明ではコードが出てきていませんが、リポジトリはコントローラなどから以下のようにして使います。\n\n```rb:apps/web/controllers/book/create.rb\nmodule Web::Controllers::Book\n  class craete\n    include Web::Action\n\n    def call(params)\n      AddBook.new.call(params[:book])\n    end\n  end\nend\n```\n\n`AddBook.new`の引数を与えなかった場合、`AddBook`の`@repositoty`は`BookRepository.new`になります。そのため、依存性の注入を行う前と後でこのコードを変更する必要がない、ということをいっています。\n\u003c/div\u003e\u003c/details\u003e\n\n## メール通知 (Email notification)\n\nいよいよメール通知を追加しましょう!\n\nここで別のライブラリを使うこともできますが、`Hanami::Mailer`を使うことにしましょう。[^mail]\n\n```shell-session\n% bundle exec hanami generate mailer book_added_notification\n      create  lib/bookshelf/mailers/book_added_notification.rb\n      create  spec/bookshelf/mailers/book_added_notification_spec.rb\n      create  lib/bookshelf/mailers/templates/book_added_notification.txt.erb\n      create  lib/bookshelf/mailers/templates/book_added_notification.html.erb\n```\n\n[^mail]: [訳注] なぜ`mailers`が`apps`以下ではなく`lib`以下にあるのか疑問に思った人もいるかもしれません。安心してください。[2.0で変更の可能性があります](https://discourse.hanamirb.org/t/hanami-2-0-ideas/306/10)。\n\n[メーラーがどのように動作するか](http://hanamirb.org/guides/mailers/overview)の詳細には立ち入りませんが、`Hanami::Mailer`クラス、関連スペック、２つのテンプレート(プレーンテキストとHTML)があるシンプルな構成です。\n\nテンプレートは空にしておきます。メールは`'Book added!'`という件名の空メールになります。\n\nメーラースペックを編集します。\n\n```rb:spec/bookshelf/mailers/book_added_notification_spec.rb\nRSpec.describe Mailers::BookAddedNotification, type: :mailer do\n  subject { Mailers::BookAddedNotification }\n\n  before { Hanami::Mailer.deliveries.clear }\n\n  it 'has correct `from` email address' do\n    expect(subject.from).to eq(\"no-reply@example.com\")\n  end\n\n  it 'has correct `to` email address' do\n    expect(subject.to).to eq(\"admin@example.com\")\n  end\n\n  it 'has correct `subject`' do\n    expect(subject.subject).to eq(\"Book added!\")\n  end\n\n  it 'delivers mail' do\n    expect {\n      subject.deliver\n    }.to change { Hanami::Mailer.deliveries.length }.by(1)\n  end\nend\n```\n\nメーラーも編集します。\n\n```rb:lib/bookshelf/mailers/book_added_notification.rb\nclass Mailers::BookAddedNotification\n  include Hanami::Mailer\n\n  from    'no-reply@example.com'\n  to      'admin@example.com'\n  subject 'Book added!'\nend\n```\n\nこれでテストはパスするでしょう!\n\nしかし、このメーラはどこからも呼ばれてません。`AddBook`インタラクタから呼び出す必要があります。\n\n`AddBook`のスペックをメーラーが呼ばれていることを確認するように編集しましょう。\n\n```rb:spec/bookshelf/interactors/add_book_spec.rb\n  ...\n  describe \"sending email\" do\n    let(:mailer) { instance_double(\"Mailers::BookAddedNotification\") }\n\n    it \"send :deliver to the mailer\" do\n      expect(mailer).to receive(:deliver)\n      AddBook.new(mailer: mailer).call(attributes)\n    end\n  end\n  ...\n```\n\nインタラクタに`mailer`キーワード引数を追加して、メーラーを統合しましょう。\n\n```rb:lib/bookshelf/interactors/add_book.rb\nrequire 'hanami/interactor'\n\nclass AddBook\n  include Hanami::Interactor\n\n  expose :book\n\n  def initialize(repository: BookRepository.new, mailer: Mailers::BookAddedNotification.new)\n    @repository = repository\n    @mailer = mailer\n  end\n\n  def call(title:, author:)\n    @book = @repository.create({title: title, author: author})\n    @mailer.deliver\n  end\nend\n```\n\nこれでインタラクタは本が追加されたときにメールを送信します。\n\n## インタラクタの部品 (Interactor parts)\n\n### インタフェース (Interface)\n\nもうひとつ実装できる(オプションの)メソッドがあります。それは`valid?`というプライベートメソッドです。\n\nデフォルトでは`valid?`は`true`を返します。もし`valid?`を実装して`false`を返すようにすれば`call`は決して実行されません。\n\n\u003cdetails\u003e\u003csummary\u003eこれについての[APIドキュメント](http://www.rubydoc.info/gems/hanami-utils/Hanami/Interactor/Interface)を読むことができます。\u003c/summary\u003e\n\u003cdiv\u003e[訳註] サンプルを書いてみました。\n\n```rb:lib/bookshelf/interactors/add_book.rb\nrequire 'hanami/interactor'\n\nclass AddBook\n  class Validation\n    include Hanami::Validations\n\n    validations do\n      required(:title)  { filled? \u0026 str? }\n      required(:author) { filled? \u0026 str? \u0026 size?(2..64) }\n    end\n  end\n\n  include Hanami::Interactor\n\n  expose :book\n\n  def initialize(repository: BookRepository.new, mailer: Mailers::BookAddedNotification.new)\n    @repository = repository\n    @mailer = mailer\n  end\n\n  def call(title:, author:)\n    @book = @repository.create({title: title, author: author})\n    @mailer.deliver\n  end\n\nprivate\n\n  def valid?(title:, author:)\n    Validation.new(title: title, author: author).validate.success?\n  end\nend\n```\n\u003c/div\u003e\u003c/details\u003e\n\n### 結果オブジェクト (Result)\n\n`Hanami::Interactor#call`の戻り値は`Hanami::Interactor::Result`のオブジェクトです。\n\nこれは公開するインタンス変数に関わらずアクセサメソッドが定義されています。\n\nまた、エラーの追跡機能も持っています。\n\nインタラクタでは、メッセージを伴って`error`を呼び出し、エラーを追加できます。これにより自動的に結果オブジェクトが失敗します。\n\n(`error!`メソッドというのもあります。それは`error`と同じことをし、**かつ**、流れをとめ、インタラクタがより多くのコードを実行するのを止めます。)\n\n`.errors`を呼びですことで、結果オブジェクトのエラーにアクセスできます。\n\n結果オブジェクトについての詳細は[APIドキュメント](http://www.rubydoc.info/gems/hanami-utils/Hanami/Interactor/Result)を参照してください。\n\n---\n\n# 訳者によるまとめ\n\nコールバックはクッサい。\n","coediting":false,"comments_count":0,"created_at":"2017-12-07T23:36:36+09:00","group":null,"id":"eaa36f0192d910091e30","likes_count":13,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"DDD","versions":[]},{"name":"hanami","versions":[]},{"name":"サービス層","versions":[]},{"name":"Interactor","versions":[]}],"title":"Hanamiのサービス(インタラクタ)層について","updated_at":"2019-12-29T16:14:17+09:00","url":"https://qiita.com/isuke/items/eaa36f0192d910091e30","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e「CoffeeScript信者として何か書かねばならぬが、ネタが思い浮かばないぜ。」\u003c/p\u003e\n\n\u003cp\u003e皆さん日々、四苦八苦しながらwebpack.configを書いているでしょうか?その四苦八苦、CoffeeScriptを使うと少し楽になりますよ。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"webpackconfigをcoffeescriptで使う方法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#webpackconfig%E3%82%92coffeescript%E3%81%A7%E4%BD%BF%E3%81%86%E6%96%B9%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ewebpack.configをCoffeeScriptで使う方法\u003c/h1\u003e\n\n\u003cp\u003eまずは、coffeescriptをpackageに含めます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn add \u003cspan class=\"nt\"\u003e-D\u003c/span\u003e coffeescript\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eあとは拡張子を\u003ccode\u003e.coffee\u003c/code\u003eにして\u003ccode\u003ewebpack.config.coffee\u003c/code\u003eとするだけです。偉いぞwebpack!\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"coffeescriptの何が嬉しいか\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#coffeescript%E3%81%AE%E4%BD%95%E3%81%8C%E5%AC%89%E3%81%97%E3%81%84%E3%81%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCoffeeScriptの何が嬉しいか\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"記述が簡潔になる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A8%98%E8%BF%B0%E3%81%8C%E7%B0%A1%E6%BD%94%E3%81%AB%E3%81%AA%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e記述が簡潔になる\u003c/h2\u003e\n\n\u003cp\u003eCoffeeScriptを使うと記述が簡潔になる気がします。実際に見比べてみてください。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epath\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003emerge\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ewebpack-merge\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eHtmlWebpackPlugin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ehtml-webpack-plugin\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eCleanWebpackPlugin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eclean-webpack-plugin\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecoffee\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ebabel-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ecoffee-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecss\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ecss-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e    \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epostcss-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003estylus-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estylus\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003estyle-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e  \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ecss-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e    \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epostcss-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003estylus-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003estylus-resources-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003eresources\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e./src/styles/_variables.styl\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e./src/styles/_mixins.styl\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejson\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ejson-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003ebaseConfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eentry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e./src/main.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e./dist\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epublicPath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e''\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003erules\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"sr\"\u003evue$/\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eloaders\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ecoffee\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecoffee\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n              \u003cspan class=\"na\"\u003estylus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estylus\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.(\u003c/span\u003e\u003cspan class=\"sr\"\u003epng|jpg|gif|svg\u003c/span\u003e\u003cspan class=\"se\"\u003e)\u003c/span\u003e\u003cspan class=\"sr\"\u003e$/\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003efile-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e[name].[ext]?[hash]\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"sr\"\u003ecoffee$/\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecoffee\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"sr\"\u003ecss$/\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecss\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"sr\"\u003estyl$/\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003estylus\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"sr\"\u003ejson$/\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejson\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ealias\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@root\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@src\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e        \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003esrc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@scripts\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e    \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003esrc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003escripts\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@components\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003esrc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ecomponents\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@pages\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e      \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003esrc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epages\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@assets\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e     \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003esrc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eassets\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@styles\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e     \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003esrc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003estyles\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue$\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue/dist/vue.esm.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eHtmlWebpackPlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003esrc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eindex_template.html\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}),\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eDefinePlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eprocess.env\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eNODE_ENV\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e`'\u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNODE_ENV\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e'`\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}),\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eProvidePlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e_\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003elodash\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eaxios\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eaxios\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNODE_ENV\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eproduction\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003econfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ebaseConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efilename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ebuild-[hash].js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edevtool\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e#source-map\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eCleanWebpackPlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003edist\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]),\u003c/span\u003e\n      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eoptimize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eUglifyJsPlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n        \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ecompress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"na\"\u003ewarnings\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}),\u003c/span\u003e\n      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eLoaderOptionsPlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eminimize\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003econfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ebaseConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efilename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ebuild.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edevtool\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e#eval-source-map\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edevServer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003econtentBase\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003edist\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ehistoryApiFallback\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003enoInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eperformance\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ehints\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.coffee\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003epath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'path'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'webpack'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003emerge\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'webpack-merge'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eHtmlWebpackPlugin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'html-webpack-plugin'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eCleanWebpackPlugin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'clean-webpack-plugin'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecoffee\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'babel-loader'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'coffee-loader'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecss\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'css-loader'\u003c/span\u003e    \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'postcss-loader'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'stylus-loader'\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003estylus\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'style-loader'\u003c/span\u003e  \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'css-loader'\u003c/span\u003e    \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'postcss-loader'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'stylus-loader'\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'stylus-resources-loader'\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003eresources\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'./src/styles/_variables.styl'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'./src/styles/_mixins.styl'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ejson\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s\"\u003e'json-loader'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003ebaseConfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eentry\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'./src/main.js'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epath\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'./dist'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epublicPath\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e''\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emodule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003erules\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\\.vue$/\u003c/span\u003e\n      \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'vue-loader'\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eloaders\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecoffee\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecoffee\u003c/span\u003e\n            \u003cspan class=\"na\"\u003estylus\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003estylus\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\\.(png|jpg|gif|svg)$/\u003c/span\u003e\n      \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'file-loader'\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n          \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'[name].[ext]?[hash]'\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\\.coffee$/\u003c/span\u003e\n      \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecoffee\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\\.css$/\u003c/span\u003e\n      \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecss\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\\.styl$/\u003c/span\u003e\n      \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003estylus\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\\.json$/\u003c/span\u003e\n      \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ejson\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ealias\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'@root'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e       \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'@src'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e        \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'src'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'@scripts'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e    \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'src'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'scripts'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'@components'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'src'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'components'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'@pages'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e      \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'src'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'pages'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'@assets'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e     \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'src'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'assets'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'@styles'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e     \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'src'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'styles'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'vue$'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'vue/dist/vue.esm.js'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eplugins\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eHtmlWebpackPlugin\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etemplate\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'src'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'index_template.html'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eDefinePlugin\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'process.env'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eNODE_ENV\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"'\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eNODE_ENV\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s\"\u003e'\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eProvidePlugin\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'_'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'lodash'\u003c/span\u003e\n      \u003cspan class=\"s\"\u003e'axios'\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'axios'\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eNODE_ENV\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e'production'\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003econfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emerge\u003c/span\u003e \u003cspan class=\"nx\"\u003ebaseConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efilename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'build-[hash].js'\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edevtool\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'#source-map'\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eplugins\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eCleanWebpackPlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"s\"\u003e'dist'\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eoptimize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eUglifyJsPlugin\u003c/span\u003e\n        \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ecompress\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n          \u003cspan class=\"na\"\u003ewarnings\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eLoaderOptionsPlugin\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eminimize\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003econfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emerge\u003c/span\u003e \u003cspan class=\"nx\"\u003ebaseConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efilename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'build.js'\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edevtool\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'#eval-source-map'\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edevServer\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003econtentBase\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'dist'\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ehistoryApiFallback\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n      \u003cspan class=\"na\"\u003enoInfo\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eperformance\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ehints\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003econfig\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eどうでしょうか?\u003ccode\u003ewebpack.config.coffee\u003c/code\u003eのほうが余計なブレースやカンマがなくなり、スッキリした見た目になっていると思いませんか?そうでもないですか?\u003c/p\u003e\n\n\u003cp\u003eまぁ、分かる人にだけわかってもらえれば結構。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"試行錯誤しやすい\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A9%A6%E8%A1%8C%E9%8C%AF%E8%AA%A4%E3%81%97%E3%82%84%E3%81%99%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e試行錯誤しやすい\u003c/h2\u003e\n\n\u003cp\u003ewebpack.configを試行錯誤しながら編集することはままあります。そんなときjsだと結構いらいらさせられます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e    plugins: [\n      new webpack.optimize.UglifyJsPlugin({\n        sourceMap: true,\n        compress: {\n          warnings: false\n        }\n      }),\n      new webpack.LoaderOptionsPlugin({\n        minimize: true\n      })\n\u003cspan class=\"gi\"\u003e+     new CleanWebpackPlugin(['dist']) // pluginを足してみて動きを確かめたい。\n\u003c/span\u003e    ]\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこの\u003ccode\u003eweboack.config.js\u003c/code\u003eはシンタックスエラーになります。追加した行の手前にカンマがないからです。憎い！\u003c/p\u003e\n\n\u003cp\u003eCoffeeScriptならこのようなイライラとは無縁です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.coffee\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e    plugins: [\n      new webpack.optimize.UglifyJsPlugin\n        sourceMap: true\n        compress:\n          warnings: false\n\u003cspan class=\"gd\"\u003e-     new webpack.LoaderOptionsPlugin # 削除も\n-       minimize: true\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+     new CleanWebpackPlugin(['dist']) # 追加も自由自在！\n\u003c/span\u003e    ]\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003eどうですか?CoffeeScriptが使ってみたくなりましたか?なりませんか?そうですか。残念です・・・。\u003c/p\u003e\n","body":"「CoffeeScript信者として何か書かねばならぬが、ネタが思い浮かばないぜ。」\n\n皆さん日々、四苦八苦しながらwebpack.configを書いているでしょうか?その四苦八苦、CoffeeScriptを使うと少し楽になりますよ。\n\n# webpack.configをCoffeeScriptで使う方法\n\nまずは、coffeescriptをpackageに含めます。\n\n```shell-session\n$ yarn add -D coffeescript\n```\n\nあとは拡張子を`.coffee`にして`webpack.config.coffee`とするだけです。偉いぞwebpack!\n\n# CoffeeScriptの何が嬉しいか\n\n## 記述が簡潔になる\n\nCoffeeScriptを使うと記述が簡潔になる気がします。実際に見比べてみてください。\n\n```js:webpack.config.js\nconst path = require('path');\nconst webpack = require('webpack');\nconst merge = require('webpack-merge');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\nconst CleanWebpackPlugin = require('clean-webpack-plugin');\n\nlet loader = {};\nloader.coffee = ['babel-loader', 'coffee-loader'];\nloader.css = [\n  { loader: 'css-loader'    , options: { sourceMap: true } },\n  { loader: 'postcss-loader', options: { sourceMap: true } },\n  { loader: 'stylus-loader' , options: { sourceMap: true } },\n];\nloader.stylus = [\n  { loader: 'style-loader'  , options: { sourceMap: true } },\n  { loader: 'css-loader'    , options: { sourceMap: true } },\n  { loader: 'postcss-loader', options: { sourceMap: true } },\n  { loader: 'stylus-loader' , options: { sourceMap: true } },\n  {\n    loader: 'stylus-resources-loader',\n    options: {\n      resources: [\n        path.resolve(__dirname, './src/styles/_variables.styl'),\n        path.resolve(__dirname, './src/styles/_mixins.styl')\n      ]\n    }\n  },\n];\nloader.json = ['json-loader'];\n\nbaseConfig = {\n  entry: './src/main.js',\n  output: {\n    path: path.resolve(__dirname, './dist'),\n    publicPath: ''\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.vue$/,\n        use: {\n          loader: 'vue-loader',\n          options: {\n            loaders: {\n              coffee: loader.coffee,\n              stylus: loader.stylus\n            }\n          }\n        }\n      },\n      {\n        test: /\\.(png|jpg|gif|svg)$/,\n        use: [\n          {\n            loader: 'file-loader',\n            options: {\n              name: '[name].[ext]?[hash]'\n            }\n          }\n        ]\n      },\n      {\n        test: /\\.coffee$/,\n        use: loader.coffee\n      },\n      {\n        test: /\\.css$/,\n        use: loader.css\n      },\n      {\n        test: /\\.styl$/,\n        use: loader.stylus\n      },\n      {\n        test: /\\.json$/,\n        use: loader.json\n      }\n    ]\n  },\n  resolve: {\n    alias: {\n      '@root':       path.resolve(__dirname),\n      '@src':        path.resolve(__dirname, 'src'),\n      '@scripts':    path.resolve(__dirname, 'src', 'scripts'),\n      '@components': path.resolve(__dirname, 'src', 'components'),\n      '@pages':      path.resolve(__dirname, 'src', 'pages'),\n      '@assets':     path.resolve(__dirname, 'src', 'assets'),\n      '@styles':     path.resolve(__dirname, 'src', 'styles'),\n      'vue$': 'vue/dist/vue.esm.js'\n    }\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: path.resolve(__dirname, 'src', 'index_template.html')\n    }),\n    new webpack.DefinePlugin({\n      'process.env': {\n        NODE_ENV: `'${process.env.NODE_ENV}'`\n      }\n    }),\n    new webpack.ProvidePlugin({\n      '_': 'lodash',\n      'axios': 'axios'\n    })\n  ]\n};\n\nif (process.env.NODE_ENV === 'production') {\n  config = merge(baseConfig, {\n    output: {\n      filename: 'build-[hash].js'\n    },\n    devtool: '#source-map',\n    plugins: [\n      new CleanWebpackPlugin(['dist']),\n      new webpack.optimize.UglifyJsPlugin({\n        sourceMap: true,\n        compress: {\n          warnings: false\n        }\n      }),\n      new webpack.LoaderOptionsPlugin({\n        minimize: true\n      })\n    ]\n  });\n} else {\n  config = merge(baseConfig, {\n    output: {\n      filename: 'build.js'\n    },\n    devtool: '#eval-source-map',\n    devServer: {\n      contentBase: 'dist',\n      historyApiFallback: true,\n      noInfo: true\n    },\n    performance: {\n      hints: false\n    }\n  });\n}\n\nmodule.exports = config;\n```\n\n```coffeescript:webpack.config.coffee\npath = require('path')\nwebpack = require('webpack')\nmerge = require('webpack-merge')\nHtmlWebpackPlugin = require('html-webpack-plugin')\nCleanWebpackPlugin = require('clean-webpack-plugin')\n\nloader = {}\nloader.coffee = ['babel-loader', 'coffee-loader']\nloader.css    = [\n  { loader: 'css-loader'    , options: sourceMap: true }\n  { loader: 'postcss-loader', options: sourceMap: true }\n  { loader: 'stylus-loader' , options: sourceMap: true }\n]\nloader.stylus = [\n  { loader: 'style-loader'  , options: sourceMap: true }\n  { loader: 'css-loader'    , options: sourceMap: true }\n  { loader: 'postcss-loader', options: sourceMap: true }\n  { loader: 'stylus-loader' , options: sourceMap: true }\n  {\n    loader: 'stylus-resources-loader'\n    options:\n      resources: [\n        path.resolve(__dirname, './src/styles/_variables.styl')\n        path.resolve(__dirname, './src/styles/_mixins.styl')\n      ]\n  }\n]\nloader.json = ['json-loader']\n\nbaseConfig =\n  entry: './src/main.js'\n  output:\n    path: path.resolve(__dirname, './dist')\n    publicPath: ''\n  module:\n    rules: [\n      test: /\\.vue$/\n      use:\n        loader: 'vue-loader'\n        options:\n          loaders:\n            coffee: loader.coffee\n            stylus: loader.stylus\n    ,\n      test: /\\.(png|jpg|gif|svg)$/\n      use: [\n        loader: 'file-loader'\n        options:\n          name: '[name].[ext]?[hash]'\n      ]\n    ,\n      test: /\\.coffee$/\n      use: loader.coffee\n    ,\n      test: /\\.css$/\n      use: loader.css\n    ,\n      test: /\\.styl$/\n      use: loader.stylus\n    ,\n      test: /\\.json$/\n      use: loader.json\n    ]\n  resolve:\n    alias:\n      '@root':       path.resolve(__dirname)\n      '@src':        path.resolve(__dirname, 'src')\n      '@scripts':    path.resolve(__dirname, 'src', 'scripts')\n      '@components': path.resolve(__dirname, 'src', 'components')\n      '@pages':      path.resolve(__dirname, 'src', 'pages')\n      '@assets':     path.resolve(__dirname, 'src', 'assets')\n      '@styles':     path.resolve(__dirname, 'src', 'styles')\n      'vue$': 'vue/dist/vue.esm.js'\n  plugins: [\n    new HtmlWebpackPlugin\n      template: path.resolve(__dirname, 'src', 'index_template.html')\n    new webpack.DefinePlugin\n      'process.env':\n        NODE_ENV: \"'#{process.env.NODE_ENV}'\"\n    new webpack.ProvidePlugin\n      '_': 'lodash'\n      'axios': 'axios'\n  ]\n\nif process.env.NODE_ENV == 'production'\n  config = merge baseConfig,\n    output:\n      filename: 'build-[hash].js'\n    devtool: '#source-map'\n    plugins: [\n      new CleanWebpackPlugin(['dist'])\n      new webpack.optimize.UglifyJsPlugin\n        sourceMap: true\n        compress:\n          warnings: false\n      new webpack.LoaderOptionsPlugin\n        minimize: true\n    ]\nelse\n  config = merge baseConfig,\n    output:\n      filename: 'build.js'\n    devtool: '#eval-source-map'\n    devServer:\n      contentBase: 'dist'\n      historyApiFallback: true\n      noInfo: true\n    performance:\n      hints: false\n\nmodule.exports = config\n```\n\nどうでしょうか?`webpack.config.coffee`のほうが余計なブレースやカンマがなくなり、スッキリした見た目になっていると思いませんか?そうでもないですか?\n\nまぁ、分かる人にだけわかってもらえれば結構。\n\n## 試行錯誤しやすい\n\nwebpack.configを試行錯誤しながら編集することはままあります。そんなときjsだと結構いらいらさせられます。\n\n```diff:webpack.config.js\n    plugins: [\n      new webpack.optimize.UglifyJsPlugin({\n        sourceMap: true,\n        compress: {\n          warnings: false\n        }\n      }),\n      new webpack.LoaderOptionsPlugin({\n        minimize: true\n      })\n+     new CleanWebpackPlugin(['dist']) // pluginを足してみて動きを確かめたい。\n    ]\n```\n\nこの`weboack.config.js`はシンタックスエラーになります。追加した行の手前にカンマがないからです。憎い！\n\nCoffeeScriptならこのようなイライラとは無縁です。\n\n```diff:webpack.config.coffee\n    plugins: [\n      new webpack.optimize.UglifyJsPlugin\n        sourceMap: true\n        compress:\n          warnings: false\n-     new webpack.LoaderOptionsPlugin # 削除も\n-       minimize: true\n+     new CleanWebpackPlugin(['dist']) # 追加も自由自在！\n    ]\n```\n\n# まとめ\n\nどうですか?CoffeeScriptが使ってみたくなりましたか?なりませんか?そうですか。残念です・・・。\n","coediting":false,"comments_count":0,"created_at":"2017-12-07T23:34:44+09:00","group":null,"id":"499aa0de0903f2d247d1","likes_count":3,"private":false,"reactions_count":0,"tags":[{"name":"CoffeeScript","versions":[]},{"name":"webpack","versions":[]}],"title":"webpack.configはCoffeeScriptで書くと幸せになれる","updated_at":"2017-12-09T07:01:34+09:00","url":"https://qiita.com/isuke/items/499aa0de0903f2d247d1","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eオリジナルのコンポーネントライブラリを作って公開するまでの手順です。\u003c/p\u003e\n\n\u003cp\u003e著者も試行錯誤しながらとりあえず公開できるところまでもっていった段階ですので、至らない点があると思います。\u003cbr\u003e\n不備を見つけられた方はコメントで教えてくださると幸いです。\u003c/p\u003e\n\n\u003cp\u003e完成品は\u003ca href=\"https://github.com/isuke/my-components-sample\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"前提\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%8F%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前提\u003c/h1\u003e\n\n\u003cp\u003e\u003ccode\u003enode\u003c/code\u003eはもちろん、\u003ccode\u003eyarn\u003c/code\u003eも使いますので入れておいてください。\u003cbr\u003e\n\u003ccode\u003eyarn\u003c/code\u003eを使わない方は適宜、\u003ccode\u003enpm\u003c/code\u003eで読み替えてください。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"コンポーネントを作る\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコンポーネントを作る\u003c/h1\u003e\n\n\u003cp\u003eまずはディレクリを作って、\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003emkdir \u003c/span\u003emy-components-sample\n\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003ecd \u003c/span\u003emy-components-sample\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eyarn init\u003c/code\u003eして\u003ccode\u003epackage.json\u003c/code\u003eを作ります。\u003cbr\u003e\n\u003ccode\u003eprivate\u003c/code\u003eを\u003ccode\u003efalse\u003c/code\u003eにするのがポイントです。\u003ccode\u003etrue\u003c/code\u003eだと公開できないですからね。\u003cbr\u003e\n\u003ccode\u003emain\u003c/code\u003eは後で書き換えるので適当でいいです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn init      \n\u003cspan class=\"go\"\u003eyarn init v1.3.2\nquestion name (my-components-sample): \nquestion version (1.0.0): \nquestion description: My Component Sample\nquestion entry point (index.js): \nquestion repository url: \nquestion author: \nquestion license (MIT): \nquestion private: false\nsuccess Saved package.json\n✨  Done in 35.73s.\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003evue.jsを入れます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn add vue\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e適当に２つコンポーネントを作ります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003emkdir\u003c/span\u003e \u003cspan class=\"nt\"\u003e-p\u003c/span\u003e src/components\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003esrc/components/Foo.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    Hello Foo {{msg}}\n  \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eprops\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003erequired\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;style\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nc\"\u003e.foo\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003ecolor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003eblue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/style\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003esrc/components/Bar.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"bar\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    Hello Bar {{msg}}\n  \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eprops\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003erequired\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;style\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nc\"\u003e.bar\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003ecolor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003ered\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/style\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"webpack設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#webpack%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ewebpack設定\u003c/h1\u003e\n\n\u003cp\u003ewebpackを設定していきます。\u003cbr\u003e\n必要なものをまるっと追加してしましましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003epackage.json\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  {\n    \"name\": \"my-components-sample\",\n    \"version\": \"1.0.0\",\n    \"description\": \"My Component Sample\",\n    \"main\": \"index.js\",\n    \"license\": \"MIT\",\n    \"private\": false,\n    \"dependencies\": {\n      \"vue\": \"^2.5.9\"\n\u003cspan class=\"gd\"\u003e-   }\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+   },\n+   \"devDependencies\": {\n+     \"autoprefixer\": \"^7.1.4\",\n+     \"babel-core\": \"^6.26.0\",\n+     \"babel-loader\": \"^7.1.2\",\n+     \"babel-preset-env\": \"^1.6.0\",\n+     \"clean-webpack-plugin\": \"^0.1.17\",\n+     \"cross-env\": \"^5.1.1\",\n+     \"css-loader\": \"^0.28.7\",\n+     \"style-loader\": \"^0.18.2\",\n+     \"vue-loader\": \"^12.1.0\",\n+     \"vue-template-compiler\": \"^2.3.3\",\n+     \"webpack\": \"^3.6.0\",\n+     \"webpack-merge\": \"^4.1.0\",\n+     \"webpack-node-externals\": \"^1.6.0\"\n+   }\n\u003c/span\u003e  }\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epath\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003emerge\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ewebpack-merge\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eCleanWebpackPlugin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eclean-webpack-plugin\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003ebaseConfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e/dist/`\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003erules\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"sr\"\u003evue$/\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eextensions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e.vue\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ealias\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@src\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003esrc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@components\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003esrc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ecomponents\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue$\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue/dist/vue.esm.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eexternals\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eVue\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eProvidePlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eVue\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\n\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNODE_ENV\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eproduction\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eproductionConfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003emerge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ebaseConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eCleanWebpackPlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003edist\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e]),\u003c/span\u003e\n      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eoptimize\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eUglifyJsPlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eminimize\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003emangle\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ecompress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"na\"\u003ewarnings\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}),\u003c/span\u003e\n      \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eLoaderOptionsPlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eminimize\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edevtool\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e#source-map\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003econfig\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eproductionConfig\u003c/span\u003e \u003cspan class=\"c1\"\u003e// TODO\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e`\\`\u003c/span\u003e\u003cspan class=\"p\"\u003e${\u003c/span\u003e\u003cspan class=\"nx\"\u003eprocess\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNODE_ENV\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\\` is not defined.`\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこの状態ではまだ\u003ccode\u003eoutput\u003c/code\u003eもちゃんと指定していないし、エンドポイントもないのでコンパイルできません。\u003cbr\u003e\n次に進みましょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"公開する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e公開する\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"cdnで公開する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#cdn%E3%81%A7%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCDNで公開する\u003c/h2\u003e\n\n\u003cp\u003eまずはCDNで公開できるようにします。\u003cbr\u003e\nCDN用のエンドポイントを作成します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"javascript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003esrc/plugins.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003einstall\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecomponent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003efoo\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@components/Foo\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecomponent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ebar\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@components/Bar\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれをエンドポイントとしたwebpackの設定を書いていきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gd\"\u003e- config = productionConfig // TODO\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+ config = [\n+   merge(productionConfig,\n+   {\n+     entry: path.resolve(__dirname + '/src/plugin.js'),\n+     output: {\n+       filename: 'my-components-sample.min.js',\n+       libraryTarget: 'window',\n+       library: 'MyComponentsSample'\n+     }\n+   })\n+ ];\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003elibraryTarget: 'window'\u003c/code\u003e, \u003ccode\u003elibrary: 'MyComponentsSample'\u003c/code\u003eを設定することで、ブラウザで\u003ccode\u003emy-components-sample.min.js\u003c/code\u003eを読み込んだときに\u003ccode\u003ewindow.MyComponentsSample\u003c/code\u003eで使えるようになります。\u003c/p\u003e\n\n\u003cp\u003epackage.jsonに下記を追加します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003epackage.json\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  {\n    ...\n\u003cspan class=\"gi\"\u003e+   \"scripts\": {\n+     \"build\": \"cross-env NODE_ENV=production webpack --progress --hide-modules\"\n+   },\n\u003c/span\u003e    ...\n  }\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eすかさずビルド！\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn run build\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003edist/my-components-sample.min.js\u003c/code\u003eと\u003ccode\u003edist/my-components-sample.min.js.map\u003c/code\u003eができていればOKです。\u003c/p\u003e\n\n\u003cp\u003eこれらのファイルをCDNで公開するわけですが、これは\u003ca href=\"https://www.jsdelivr.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ejsDelivr\u003c/a\u003eを使うと超がつくほど簡単です。\u003c/p\u003e\n\n\u003cp\u003eまずは、\u003ccode\u003epackge.json\u003c/code\u003eに以下を追加します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003epackge.json\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  {\n    ...\n    \"main\": \"index.js\",\n\u003cspan class=\"gi\"\u003e+   \"cdn\": \"dist/my-components-sample.min.js\",\n\u003c/span\u003e    ...\n  }\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003emain\u003c/code\u003eは後で使うので書き換えません。\u003c/p\u003e\n\n\u003cp\u003e次に、今まで作ったコードをGitHubで公開しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003egit init\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.gitignroe\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003enode_modules/\nnpm-debug.log\nyarn-error.log\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003edist\u003c/code\u003eディレクトリを\u003ccode\u003e.gitignore\u003c/code\u003eに入れないように注意です。\u003cbr\u003e\n\u003ccode\u003edist\u003c/code\u003eは公開しないといけないですからね。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003egit add \u003cspan class=\"nt\"\u003e-A\u003c/span\u003e\n\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003egit commit \u003cspan class=\"nt\"\u003e-m\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Initial commit\"\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eGitHubのリポジトリを作成する部分は省略します。\u003c/strong\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003egit remote add origin git@github.com:you/my-components-sample.git\n\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003egit push \u003cspan class=\"nt\"\u003e-u\u003c/span\u003e origin master\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eタグも付けてあげます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003egit tag v1.0.0\n\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003egit push origin v1.0.0\n\u003cspan class=\"go\"\u003e\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eなんと、これだけでCDNでの公開ができてしまっています。\u003cbr\u003e\n実際にjsbinで確認してみましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://jsbin.com/yufohim/edit?html,js,output\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://jsbin.com/yufohim/edit?html,js,output\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eやりました。ちゃんと動いています。\u003cbr\u003e\n(vue.js 2.0.3ではなぜかエラーになって動かなかったので最新バージョンのvue.jsを使っています。)\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"npmで公開する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#npm%E3%81%A7%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eNPMで公開する\u003c/h2\u003e\n\n\u003cp\u003e次に、NPMで公開します。\u003cbr\u003e\nNPM用のエンドポイントを作成します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003esrc/index.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nx\"\u003eMyFoo\u003c/span\u003e \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@components/Foo\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nx\"\u003eMyBar\u003c/span\u003e \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e@components/Bar\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eVERSION\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e1.0.0\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eFoo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eMyFoo\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"kd\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eBar\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eMyBar\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれをエンドポイントとしたwebpackの設定を書いていきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  config = [\n    merge(productionConfig,\n    {\n      entry: path.resolve(__dirname + '/src/plugin.js'),\n      output: {\n        filename: 'my-components-sample.min.js',\n        libraryTarget: 'window',\n        library: 'MyComponentsSample'\n      }\n\u003cspan class=\"gd\"\u003e-   })\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+   }),\n+   merge(productionConfig,\n+   {\n+     entry: path.resolve(__dirname + '/src/index.js'),\n+     output: {\n+       filename: 'my-components-sample.js',\n+       libraryTarget: 'umd',\n+       library: 'MyComponentsSample',\n+       umdNamedDefine: true\n+     }\n+   }),\n\u003c/span\u003e  ];\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eyarn run build\u003c/code\u003eを実行して\u003ccode\u003edist/my-components-sample.js\u003c/code\u003eと\u003ccode\u003edist/my-components-sample.js.map\u003c/code\u003eができていればOKです。\u003c/p\u003e\n\n\u003cp\u003eあとは\u003ccode\u003epackage.json\u003c/code\u003eを書き換えます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003epackage.json\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gd\"\u003e- \"main\": \"index.js\",\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+ \"main\": \"dist/my-components-sample.js\",\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eあとは、npm に push するだけです。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003enpmのアカウント作成部分は省略します。\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003enpmを汚さないために今回は実際にはpushしません。\u003c/strong\u003e\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn publish\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eうまく行っていれば、以下のようにして使うことができるはずです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn add my-components-sample\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ehoge.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nx\"\u003eMy\u003c/span\u003e \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003emy-components-sample\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ecomponents\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003emy-foo\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eMy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eFoo\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"落ち穂拾い\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%90%BD%E3%81%A1%E7%A9%82%E6%8B%BE%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e落ち穂拾い\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"デプロイを楽にする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4%E3%82%92%E6%A5%BD%E3%81%AB%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eデプロイを楽にする\u003c/h2\u003e\n\n\u003cp\u003eデプロイ手順は以下のようになります。\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e\n\u003ccode\u003epackage.json\u003c/code\u003eと\u003ccode\u003eindex.js\u003c/code\u003eのバージョン書き換え\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eyarn run deploy\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egit add -A \u0026amp;\u0026amp; git commit -m 'hogehoge'\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egit tag v1.x.x \u0026amp;\u0026amp; git push origin v1.x.x\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eyarn publish\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e毎回これをやるのは面倒なので半自動化しましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003edeploy.sh\u003c/code\u003eを作ります(著者はshellが苦手なのでソースが汚いのは勘弁)。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"bash\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003edeploy.sh\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nv\"\u003eGEEEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"se\"\u003e\\e\u003c/span\u003e\u003cspan class=\"s2\"\u003e[0;32m\"\u003c/span\u003e\n\u003cspan class=\"nv\"\u003eRED\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"se\"\u003e\\e\u003c/span\u003e\u003cspan class=\"s2\"\u003e[0;31m\"\u003c/span\u003e\n\u003cspan class=\"nv\"\u003eRESET\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"se\"\u003e\\e\u003c/span\u003e\u003cspan class=\"s2\"\u003e[0m\"\u003c/span\u003e\n\u003cspan class=\"nv\"\u003eVERSION\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$1\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e# Check version format\u003c/span\u003e\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e[[\u003c/span\u003e \u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e~ ^[0-9]+\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e0-9]+\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e0-9]+\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"o\"\u003e]]\u003c/span\u003e \u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003ethen\n  \u003c/span\u003e\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eGEEEN\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003eDeploy version v\u003c/span\u003e\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRESET\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n\u003cspan class=\"k\"\u003eelse\n  \u003c/span\u003e\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRED\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003eVERSION format is 'x.x.x'. (\u003c/span\u003e\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e\u003cspan class=\"s2\"\u003e)\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRESET\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eexit \u003c/span\u003e1\n\u003cspan class=\"k\"\u003efi\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e# Check existing tag\u003c/span\u003e\ngit tag | \u003cspan class=\"nb\"\u003egrep \u003c/span\u003ev\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e /dev/null\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e \u003cspan class=\"nv\"\u003e$?\u003c/span\u003e \u003cspan class=\"nt\"\u003e-eq\u003c/span\u003e 0 \u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003ethen\n  \u003c/span\u003e\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRED\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003egit tag 'v\u003c/span\u003e\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e\u003cspan class=\"s2\"\u003e' is existing\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRESET\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eexit \u003c/span\u003e1\n\u003cspan class=\"k\"\u003efi\n\n\u003c/span\u003e\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eGEEEN\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003eRewite src/index.js\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRESET\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\ngsed \u003cspan class=\"nt\"\u003e-r\u003c/span\u003e \u003cspan class=\"nt\"\u003e-i\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"s/VERSION = '[0-9]+\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"s2\"\u003e[0-9]+\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"s2\"\u003e[0-9]+'/VERSION = '\u003c/span\u003e\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e\u003cspan class=\"s2\"\u003e'/g\"\u003c/span\u003e src/index.js\ngit add src/index.js\n\n\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eGEEEN\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003eRewite package.json\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRESET\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\ngsed \u003cspan class=\"nt\"\u003e-r\u003c/span\u003e \u003cspan class=\"nt\"\u003e-i\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"s/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"s2\"\u003eversion\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"s2\"\u003e: \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"s2\"\u003e[0-9]+\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"s2\"\u003e[0-9]+\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"s2\"\u003e[0-9]+\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"s2\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"s2\"\u003eversion\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"s2\"\u003e: \u003c/span\u003e\u003cspan class=\"se\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e\u003cspan class=\"se\"\u003e\\\"\u003c/span\u003e\u003cspan class=\"s2\"\u003e/g\"\u003c/span\u003e package.json\ngit add package.json\n\n\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eGEEEN\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003eBuild\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRESET\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\nyarn run build\ngit add dist\n\n\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eGEEEN\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003egit commit\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRESET\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\ngit commit \u003cspan class=\"nt\"\u003e-m\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Upgrade to v\u003c/span\u003e\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\ngit tag v\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eGEEEN\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003ePlease command 'git push origin master \u0026amp;\u0026amp; git push origin v\u003c/span\u003e\u003cspan class=\"nv\"\u003e$VERSION\u003c/span\u003e\u003cspan class=\"s2\"\u003e \u0026amp;\u0026amp; yarn publish'\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"k\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eRESET\u003c/span\u003e\u003cspan class=\"k\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e実行権限をつけるのを忘れずに。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nb\"\u003echmod \u003c/span\u003e774 deploy.sh\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれを実行するためにはmacの場合\u003ccode\u003egnu-sed\u003c/code\u003eが必要です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebrew \u003cspan class=\"nb\"\u003einstall \u003c/span\u003ecoreutils\n\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebrew \u003cspan class=\"nb\"\u003einstall \u003c/span\u003egnu-sed\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eLinuxの場合は\u003ccode\u003egsed\u003c/code\u003eを\u003ccode\u003esed\u003c/code\u003eに置き換えればいいと思います(たぶん)。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003epackage.json\u003c/code\u003eにdelpoyコマンドを追加してあげましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003epackage.json\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  \"scripts\": {\n    \"build\": \"cross-env NODE_ENV=production webpack --progress --hide-modules\",\n\u003cspan class=\"gi\"\u003e+   \"deploy\": \"./deploy.sh\"\n\u003c/span\u003e  },\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eあとは、\u003ccode\u003eyarn run deploy 1.0.0\u003c/code\u003eなどと実行すれば、最後のpushの直前までやってくれます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ドキュメントを書く\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%82%92%E6%9B%B8%E3%81%8F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eドキュメントを書く\u003c/h2\u003e\n\n\u003cp\u003eせっかく、ライブラリを公開したのですから使ってもらうようにドキュメントを書くといいでしょう。\u003cbr\u003e\nvue.jsのコンポーネントのドキュメントを書くのには\u003ca href=\"https://github.com/propellant/doctor\" rel=\"nofollow noopener\" target=\"_blank\"\u003epropdoc\u003c/a\u003eを使うのが良さそうです。\u003c/p\u003e\n\n\u003cp\u003epropdoc用にコンポーネントを加筆しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eFoo.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  \u0026lt;script\u0026gt;\n  export default {\n\u003cspan class=\"gi\"\u003e+   name: \"Foo\",\n+   introduction: \"displaoy message.\",\n+   description: `\n+     This is amazing component.\n+   `,\n+   token: \"\u0026lt;foo msg='ALL OK'\u0026gt;\u0026lt;/foo\u0026gt;\",\n\u003c/span\u003e    props: {\n      msg: {\n        type: String,\n        required: true,\n\u003cspan class=\"gi\"\u003e+       note: 'message'\n\u003c/span\u003e      }\n    }\n  };\n  \u0026lt;/script\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれは以下のように使います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eComponentDoc.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"component-doc\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;article\u003c/span\u003e \u003cspan class=\"na\"\u003ev-for=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"doc in docs\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;h1\u0026gt;\u003c/span\u003e{{doc.name}}\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;h2\u0026gt;\u003c/span\u003e{{doc.introduction}}\u003cspan class=\"nt\"\u003e\u0026lt;/h2\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/article\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"nx\"\u003epropDoc\u003c/span\u003e \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epropdoc\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"k\"\u003eas\u003c/span\u003e \u003cspan class=\"nx\"\u003eMy\u003c/span\u003e \u003cspan class=\"k\"\u003efrom\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003emy-components-sample\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edocs\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003epropDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eMy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eFoo\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003epropDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetDoc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eMy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eBar\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eもっと詳しく知りたい人は\u003ca href=\"https://github.com/propellant/doctor\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式\u003c/a\u003eを確認して見てください。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003eコンポーネントライブラリを作るのは結構かんたんなのでみんさんもオレオレライブラリを作って公開しましょう。\u003cbr\u003e\n著者も\u003ca href=\"https://github.com/isuke/rhoa\" rel=\"nofollow noopener\" target=\"_blank\"\u003eRhoa\u003c/a\u003eというライブラリを作っています。楽しいです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.codementor.io/vuejsdevelopers/how-to-publish-your-vue-js-component-on-npm-aiamf6qzi\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHow To Publish Your Vue.js Component On NPM\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://vuetiful.wordpress.com/2017/05/13/publishing-components-in-vue-js/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ePublishing Components in Vue.js\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","body":"オリジナルのコンポーネントライブラリを作って公開するまでの手順です。\n\n著者も試行錯誤しながらとりあえず公開できるところまでもっていった段階ですので、至らない点があると思います。\n不備を見つけられた方はコメントで教えてくださると幸いです。\n\n完成品は[こちら](https://github.com/isuke/my-components-sample)です。\n\n# 前提\n\n`node`はもちろん、`yarn`も使いますので入れておいてください。\n`yarn`を使わない方は適宜、`npm`で読み替えてください。\n\n# コンポーネントを作る\n\nまずはディレクリを作って、\n\n```shell-session\n$ mkdir my-components-sample\n$ cd my-components-sample\n```\n`yarn init`して`package.json`を作ります。\n`private`を`false`にするのがポイントです。`true`だと公開できないですからね。\n`main`は後で書き換えるので適当でいいです。\n\n```shell-session\n$ yarn init      \nyarn init v1.3.2\nquestion name (my-components-sample): \nquestion version (1.0.0): \nquestion description: My Component Sample\nquestion entry point (index.js): \nquestion repository url: \nquestion author: \nquestion license (MIT): \nquestion private: false\nsuccess Saved package.json\n✨  Done in 35.73s.\n```\n\nvue.jsを入れます。\n\n```shell-session\n$ yarn add vue\n```\n\n適当に２つコンポーネントを作ります。\n\n```shell-session\n$ mkdir -p src/components\n```\n\n```html:src/components/Foo.vue\n\u003ctemplate\u003e\n  \u003cdiv class=\"foo\"\u003e\n    Hello Foo {{msg}}\n  \u003c/div\u003e\n\u003c/template\u003e\n\n\u003cscript\u003e\nexport default {\n  props: {\n    msg: {\n      type: String,\n      required: true,\n    }\n  }\n}\n\u003c/script\u003e\n\n\u003cstyle\u003e\n.foo {\n  color: blue;\n}\n\u003c/style\u003e\n```\n\n```html:src/components/Bar.vue\n\u003ctemplate\u003e\n  \u003cdiv class=\"bar\"\u003e\n    Hello Bar {{msg}}\n  \u003c/div\u003e\n\u003c/template\u003e\n\n\u003cscript\u003e\nexport default {\n  props: {\n    msg: {\n      type: String,\n      required: true,\n    }\n  }\n}\n\u003c/script\u003e\n\n\u003cstyle\u003e\n.bar {\n  color: red;\n}\n\u003c/style\u003e\n```\n\n# webpack設定\n\nwebpackを設定していきます。\n必要なものをまるっと追加してしましましょう。\n\n```diff:package.json\n  {\n    \"name\": \"my-components-sample\",\n    \"version\": \"1.0.0\",\n    \"description\": \"My Component Sample\",\n    \"main\": \"index.js\",\n    \"license\": \"MIT\",\n    \"private\": false,\n    \"dependencies\": {\n      \"vue\": \"^2.5.9\"\n-   }\n+   },\n+   \"devDependencies\": {\n+     \"autoprefixer\": \"^7.1.4\",\n+     \"babel-core\": \"^6.26.0\",\n+     \"babel-loader\": \"^7.1.2\",\n+     \"babel-preset-env\": \"^1.6.0\",\n+     \"clean-webpack-plugin\": \"^0.1.17\",\n+     \"cross-env\": \"^5.1.1\",\n+     \"css-loader\": \"^0.28.7\",\n+     \"style-loader\": \"^0.18.2\",\n+     \"vue-loader\": \"^12.1.0\",\n+     \"vue-template-compiler\": \"^2.3.3\",\n+     \"webpack\": \"^3.6.0\",\n+     \"webpack-merge\": \"^4.1.0\",\n+     \"webpack-node-externals\": \"^1.6.0\"\n+   }\n  }\n```\n\n```shell-session\n$ yarn install\n```\n\n```js:webpack.config.js\nconst path = require('path');\nconst webpack = require('webpack');\nconst merge = require('webpack-merge')\nconst CleanWebpackPlugin = require('clean-webpack-plugin');\n\nconst baseConfig = {\n  output: {\n    path: path.resolve(`${__dirname}/dist/`)\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.vue$/,\n        use: {\n          loader: 'vue-loader',\n        }\n      }\n    ]\n  },\n  resolve: {\n    extensions: ['.vue', '.js'],\n    alias: {\n      '@src': path.resolve(__dirname, 'src'),\n      '@components': path.resolve(__dirname, 'src', 'components'),\n      'vue$': 'vue/dist/vue.esm.js'\n    }\n  },\n  externals: {\n    'vue': 'Vue'\n  },\n  plugins: [\n    new webpack.ProvidePlugin({\n      'Vue': 'vue'\n    })\n  ]\n};\n\nlet config;\nif (process.env.NODE_ENV === 'production') {\n  const productionConfig = merge(baseConfig, {\n    plugins: [\n      new CleanWebpackPlugin(['dist']),\n      new webpack.optimize.UglifyJsPlugin({\n        minimize: true,\n        sourceMap: true,\n        mangle: true,\n        compress: {\n          warnings: false\n        }\n      }),\n      new webpack.LoaderOptionsPlugin({\n        minimize: true\n      })\n    ],\n    devtool: '#source-map'\n  });\n  config = productionConfig // TODO\n} else {\n  console.error(`\\`${process.env.NODE_ENV}\\` is not defined.`);\n}\n\nmodule.exports = config;\n```\n\nこの状態ではまだ`output`もちゃんと指定していないし、エンドポイントもないのでコンパイルできません。\n次に進みましょう。\n\n# 公開する\n## CDNで公開する\n\nまずはCDNで公開できるようにします。\nCDN用のエンドポイントを作成します。\n\n```src/plugins.js\nmodule.exports = {\n  install: function(Vue, options) {\n    Vue.component('foo', require('@components/Foo'));\n    Vue.component('bar', require('@components/Bar'));\n  }\n};\n```\n\nこれをエンドポイントとしたwebpackの設定を書いていきます。\n\n```diff:webpack.config.js\n- config = productionConfig // TODO\n+ config = [\n+   merge(productionConfig,\n+   {\n+     entry: path.resolve(__dirname + '/src/plugin.js'),\n+     output: {\n+       filename: 'my-components-sample.min.js',\n+       libraryTarget: 'window',\n+       library: 'MyComponentsSample'\n+     }\n+   })\n+ ];\n```\n\n`libraryTarget: 'window'`, `library: 'MyComponentsSample'`を設定することで、ブラウザで`my-components-sample.min.js`を読み込んだときに`window.MyComponentsSample`で使えるようになります。\n\npackage.jsonに下記を追加します。\n\n```diff:package.json\n  {\n    ...\n+   \"scripts\": {\n+     \"build\": \"cross-env NODE_ENV=production webpack --progress --hide-modules\"\n+   },\n    ...\n  }\n```\n\nすかさずビルド！\n\n```shell-session\n$ yarn run build\n```\n\n`dist/my-components-sample.min.js`と`dist/my-components-sample.min.js.map`ができていればOKです。\n\nこれらのファイルをCDNで公開するわけですが、これは[jsDelivr](https://www.jsdelivr.com/)を使うと超がつくほど簡単です。\n\nまずは、`packge.json`に以下を追加します。\n\n```diff:packge.json\n  {\n    ...\n    \"main\": \"index.js\",\n+   \"cdn\": \"dist/my-components-sample.min.js\",\n    ...\n  }\n```\n\n`main`は後で使うので書き換えません。\n\n次に、今まで作ったコードをGitHubで公開しましょう。\n\n```shell-session\n$ git init\n```\n\n```text:.gitignroe\nnode_modules/\nnpm-debug.log\nyarn-error.log\n```\n\n`dist`ディレクトリを`.gitignore`に入れないように注意です。\n`dist`は公開しないといけないですからね。\n\n```shell-session\n$ git add -A\n$ git commit -m \"Initial commit\"\n```\n\n**GitHubのリポジトリを作成する部分は省略します。**\n\n```shell-session\n$ git remote add origin git@github.com:you/my-components-sample.git\n$ git push -u origin master\n```\n\nタグも付けてあげます。\n\n```shell-session\n$ git tag v1.0.0\n$ git push origin v1.0.0\n\n```\n\nなんと、これだけでCDNでの公開ができてしまっています。\n実際にjsbinで確認してみましょう。\n\nhttp://jsbin.com/yufohim/edit?html,js,output\n\nやりました。ちゃんと動いています。\n(vue.js 2.0.3ではなぜかエラーになって動かなかったので最新バージョンのvue.jsを使っています。)\n\n## NPMで公開する\n\n次に、NPMで公開します。\nNPM用のエンドポイントを作成します。\n\n```js:src/index.js\nimport MyFoo from '@components/Foo';\nimport MyBar from '@components/Bar';\n\nexport const VERSION = '1.0.0';\n\nexport const Foo = MyFoo;\nexport const Bar = MyBar;\n```\n\nこれをエンドポイントとしたwebpackの設定を書いていきます。\n\n```diff:webpack.config.js\n  config = [\n    merge(productionConfig,\n    {\n      entry: path.resolve(__dirname + '/src/plugin.js'),\n      output: {\n        filename: 'my-components-sample.min.js',\n        libraryTarget: 'window',\n        library: 'MyComponentsSample'\n      }\n-   })\n+   }),\n+   merge(productionConfig,\n+   {\n+     entry: path.resolve(__dirname + '/src/index.js'),\n+     output: {\n+       filename: 'my-components-sample.js',\n+       libraryTarget: 'umd',\n+       library: 'MyComponentsSample',\n+       umdNamedDefine: true\n+     }\n+   }),\n  ];\n```\n\n`yarn run build`を実行して`dist/my-components-sample.js`と`dist/my-components-sample.js.map`ができていればOKです。\n\nあとは`package.json`を書き換えます。\n\n```diff:package.json\n- \"main\": \"index.js\",\n+ \"main\": \"dist/my-components-sample.js\",\n```\n\nあとは、npm に push するだけです。\n\n**npmのアカウント作成部分は省略します。**\n\n**npmを汚さないために今回は実際にはpushしません。**\n\n```shell-session\n$ yarn publish\n```\n\nうまく行っていれば、以下のようにして使うことができるはずです。\n\n```shell-session\n$ yarn add my-components-sample\n```\n\n```html:hoge.vue\n\u003cscript\u003e\nimport * as My from 'my-components-sample'\n\nexport default = {\n  components: {\n    'my-foo': My.Foo\n  }\n};\n\u003c/script\u003e\n```\n\n# 落ち穂拾い\n## デプロイを楽にする\n\nデプロイ手順は以下のようになります。\n\n1. `package.json`と`index.js`のバージョン書き換え\n2. `yarn run deploy`\n3. `git add -A \u0026\u0026 git commit -m 'hogehoge'`\n4. `git tag v1.x.x \u0026\u0026 git push origin v1.x.x`\n5. `yarn publish`\n\n毎回これをやるのは面倒なので半自動化しましょう。\n\n`deploy.sh`を作ります(著者はshellが苦手なのでソースが汚いのは勘弁)。\n\n```bash:deploy.sh\nGEEEN=\"\\e[0;32m\"\nRED=\"\\e[0;31m\"\nRESET=\"\\e[0m\"\nVERSION=$1\n\n# Check version format\nif [[ $VERSION =~ ^[0-9]+\\.[0-9]+\\.[0-9]+$ ]] ; then\n  printf \"${GEEEN}Deploy version v$VERSION\\n${RESET}\"\nelse\n  printf \"${RED}VERSION format is 'x.x.x'. ($VERSION)\\n${RESET}\"\n  exit 1\nfi\n\n# Check existing tag\ngit tag | grep v$VERSION \u003e /dev/null\nif [ $? -eq 0 ]; then\n  printf \"${RED}git tag 'v$VERSION' is existing\\n${RESET}\"\n  exit 1\nfi\n\nprintf \"${GEEEN}Rewite src/index.js\\n${RESET}\"\ngsed -r -i \"s/VERSION = '[0-9]+\\.[0-9]+\\.[0-9]+'/VERSION = '$VERSION'/g\" src/index.js\ngit add src/index.js\n\nprintf \"${GEEEN}Rewite package.json\\n${RESET}\"\ngsed -r -i \"s/\\\"version\\\": \\\"[0-9]+\\.[0-9]+\\.[0-9]+\\\"/\\\"version\\\": \\\"$VERSION\\\"/g\" package.json\ngit add package.json\n\nprintf \"${GEEEN}Build\\n${RESET}\"\nyarn run build\ngit add dist\n\nprintf \"${GEEEN}git commit\\n${RESET}\"\ngit commit -m \"Upgrade to v$VERSION\"\ngit tag v$VERSION\n\nprintf \"${GEEEN}Please command 'git push origin master \u0026\u0026 git push origin v$VERSION \u0026\u0026 yarn publish'\\n${RESET}\"\n```\n\n実行権限をつけるのを忘れずに。\n\n```shell-session\n$ chmod 774 deploy.sh\n```\n\nこれを実行するためにはmacの場合`gnu-sed`が必要です。\n\n```shell-session\n$ brew install coreutils\n$ brew install gnu-sed\n```\n\nLinuxの場合は`gsed`を`sed`に置き換えればいいと思います(たぶん)。\n\n`package.json`にdelpoyコマンドを追加してあげましょう。\n\n```diff:package.json\n  \"scripts\": {\n    \"build\": \"cross-env NODE_ENV=production webpack --progress --hide-modules\",\n+   \"deploy\": \"./deploy.sh\"\n  },\n```\n\nあとは、`yarn run deploy 1.0.0`などと実行すれば、最後のpushの直前までやってくれます。\n\n## ドキュメントを書く\n\nせっかく、ライブラリを公開したのですから使ってもらうようにドキュメントを書くといいでしょう。\nvue.jsのコンポーネントのドキュメントを書くのには[propdoc](https://github.com/propellant/doctor)を使うのが良さそうです。\n\npropdoc用にコンポーネントを加筆しましょう。\n\n```diff:Foo.vue\n  \u003cscript\u003e\n  export default {\n+   name: \"Foo\",\n+   introduction: \"displaoy message.\",\n+   description: `\n+     This is amazing component.\n+   `,\n+   token: \"\u003cfoo msg='ALL OK'\u003e\u003c/foo\u003e\",\n    props: {\n      msg: {\n        type: String,\n        required: true,\n+       note: 'message'\n      }\n    }\n  };\n  \u003c/script\u003e\n```\n\nこれは以下のように使います。\n\n```html:ComponentDoc.vue\n\u003ctemplate\u003e\n  \u003cdiv class=\"component-doc\"\u003e\n    \u003carticle v-for=\"doc in docs\"\u003e\n      \u003ch1\u003e{{doc.name}}\u003c/h1\u003e\n      \u003ch2\u003e{{doc.introduction}}\u003c/h2\u003e\n    \u003c/article\u003e\n  \u003c/div\u003e\n\u003c/template\u003e\n\n\u003cscript\u003e\n  import propDoc from 'propdoc'\n  import * as My from 'my-components-sample'\n\nexport default {\n  data: -\u003e\n    docs: [\n      propDoc.getDoc(My.Foo),\n      propDoc.getDoc(My.Bar),\n    ]\n}\n\u003c/script\u003e\n```\n\nもっと詳しく知りたい人は[公式](https://github.com/propellant/doctor)を確認して見てください。\n\n# まとめ\n\nコンポーネントライブラリを作るのは結構かんたんなのでみんさんもオレオレライブラリを作って公開しましょう。\n著者も[Rhoa](https://github.com/isuke/rhoa)というライブラリを作っています。楽しいです。\n\n# 参考\n\n- [How To Publish Your Vue.js Component On NPM](https://www.codementor.io/vuejsdevelopers/how-to-publish-your-vue-js-component-on-npm-aiamf6qzi)\n- [Publishing Components in Vue.js](https://vuetiful.wordpress.com/2017/05/13/publishing-components-in-vue-js/)\n","coediting":false,"comments_count":0,"created_at":"2017-12-03T21:26:52+09:00","group":null,"id":"6f293d02286cf9836811","likes_count":37,"private":false,"reactions_count":0,"tags":[{"name":"JavaScript","versions":[]},{"name":"npm","versions":[]},{"name":"Vue.js","versions":[]}],"title":"[Vue.js] オリジナルコンポーネントライブラリを作って公開しよう!","updated_at":"2017-12-13T16:56:05+09:00","url":"https://qiita.com/isuke/items/6f293d02286cf9836811","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ccode\u003eputs \"hoge\"\u003c/code\u003eと\u003ccode\u003eprint \"hoge\\n\"\u003c/code\u003eは普通、同じ動きをしますが、マルチスレッドのときは少し違うようです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e# ruby 2.4.1p111\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eTHREAD_NUM\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eTHREAD_NUM\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etimes\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"hoge\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"ss\"\u003e:join\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"-\"\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eTHREAD_NUM\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eThread\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etimes\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"hoge\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eeach\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"ss\"\u003e:join\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれを実行すると\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e[] % ruby sample.rb\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhogehoge\n\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\n-----\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eputs\u003c/code\u003eはスレッドセーフでは無いようで、文字列を出力したあと、改行する前に別のスレッドが割り込んでしまうことがあります。\u003c/p\u003e\n\n\u003cp\u003eあんまりないと思いますが、rubyでマルチスレッドコードを書くときはお気をつけて。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e追記\u003c/h2\u003e\n\n\u003cp\u003eruby 2.5.0 では再現しないっぽいです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"20180604-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20180604-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2018/06/04 追記\u003c/h2\u003e\n\n\u003cp\u003estackoverflowにて、密かに尊敬する \u003ca href=\"/raccy\" class=\"user-mention js-hovercard\" title=\"raccy\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"raccy\"\u003e@raccy\u003c/a\u003e さんから\u003ca href=\"https://ja.stackoverflow.com/questions/44288/ruby%e3%81%ae%e7%b5%84%e3%81%bf%e8%be%bc%e3%81%bf%e3%83%a1%e3%82%bd%e3%83%83%e3%83%89%e3%81%8c%e3%82%b9%e3%83%ac%e3%83%83%e3%83%89%e3%82%bb%e3%83%bc%e3%83%95%e3%81%8b%e5%90%a6%e3%81%8b%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6\" rel=\"nofollow noopener\" target=\"_blank\"\u003e詳しい解説\u003c/a\u003eを頂きました。\u003cbr\u003e\nこの場を借りて感謝を申し上げます。\u003c/p\u003e\n","body":"`puts \"hoge\"`と`print \"hoge\\n\"`は普通、同じ動きをしますが、マルチスレッドのときは少し違うようです。\n\n```rb\n# ruby 2.4.1p111\n\nTHREAD_NUM = 3\n\nArray.new(THREAD_NUM) do\n  Thread.new do\n    10.times do\n      puts \"hoge\"\n    end\n  end\nend.each(\u0026:join)\n\nputs \"-\"*5\n\nArray.new(THREAD_NUM) do\n  Thread.new do\n    10.times do\n      print \"hoge\\n\"\n    end\n  end\nend.each(\u0026:join)\n```\n\nこれを実行すると\n\n```\n[] % ruby sample.rb\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhogehoge\n\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\n-----\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\nhoge\n```\n\n`puts`はスレッドセーフでは無いようで、文字列を出力したあと、改行する前に別のスレッドが割り込んでしまうことがあります。\n\nあんまりないと思いますが、rubyでマルチスレッドコードを書くときはお気をつけて。\n\n## 追記\n\nruby 2.5.0 では再現しないっぽいです。\n\n## 2018/06/04 追記\n\nstackoverflowにて、密かに尊敬する @raccy さんから[詳しい解説](https://ja.stackoverflow.com/questions/44288/ruby%e3%81%ae%e7%b5%84%e3%81%bf%e8%be%bc%e3%81%bf%e3%83%a1%e3%82%bd%e3%83%83%e3%83%89%e3%81%8c%e3%82%b9%e3%83%ac%e3%83%83%e3%83%89%e3%82%bb%e3%83%bc%e3%83%95%e3%81%8b%e5%90%a6%e3%81%8b%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6)を頂きました。\nこの場を借りて感謝を申し上げます。\n\n","coediting":false,"comments_count":1,"created_at":"2017-11-22T14:15:34+09:00","group":null,"id":"a3579261a17658a7c7f7","likes_count":5,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]}],"title":"puts \"hoge\" と print \"hoge\\n\" のちょっとした違い","updated_at":"2018-06-04T12:22:14+09:00","url":"https://qiita.com/isuke/items/a3579261a17658a7c7f7","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eSinatra+Vue.jsでSPAを作っていきます。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/isuke/items/6df8ab9bea944b23f65d\" id=\"reference-5bb9888c7b7d38424366\"\u003e以前の記事\u003c/a\u003eで「webpack-dev-serverのproxy使えば?」とコメント頂きましたので、それを受けて全面的に書き直しました。(Thank you \u003ca href=\"/nak1114\" class=\"user-mention js-hovercard\" title=\"nak1114\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"nak1114\"\u003e@nak1114\u003c/a\u003e)\u003c/p\u003e\n\n\u003cp\u003e完成したコードは\u003ca href=\"https://github.com/isuke/sinatra-vuejs-template/tree/v1.0.0\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eで見ることができます。 \u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"フロントエンドの準備\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E3%81%AE%E6%BA%96%E5%82%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eフロントエンドの準備\u003c/h2\u003e\n\n\u003cp\u003eyarnを使うので、インストールしていない人はインストールしてください。\u003c/p\u003e\n\n\u003cp\u003evue-cliを使うのでインストールします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn global add vue-cli\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003evue templateを使います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003evue init isuke/vuejs-template#v1.0.0 sinatara-vue-sample\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eisuke/vuejs-template\u003c/code\u003eは著者が、公式の\u003ccode\u003evuejs-templates/webpack-simple\u003c/code\u003eをもとに作ったvue.jsのテンプレートです。\u003cbr\u003e\n大分改造してあるので原型がおぼろげです。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003evue init\u003c/code\u003eしたら指示に従って以下のコマンド実行します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e\n\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn run dev\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"http://localhost:8080/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://localhost:8080/\u003c/a\u003e をブラウザで開いてみましょう(といか勝手に開きます)。\u003cbr\u003e\n一行もコードを書かずにこれだけでwebページができていることがわかると思います。\u003cbr\u003e\n[Bye]リンクをクリックしてページ遷移ができていることも確認してみてください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"サーバーサイドの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%82%B5%E3%82%A4%E3%83%89%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサーバーサイドの作成\u003c/h2\u003e\n\n\u003cp\u003eここからsinatraを使っていきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebundle init\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGemfile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e# frozen_string_literal: true\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"https://rubygems.org\"\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eruby\u003c/span\u003e \u003cspan class=\"s1\"\u003e'2.4.1'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra'\u003c/span\u003e\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra-contrib'\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e \u003cspan class=\"nt\"\u003e--path\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003evendor/bundle\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003esinatraのコードを書いていきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eserver.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra/base'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"sinatra/reloader\"\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eServer\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eSinatra\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBase\u003c/span\u003e\n  \u003cspan class=\"n\"\u003econfigure\u003c/span\u003e \u003cspan class=\"ss\"\u003e:development\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eregister\u003c/span\u003e \u003cspan class=\"no\"\u003eSinatra\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eReloader\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s1\"\u003e'/companies.json'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecompanies\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n    \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eupto\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e50\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecompanies\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"ss\"\u003eid: \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Company \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecompanies\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_json\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003econfig.ru\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'./server'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"no\"\u003eServer\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e何の変哲もない　APIが一つあるだけです。\u003c/p\u003e\n\n\u003cp\u003e立ち上げて、確認してみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003erackup\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"http://localhost:9292/companies.json\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://localhost:9292/companies.json\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ejsonが返ってきました。\u003cbr\u003e\n次のステップに進みましょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"フロントとサーバーの連携\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%81%A8%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AE%E9%80%A3%E6%90%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eフロントとサーバーの連携\u003c/h1\u003e\n\n\u003cp\u003eフロントは\u003ccode\u003enpm run dev\u003c/code\u003eでlocalhost:8080\u003cbr\u003e\nサーバーは\u003ccode\u003ebundle exec rackup\u003c/code\u003eでlocalhost:9292\u003cbr\u003e\nにそれぞれアクセスできるようになりました。\u003cbr\u003e\nこれをくっつけましょう。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ewebpack.config.cofffee\u003c/code\u003eに以下の行を追加します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.cofffee\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  else\n    config = merge baseConfig,\n      output:\n        filename: 'build.js'\n      devtool: '#eval-source-map'\n      devServer:\n        contentBase: 'dist'\n        historyApiFallback: true\n        noInfo: true\n\u003cspan class=\"gi\"\u003e+       proxy:\n+         \"/api\":\n+           target: \"http://localhost:9292\"\n+           pathRewrite: {\"^/api\" : \"\"}\n\u003c/span\u003e      performance:\n        hints: false\n\n  module.exports = config\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eサーバーを２つとも立ち上げて \u003ca href=\"http://localhost:8080\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://localhost:8080\u003c/a\u003e を見てみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003erackup\n\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn dev\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eここでトップページが見れたらOKです。\u003cbr\u003e\nさて、これでフロントからAPIが叩けるようになったので、ちょっと試してみましょう。\u003c/p\u003e\n\n\u003cp\u003eBye.vueを以下のように書き換えます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u003c/span\u003e \u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"pug\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n.bye\n  button(@click=\"load\") load\n  ul(v-for=\"company in companies\")\n    li {{company.name}}\n  router-link(:to=\"{ name: 'top'}\") TOP\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"coffee\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ecompanies\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003eaxios\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e/api/companies.json\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ethen\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponce\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e@\u003c/span\u003e\u003cspan class=\"nd\"\u003ecompanies\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eresponce\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e[load]ボタンをおしてデータが表示されればOKです。\u003c/p\u003e\n\n\u003cp\u003eついでにHot Module Replacementが動作しているかもためしてみましょう。\u003c/p\u003e\n\n\u003cp\u003eCompnayデータが表示された状態で\u003ccode\u003eBye.vue\u003c/code\u003eのstyleを適当に変えてみてください。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  .bye\n    -webkit-font-smoothing: antialiased\n    -moz-osx-font-smoothing: grayscale\n    text-align: center\n    margin-top: 60px\n\u003cspan class=\"gi\"\u003e+   background-color: red\n\u003c/span\u003e\n    h1\n      font-weight: normal\n    a\n      color: #42b983\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eブラウザを\u003cstrong\u003e更新せずに\u003c/strong\u003e反映されたら成功です。\u003cbr\u003e\nHot Module Replacementが動作しています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"productionモードで動かす\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#production%E3%83%A2%E3%83%BC%E3%83%89%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eProductionモードで動かす\u003c/h2\u003e\n\n\u003cp\u003e最後にProductionでの動かし方です。\u003c/p\u003e\n\n\u003cp\u003eまず\u003ccode\u003eyarn run build\u003c/code\u003eを実行して\u003ccode\u003esrc\u003c/code\u003eディレクトリの中をコンパイルします。\u003cbr\u003e\nコンパイルした結果は\u003ccode\u003edist\u003c/code\u003eに吐かれます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn run build\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e次に、静的ファイル配信用のサーバーを作ります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003estatic.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra/base'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eStatic\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eSinatra\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBase\u003c/span\u003e\n  \u003cspan class=\"n\"\u003econfigure\u003c/span\u003e \u003cspan class=\"ss\"\u003e:production\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eset\u003c/span\u003e \u003cspan class=\"ss\"\u003e:public_dir\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eroot\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'dist'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s1\"\u003e'/'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003esend_file\u003c/span\u003e \u003cspan class=\"no\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ejoin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003esettings\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003epublic_dir\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'index.html'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003edist\u003c/code\u003eディレクリをpublicとして公開するディレクトリに指定しています。\u003cbr\u003e\nまた、\u003ccode\u003e/\u003c/code\u003eにアクセスしたときに、'dist/index.html'を返しています。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003estatic.rb\u003c/code\u003eを使うように\u003ccode\u003econfig.ru\u003c/code\u003eを改良しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecofig.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gi\"\u003e+ require './static'\n\u003c/span\u003e  require './server'\n\n+ if ENV[\"APP_ENV\"] == \"production\"\n\u003cspan class=\"gi\"\u003e+   run Rack::URLMap.new(\n+     '/' =\u0026gt; Static,\n+     '/api' =\u0026gt; Server,\n+   )\n+ else\n\u003c/span\u003e    run Server\n\u003cspan class=\"gi\"\u003e+ end\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eあとは環境変数をつけて実行してあげるだけです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003eAPP_ENV\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eproduction bundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003erackup \n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e以上です。お疲れ様でした。\u003c/p\u003e\n","body":"Sinatra+Vue.jsでSPAを作っていきます。\n\n[以前の記事](https://qiita.com/isuke/items/6df8ab9bea944b23f65d)で「webpack-dev-serverのproxy使えば?」とコメント頂きましたので、それを受けて全面的に書き直しました。(Thank you @nak1114)\n\n完成したコードは[こちら](https://github.com/isuke/sinatra-vuejs-template/tree/v1.0.0)で見ることができます。 \n\n## フロントエンドの準備\n\nyarnを使うので、インストールしていない人はインストールしてください。\n\nvue-cliを使うのでインストールします。\n\n```shell-session\n$ yarn global add vue-cli\n```\nvue templateを使います。\n\n```shell-session\n$ vue init isuke/vuejs-template#v1.0.0 sinatara-vue-sample\n```\n\n`isuke/vuejs-template`は著者が、公式の`vuejs-templates/webpack-simple`をもとに作ったvue.jsのテンプレートです。\n大分改造してあるので原型がおぼろげです。\n\n`vue init`したら指示に従って以下のコマンド実行します。\n\n```shell-session\n$ yarn install\n$ yarn run dev\n```\n\nhttp://localhost:8080/ をブラウザで開いてみましょう(といか勝手に開きます)。\n一行もコードを書かずにこれだけでwebページができていることがわかると思います。\n[Bye]リンクをクリックしてページ遷移ができていることも確認してみてください。\n\n## サーバーサイドの作成\n\nここからsinatraを使っていきます。\n\n```shell-session\n$ bundle init\n```\n\n```rb:Gemfile\n# frozen_string_literal: true\n\nsource \"https://rubygems.org\"\n\nruby '2.4.1'\n\ngem 'sinatra'\ngem 'sinatra-contrib'\n```\n\n```shell-session\n$ bundle install --path=vendor/bundle\n```\n\nsinatraのコードを書いていきます。\n\n```rb:server.rb\nrequire 'sinatra/base'\nrequire \"sinatra/reloader\"\n\nclass Server \u003c Sinatra::Base\n  configure :development do\n    register Sinatra::Reloader\n  end\n\n  get '/companies.json' do\n    companies = []\n    1.upto(50) do |i|\n      companies \u003c\u003c {\n        id: i,\n        name: \"Company #{i}\"\n      }\n    end\n    companies.to_json\n  end\nend\n```\n\n```rb:config.ru\nrequire './server'\n\nrun Server\n```\n\n何の変哲もない　APIが一つあるだけです。\n\n立ち上げて、確認してみましょう。\n\n```shell-session\n$ bundle exec rackup\n```\n\nhttp://localhost:9292/companies.json\n\njsonが返ってきました。\n次のステップに進みましょう。\n\n# フロントとサーバーの連携\n\nフロントは`npm run dev`でlocalhost:8080\nサーバーは`bundle exec rackup`でlocalhost:9292\nにそれぞれアクセスできるようになりました。\nこれをくっつけましょう。\n\n`webpack.config.cofffee`に以下の行を追加します。\n\n```diff:webpack.config.cofffee\n  else\n    config = merge baseConfig,\n      output:\n        filename: 'build.js'\n      devtool: '#eval-source-map'\n      devServer:\n        contentBase: 'dist'\n        historyApiFallback: true\n        noInfo: true\n+       proxy:\n+         \"/api\":\n+           target: \"http://localhost:9292\"\n+           pathRewrite: {\"^/api\" : \"\"}\n      performance:\n        hints: false\n\n  module.exports = config\n```\n\nサーバーを２つとも立ち上げて http://localhost:8080 を見てみましょう。\n\n```shell-session\n$ bundle exec rackup\n$ yarn dev\n```\n\nここでトップページが見れたらOKです。\nさて、これでフロントからAPIが叩けるようになったので、ちょっと試してみましょう。\n\nBye.vueを以下のように書き換えます。\n\n```html\n\u003ctemplate lang=\"pug\"\u003e\n.bye\n  button(@click=\"load\") load\n  ul(v-for=\"company in companies\")\n    li {{company.name}}\n  router-link(:to=\"{ name: 'top'}\") TOP\n\u003c/template\u003e\n\n\u003cscript lang=\"coffee\"\u003e\nexport default\n  data: -\u003e\n    companies: []\n  methods:\n    load: -\u003e\n      axios.get('/api/companies.json')\n        .then (responce) =\u003e\n          @companies = responce.data\n\u003c/script\u003e\n```\n\n[load]ボタンをおしてデータが表示されればOKです。\n\nついでにHot Module Replacementが動作しているかもためしてみましょう。\n\nCompnayデータが表示された状態で`Bye.vue`のstyleを適当に変えてみてください。\n\n```diff\n  .bye\n    -webkit-font-smoothing: antialiased\n    -moz-osx-font-smoothing: grayscale\n    text-align: center\n    margin-top: 60px\n+   background-color: red\n\n    h1\n      font-weight: normal\n    a\n      color: #42b983\n```\n\nブラウザを**更新せずに**反映されたら成功です。\nHot Module Replacementが動作しています。\n\n## Productionモードで動かす\n\n最後にProductionでの動かし方です。\n\nまず`yarn run build`を実行して`src`ディレクトリの中をコンパイルします。\nコンパイルした結果は`dist`に吐かれます。\n\n```shell-session\n$ yarn run build\n```\n\n次に、静的ファイル配信用のサーバーを作ります。\n\n```rb:static.rb\nrequire 'sinatra/base'\n\nclass Static \u003c Sinatra::Base\n  configure :production do\n    set :public_dir, File.join(settings.root, 'dist')\n  end\n\n  get '/' do\n    send_file File.join(settings.public_dir, 'index.html')\n  end\nend\n```\n\n`dist`ディレクリをpublicとして公開するディレクトリに指定しています。\nまた、`/`にアクセスしたときに、'dist/index.html'を返しています。\n\n`static.rb`を使うように`config.ru`を改良しましょう。\n\n```diff:cofig.rb\n+ require './static'\n  require './server'\n\n+ if ENV[\"APP_ENV\"] == \"production\"\n+   run Rack::URLMap.new(\n+     '/' =\u003e Static,\n+     '/api' =\u003e Server,\n+   )\n+ else\n    run Server\n+ end\n```\n\nあとは環境変数をつけて実行してあげるだけです。\n\n```shell-session\n$ APP_ENV=production bundle exec rackup \n```\n\n以上です。お疲れ様でした。\n","coediting":false,"comments_count":0,"created_at":"2017-11-05T19:15:33+09:00","group":null,"id":"1f72878455303c5736ba","likes_count":6,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"Sinatra","versions":[]},{"name":"SPA","versions":[]},{"name":"Vue.js","versions":[]},{"name":"webpack","versions":[]}],"title":"Sinatra+Vue.jsでSPA(Hot Module Replacementつき) Take 2","updated_at":"2018-03-23T22:10:53+09:00","url":"https://qiita.com/isuke/items/1f72878455303c5736ba","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eとうとう待望のcoffeescript2が正式にリリースされました。\u003cbr\u003e\n早速使ってみましょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"coffeescript2のインストール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#coffeescript2%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ecoffeescript2のインストール\u003c/h2\u003e\n\n\u003cp\u003e普通にインストールすればいいです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn add \u003cspan class=\"nt\"\u003e-D\u003c/span\u003e coffeescript\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e注意点としては2.0になった段階で\u003ccode\u003ecoffee-script\u003c/code\u003eから\u003ccode\u003ecoffeescript\u003c/code\u003eに名前が変わったことです。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ecoffee-script\u003c/code\u003eを既にインストールしていた場合は削除しておきましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn remove coffee-script\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003ecoffee-loaderも0.8.0からcoffeescript2に対応しているので、すでに入っている場合はupgradeします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn upgrade coffee-loader\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eなければインストール\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn add \u003cspan class=\"nt\"\u003e-D\u003c/span\u003e coffee-loader\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"babelのインストール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#babel%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ebabelのインストール\u003c/h2\u003e\n\n\u003cp\u003ecoffeescriptをupgradeするだけならこれで終わりなのですが、coffeescript2はes2015にコンパイルされるため、古いブラウザで動かすためにはbabel等で更にコンパイルする必要があります。\u003c/p\u003e\n\n\u003cp\u003ebabelをインストールしましょう。\u003cbr\u003e\nおそらくこれが最小構成です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn add \u003cspan class=\"nt\"\u003e-D\u003c/span\u003e babel-core babel-loader babel-preset-es2015\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e.babelrc\u003c/code\u003eをプロジェクトのルートディレクトリに置きます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"json\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.babelrc\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"w\"\u003e\n  \u003c/span\u003e\u003cspan class=\"nl\"\u003e\"presets\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"es2015\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003ewebpackを書き換えて、babelを通してあげます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffee\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.coffee\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\\.coffee$/\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'babel-loader!coffee-loader'\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e以上で終了！\u003cbr\u003e\nおめでとう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"vue-loaderの設定\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#vue-loader%E3%81%AE%E8%A8%AD%E5%AE%9A\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003evue-loaderの設定\u003c/h2\u003e\n\n\u003cp\u003eここから先はvue-loaderを使う場合だけの設定です。\u003c/p\u003e\n\n\u003cp\u003ewebpack.configのvue-loaderの部分を書き換えてあげます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.coffee\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\\.vue$/\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'vue-loader'\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eloaders\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecoffee\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'babel-loader!coffee-loader'\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e上記の設定の場合vueファイルのlangを省略せずに書く必要があります。\u003cbr\u003e\n(langはsublimeなどでハイライトするのに有用な情報なので省略しないのが吉)\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ehoge.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- langを省略しない --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"coffee\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eHoge\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれでちゃんとコンパイルされるはずです。\u003cbr\u003e\nお疲れ様でした！\u003c/p\u003e\n","body":"とうとう待望のcoffeescript2が正式にリリースされました。\n早速使ってみましょう。\n\n## coffeescript2のインストール\n\n普通にインストールすればいいです。\n\n```shell-session\n$ yarn add -D coffeescript\n```\n\n注意点としては2.0になった段階で`coffee-script`から`coffeescript`に名前が変わったことです。\n\n`coffee-script`を既にインストールしていた場合は削除しておきましょう。\n\n```shell-session\n$ yarn remove coffee-script\n```\n\ncoffee-loaderも0.8.0からcoffeescript2に対応しているので、すでに入っている場合はupgradeします。\n\n```shell-session\n$ yarn upgrade coffee-loader\n```\n\nなければインストール\n\n```shell-session\n$ yarn add -D coffee-loader\n```\n\n\n## babelのインストール\n\ncoffeescriptをupgradeするだけならこれで終わりなのですが、coffeescript2はes2015にコンパイルされるため、古いブラウザで動かすためにはbabel等で更にコンパイルする必要があります。\n\nbabelをインストールしましょう。\nおそらくこれが最小構成です。\n\n```shell-session\n$ yarn add -D babel-core babel-loader babel-preset-es2015\n```\n\n`.babelrc`をプロジェクトのルートディレクトリに置きます。\n\n```json:.babelrc\n{\n  \"presets\": [\"es2015\"]\n}\n```\n\nwebpackを書き換えて、babelを通してあげます。\n\n```coffee:webpack.config.coffee\n      {\n        test: /\\.coffee$/\n        loader: 'babel-loader!coffee-loader'\n      }\n```\n\n以上で終了！\nおめでとう。\n\n## vue-loaderの設定\n\nここから先はvue-loaderを使う場合だけの設定です。\n\nwebpack.configのvue-loaderの部分を書き換えてあげます。\n\n```coffeescript:webpack.config.coffee\n      {\n        test: /\\.vue$/\n        loader: 'vue-loader'\n        options:\n          loaders:\n            coffee: 'babel-loader!coffee-loader'\n      }\n```\n\n上記の設定の場合vueファイルのlangを省略せずに書く必要があります。\n(langはsublimeなどでハイライトするのに有用な情報なので省略しないのが吉)\n\n```html:hoge.vue\n\u003c!-- langを省略しない --\u003e\n\u003cscript lang=\"coffee\"\u003e\nmodule.exports = {\n  name: 'Hoge'\n}\n\u003c/script\u003e\n```\n\nこれでちゃんとコンパイルされるはずです。\nお疲れ様でした！\n","coediting":false,"comments_count":0,"created_at":"2017-09-21T20:54:53+09:00","group":null,"id":"9b3b78da29c7658f7e11","likes_count":5,"private":false,"reactions_count":0,"tags":[{"name":"CoffeeScript","versions":[]},{"name":"Vue.js","versions":[]},{"name":"webpack","versions":[]},{"name":"babel","versions":[]},{"name":"CoffeeScript2","versions":[]}],"title":"webpackでcoffeescript2を使おう(vueもあるよ)","updated_at":"2017-09-22T00:24:45+09:00","url":"https://qiita.com/isuke/items/9b3b78da29c7658f7e11","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\n\u003ch1\u003e\n\u003cspan id=\"序章\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%BA%8F%E7%AB%A0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e序章\u003c/h1\u003e\n\n\u003cp\u003e管理可能で拡張性のあるCSSを構築するために、先人たちは数々のCSS設計や命名規約を生み出しました。\u003cbr\u003e\nOOCSS、SMACSS、BEM、SuitCSS...\u003cbr\u003e\nそしてそれらの考えを統合したFLOCSSが登場しました。\u003cbr\u003e\nFLOCSSは強力なツールです。\u003cbr\u003e\nしかし、悲しいことに強力すぎて誰も使いこなすことができなかったのです。\u003cbr\u003e\n「これってComponentとProjectどっちだ?適当でいいか」\u003cbr\u003e\n「最初に作った人はFLOCSSを理解していたかもしれないが、あとから保守した人が理解していなくてめちゃくちゃになった」\u003cbr\u003e\n「サーバーエンジニアなのに急にフロントを書かないといけなくなった。FLOCSS? 覚えること多すぎて無理！」\u003c/p\u003e\n\n\u003cp\u003eこの状況から脱出するための新しい技術が生まれました。\u003cbr\u003e\n単一ファイルコンポーネントです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"単一ファイルコンポーネントって\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8D%98%E4%B8%80%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%81%A3%E3%81%A6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e単一ファイルコンポーネントって?\u003c/h1\u003e\n\n\u003cp\u003eこういうやつです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eHello.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;p\u0026gt;\u003c/span\u003e{{ greeting }} World!\u003cspan class=\"nt\"\u003e\u0026lt;/p\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;script\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003egreeting\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eHello\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;style\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003ep\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003efont-size\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e2em\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003etext-align\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003ecenter\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/style\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eようは、template(html)、script(js), style(css)を一つのファイルにまとめて、それを使いまわそうということです。\u003c/p\u003e\n\n\u003cp\u003eこれの何が嬉しいのかは\u003ca href=\"https://jp.vuejs.org/v2/guide/single-file-components.html#%E9%96%A2%E5%BF%83%E3%81%AE%E5%88%86%E9%9B%A2%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\" rel=\"nofollow noopener\" target=\"_blank\"\u003evueの公式\u003c/a\u003eから引用させていただきます。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e注意すべき重要な点の1つは、関心事項の分離がファイルタイプの分離と等しくないことです。 現代の UI 開発では、コードベースを互いに織り交ぜる3つの巨大なレイヤーに分割するのではなく、それらを疎結合なコンポーネントに分割して構成する方がはるかに理にかなっています。コンポーネントの内部では、そのテンプレート、ロジック、スタイルが本質的に結合されており、実際にそれらを配置することで、コンポーネントがより一貫性と保守性に優れています。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e名前が長いので以下、単一ファイルコンポーネントはSFC(Single File Components)と呼びます。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"sfcってどうやったら使えるの\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#sfc%E3%81%A3%E3%81%A6%E3%81%A9%E3%81%86%E3%82%84%E3%81%A3%E3%81%9F%E3%82%89%E4%BD%BF%E3%81%88%E3%82%8B%E3%81%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSFCってどうやったら使えるの?\u003c/h1\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"vuejs\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#vuejs\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003evue.js\u003c/h2\u003e\n\n\u003cp\u003evue.jsを使ったプロジェクトであれば\u003ccode\u003evue-loader\u003c/code\u003eを使えばすぐに使い始めることができます。\u003cbr\u003e\n詳しくは\u003ca href=\"https://jp.vuejs.org/v2/guide/single-file-components.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式\u003c/a\u003eを参照してください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"riotjs\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#riotjs\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eRiot.js\u003c/h2\u003e\n\n\u003cp\u003eRiotはSFCが前提なっているため、普通に使っていけば自然にSFCになるはずです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"react\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#react\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eReact\u003c/h2\u003e\n\n\u003cp\u003eTODO\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"フレームワークなし\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%83%AF%E3%83%BC%E3%82%AF%E3%81%AA%E3%81%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eフレームワークなし\u003c/h2\u003e\n\n\u003cp\u003eこちら(\u003ca href=\"https://github.com/nicholaslee119/webpack-component-loader\" rel=\"nofollow noopener\" target=\"_blank\"\u003ewebpack-component-loader\u003c/a\u003e)が使えそうです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"新しいsfc-css設計その名はkaom仮\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%B0%E3%81%97%E3%81%84sfc-css%E8%A8%AD%E8%A8%88%E3%81%9D%E3%81%AE%E5%90%8D%E3%81%AFkaom%E4%BB%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e新しいSFC CSS設計、その名は\u003cstrong\u003eKaom(仮)\u003c/strong\u003e\n\u003c/h1\u003e\n\n\u003cp\u003eこれから説明するSFC CSS設計を\u003cstrong\u003eKaom(仮)\u003c/strong\u003eと名付けます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"スタイル言語の選択\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E8%A8%80%E8%AA%9E%E3%81%AE%E9%81%B8%E6%8A%9E\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eスタイル言語の選択\u003c/h2\u003e\n\n\u003cp\u003e\u003cstrong\u003eKaom(仮)\u003c/strong\u003eにはmixin機能と変数機能、import機能が必須です。\u003cbr\u003e\nなのでスタイル言語にはこれらの機能があるものを選択しましょう。\u003cbr\u003e\n逆に言えばこれら機能があればlessでもsassでもstylusでもなんでもいいです。\u003cbr\u003e\npost-cssを駆使してもOKです。\u003cbr\u003e\n(指定ディレクトリの中をまとめてimportする機能があるstylusがややオススメ。)\u003cbr\u003e\n以下はstylusのコードで説明していきます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ディレクトリ構成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E6%A7%8B%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eディレクトリ構成\u003c/h2\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003esrc/\n├ components/\n│├ TOP.vue\n│└ ...\n├ styles/\n│├ bases/\n││├ _body.styl\n││└ ...\n│├ mixins/\n││├ _card.styl\n││└ ...\n│├ _bases.styl\n│├ _mixins.styl\n│└ _variables.styl\n└─ main.js\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"components\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#components\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ecomponents\u003c/h3\u003e\n\n\u003cp\u003eコンポーネントを配置します。\u003cbr\u003e\nコンポーネント内のstyleをどのように書くかは後述。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"styles\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#styles\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003estyles\u003c/h3\u003e\n\n\u003cp\u003eスタイルシートを配置します。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"bases\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#bases\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ebases\u003c/h4\u003e\n\n\u003cp\u003eサイト全体の設定を行います。\u003cbr\u003e\nここではhtmlタグや属性を指定してスタイルを記述していきます。\u003cbr\u003e\nクラスやIDを指定してはいけません。\u003c/p\u003e\n\n\u003cp\u003e例えば以下のように書きます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"stylus\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e_lists.styl\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003eul, ol\n  list-style-type: none\n  margin: 0\n  padding: 0\n\ndl\n  margin-bottom: $small-spacing\n\n  dt\n    font-weight: bold\n    margin-top: $small-spacing\n  dd\n    margin: 0\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/thoughtbot/bitters\" rel=\"nofollow noopener\" target=\"_blank\"\u003ebitters\u003c/a\u003eというCSSがあるので、こちらを参考にするといいと思います。\u003cbr\u003e\nそのままコピーしてきてもいいかも。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"mixins\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#mixins\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003emixins\u003c/h4\u003e\n\n\u003cp\u003e再利用したいスタイルをmixinで定義します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"stylus\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e_shadow.styl\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003eshadow(depth = 1)\n  if      depth == 1\n    box-shadow: 0  2px  5px 0 rgba(0, 0, 0, .16), 0  2px 10px 0 rgba(0, 0, 0, .12)\n  else if depth == 2\n    box-shadow: 0  8px 17px 0 rgba(0, 0, 0,  .2), 0  6px 20px 0 rgba(0, 0, 0, .19)\n  else if depth == 3\n    box-shadow: 0 12px 15px 0 rgba(0, 0, 0, .24), 0 17px 50px 0 rgba(0, 0, 0, .19)\n  else if depth == 4\n    box-shadow: 0 16px 28px 0 rgba(0, 0, 0, .22), 0 25px 55px 0 rgba(0, 0, 0, .21)\n  else if depth == 5\n    box-shadow: 0 27px 24px 0 rgba(0, 0, 0,  .2), 0 40px 77px 0 rgba(0, 0, 0, .22)\n  else\n    box-shadow: none\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"_basesstyl\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#_basesstyl\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e_bases.styl\u003c/h4\u003e\n\n\u003cp\u003ebasesディレクトリの中を読み込見ます。\u003cbr\u003e\nstylusの場合、2行だけ、以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"stylus\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e_bases.styl\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e@import './_variables.styl'\n@import './bases/*'\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"_mixinsstyl\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#_mixinsstyl\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e_mixins.styl\u003c/h4\u003e\n\n\u003cp\u003emixinsディレクトリの中を読み込見ます。\u003cbr\u003e\nstylusの場合、2行だけ、以下のようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"stylus\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e_bases.styl\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e@import './_variables.styl'\n@import './mixins/*'\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e_basesと同じですね。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"_variablesstyl\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#_variablesstyl\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e_variables.styl\u003c/h4\u003e\n\n\u003cp\u003eサイト全体で使用する変数を定義していきます。\u003cbr\u003e\nこちらも\u003ca href=\"https://github.com/thoughtbot/bitters\" rel=\"nofollow noopener\" target=\"_blank\"\u003ebitters\u003c/a\u003eを参考にするとどんなことを書くのかわかると思います。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"mainjs\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#mainjs\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003emain.js\u003c/h4\u003e\n\n\u003cp\u003eエンドポイントとなるファイルです。\u003cbr\u003e\n次の章で詳しく説明します。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"質問-utilityはどこに置くの\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%B3%AA%E5%95%8F-utility%E3%81%AF%E3%81%A9%E3%81%93%E3%81%AB%E7%BD%AE%E3%81%8F%E3%81%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e質問: Utilityはどこに置くの?\u003c/h4\u003e\n\n\u003cp\u003e答え: Utilityを作ってはいけません。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e.mbs { margin-bottom: 10px; }\u003c/code\u003eのような汎用クラスはHTML内にスタイル情報を持ち込む悪しき習慣です。\u003cbr\u003e\n詳しくは\u003ca href=\"http://qiita.com/isuke/items/e132669d54523c934b96\" id=\"reference-924c9d05c8ab403eca90\"\u003eこちら(お前ら今すぐそのCSSフレームワーク使うのやめろ!)\u003c/a\u003eに書きました。\u003c/p\u003e\n\n\u003cp\u003e再利用したいスタイルはmixinを使いましょう。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"各ファイルの読み込み方法\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%90%84%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E6%96%B9%E6%B3%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e各ファイルの読み込み方法\u003c/h2\u003e\n\n\u003cp\u003ewebpackを使った場合の各ファイルの読み込み方法です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003emain.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e// styles\u003c/span\u003e\n\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003enormalize.css\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 必要な場合\u003c/span\u003e\n\u003cspan class=\"k\"\u003eimport\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e./styles/_bases.styl\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eエンドポイントなる\u003ccode\u003emain.js\u003c/code\u003eでは\u003ccode\u003enormalize.css\u003c/code\u003eなどのリセットCSSと先程説明した\u003ccode\u003e_bases.styl\u003c/code\u003eのみ読み込みます。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e_variables.styl\u003c/code\u003eや\u003ccode\u003e_mixins.styl\u003c/code\u003eは以下のようにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffee\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.coffee\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e# webpack 2.0\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003epath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'path'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'webpack'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eentry\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'./src/main.js'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epath\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'./dist'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epublicPath\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'/dist/'\u003c/span\u003e\n    \u003cspan class=\"na\"\u003efilename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'build.js'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emodule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003erules\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\\.vue$/\u003c/span\u003e\n        \u003cspan class=\"na\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'vue-loader'\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eloaders\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n              \u003cspan class=\"na\"\u003estylus\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'style-loader'\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'css-loader'\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'stylus-loader'\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003esourceMap\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003etrue\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'stylus-resources-loader'\u003c/span\u003e\n                  \u003cspan class=\"na\"\u003eoptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n                    \u003cspan class=\"na\"\u003eresources\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n                      \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'./src/styles/_variables.styl'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                      \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e'./src/styles/_mixins.styl'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこうすることですべてのコンポーネントから\u003ccode\u003e@import\u003c/code\u003eの記述無しで変数とmixinが使えるようになります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"コンポーネントの記述\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%98%E8%BF%B0\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコンポーネントの記述\u003c/h2\u003e\n\n\u003cp\u003e著者の宗教上の理由により\u003cbr\u003e\n- framework: vue.js\u003cbr\u003e\n- template : pug\u003cbr\u003e\n- script : CoffeeScript2\u003cbr\u003e\n- style : stylus\u003cbr\u003e\nをつかって説明させていただきます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"スタイルガイド\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%AC%E3%82%A4%E3%83%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eスタイルガイド\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/pablohpsilva/vuejs-component-style-guide/blob/master/README-JP.md\" rel=\"nofollow noopener\" target=\"_blank\"\u003eVue.js コンポーネント スタイル ガイド\u003c/a\u003eを全面的に採用します。\u003cbr\u003e\nRiotの場合は\u003ca href=\"https://github.com/voorhoede/riotjs-style-guide\" rel=\"nofollow noopener\" target=\"_blank\"\u003eRiotJS Style Guide\u003c/a\u003eを参照してください。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ファイル名\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%90%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファイル名\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/pablohpsilva/vuejs-component-style-guide/blob/master/README-JP.md\" rel=\"nofollow noopener\" target=\"_blank\"\u003eVue.js コンポーネント スタイル ガイド\u003c/a\u003eに従い、2または3語で命名します。\u003cbr\u003e\nそれをUpperCamelCaseでファイル名にします。例) \u003ccode\u003eUserList.vue\u003c/code\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"コンポーネント内のテンプレートとスタイル\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E5%86%85%E3%81%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%A8%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコンポーネント内のテンプレートとスタイル\u003c/h3\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"css-命名規約\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#css-%E5%91%BD%E5%90%8D%E8%A6%8F%E7%B4%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCSS 命名規約\u003c/h4\u003e\n\n\u003cp\u003e命名の一貫性を保つために命名規約を導入しましょう。\u003cbr\u003e\n命名規約は色々有りますが、どれを使えばいいでしょうか?\u003c/p\u003e\n\n\u003cp\u003e単一ファイルコンポーネントでは、コンポーネントごとにスタイルが独立しているので名前の衝突の危険はありません。\u003cbr\u003e\nこの危険を回避するための意味合いが強いBEMなどは不要です。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://rscss.io/index.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003erscss\u003c/a\u003eがわかりやすく、大げさでなく、使いやすいのでおすすめです。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"kaoms-primacy仮\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#kaoms-primacy%E4%BB%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cstrong\u003eKaom's Primacy(仮)\u003c/strong\u003e\n\u003c/h4\u003e\n\n\u003cp\u003e上で「単一ファイルコンポーネントでは、コンポーネントごとにスタイルが独立しているので名前の衝突の危険はありません。」と言いました。\u003cbr\u003e\nこれは\u003ccode\u003escoped\u003c/code\u003eオプションによる力です。\u003cbr\u003e\nどのような力かこちら\u003ca href=\"https://vue-loader.vuejs.org/ja/features/scoped-css.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003evue-loader\u003c/a\u003eから引用して説明します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u003c/span\u003e \u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"pug\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  .example hi\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;style \u003c/span\u003e\u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"styl\"\u003c/span\u003e \u003cspan class=\"na\"\u003escoped\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nc\"\u003e.example\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003ecolor\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nt\"\u003ered\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/style\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれをコンパイルするとこうなります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"example\"\u003c/span\u003e \u003cspan class=\"na\"\u003edata-v-f3f3eg9\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003ehi\u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;style\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nc\"\u003e.example\u003c/span\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"nt\"\u003edata-v-f3f3eg9\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003ecolor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003ered\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/style\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eここで追加された\u003ccode\u003edata-v-f3f3eg9\u003c/code\u003eという文字列はコンポーネントごとに固有のものです。\u003cbr\u003e\nつまり、ランダムな文字列を付与することによって、別のコンポーネントへ影響を与えることを防いでいるのです。\u003c/p\u003e\n\n\u003cp\u003eこのように自動的にセレクターにランダムな文字列を付与することでスタイルの漏れを防ぐことを\u003cstrong\u003eKaom's Primacy(仮)\u003c/strong\u003eと呼ぶことにします。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"kaoms-roots仮\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#kaoms-roots%E4%BB%AE\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003cstrong\u003eKaom's Roots(仮)\u003c/strong\u003e\n\u003c/h4\u003e\n\n\u003cp\u003etemplateはコンポーネント名と同じ名前(dash-case)のクラスで全体を囲みましょう。\u003cbr\u003e\nこのクラスを持ったタグを\u003cstrong\u003eKaom's Roots(仮)\u003c/strong\u003eと呼ぶことにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eUserList.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u0026lt;template lang=\"pug\"\u0026gt;\n.user-list //- \u0026lt;- これがKaom's Roots(仮)\n h1 hello\n\u0026lt;/template\u0026gt;\n\n\u0026lt;style lang=\"styl\" scoped\u0026gt;\n.user-list\n  background-color: $theme-color;\n\u0026lt;/style\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e以下のように\u003cstrong\u003eKaom's Roots(仮)\u003c/strong\u003eが複数あるのはNGです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eUserList.vue_NGパターン\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u003c/span\u003e \u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"pug\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n.user-list1\n  h1 hello\n.user-list2\n  h1 goodbye\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eKaom's Roots(仮)\u003c/strong\u003eは\u003ccode\u003ediv\u003c/code\u003eである必要はありません。\u003cbr\u003e\n以下のように\u003ccode\u003eheader\u003c/code\u003e, \u003ccode\u003efooter\u003c/code\u003e, \u003ccode\u003emain\u003c/code\u003e, \u003ccode\u003eform\u003c/code\u003e, \u003ccode\u003eul\u003c/code\u003eなどを自由に使ってください。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eMainHeader.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u003c/span\u003e \u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"pug\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\nheader.main-header\n  h1 hello\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;style \u003c/span\u003e\u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"styl\"\u003c/span\u003e \u003cspan class=\"na\"\u003escoped\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nc\"\u003e.main-header\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"nt\"\u003etheme-color\u003c/span\u003e\u003cspan class=\"o\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/style\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eTo be continued...\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"see-also\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#see-also\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eSee also\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita.com/isuke/items/3572e3b1c3677961f127\" id=\"reference-00676406c18b84e37b3e\"\u003eVue.js命名規則、命名のコツ\u003c/a\u003e\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"todo\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#todo\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eTODO\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cinput type=\"checkbox\" class=\"task-list-item-checkbox\" disabled\u003e説明加筆\n\n\u003cul\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cinput type=\"checkbox\" class=\"task-list-item-checkbox\" disabled\u003e各フレームワークでのSFCの実装方法について\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cinput type=\"checkbox\" class=\"task-list-item-checkbox\" disabled\u003eマジックナンバーの使用について\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cinput type=\"checkbox\" class=\"task-list-item-checkbox\" disabled\u003e用語の統一\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cinput type=\"checkbox\" class=\"task-list-item-checkbox\" disabled\u003e例の追加\u003c/li\u003e\n\u003cli class=\"task-list-item\"\u003e\n\u003cinput type=\"checkbox\" class=\"task-list-item-checkbox\" disabled\u003e名前をつける(必要なら)\u003c/li\u003e\n\u003c/ul\u003e\n","body":"# 序章\n\n管理可能で拡張性のあるCSSを構築するために、先人たちは数々のCSS設計や命名規約を生み出しました。\nOOCSS、SMACSS、BEM、SuitCSS...\nそしてそれらの考えを統合したFLOCSSが登場しました。\nFLOCSSは強力なツールです。\nしかし、悲しいことに強力すぎて誰も使いこなすことができなかったのです。\n「これってComponentとProjectどっちだ?適当でいいか」\n「最初に作った人はFLOCSSを理解していたかもしれないが、あとから保守した人が理解していなくてめちゃくちゃになった」\n「サーバーエンジニアなのに急にフロントを書かないといけなくなった。FLOCSS? 覚えること多すぎて無理！」\n\nこの状況から脱出するための新しい技術が生まれました。\n単一ファイルコンポーネントです。\n\n# 単一ファイルコンポーネントって?\n\nこういうやつです。\n\n```html:Hello.vue\n\u003ctemplate\u003e\n  \u003cp\u003e{{ greeting }} World!\u003c/p\u003e\n\u003c/template\u003e\n\n\u003cscript\u003e\nmodule.export = {\n  data: function() {\n    return {\n      greeting: 'Hello'\n    }\n  }\n}\n\u003c/script\u003e\n\n\u003cstyle\u003e\np {\n  font-size: 2em;\n  text-align: center;\n}\n\u003c/style\u003e\n```\n\nようは、template(html)、script(js), style(css)を一つのファイルにまとめて、それを使いまわそうということです。\n\nこれの何が嬉しいのかは[vueの公式](https://jp.vuejs.org/v2/guide/single-file-components.html#関心の分離について)から引用させていただきます。\n\n\u003e 注意すべき重要な点の1つは、関心事項の分離がファイルタイプの分離と等しくないことです。 現代の UI 開発では、コードベースを互いに織り交ぜる3つの巨大なレイヤーに分割するのではなく、それらを疎結合なコンポーネントに分割して構成する方がはるかに理にかなっています。コンポーネントの内部では、そのテンプレート、ロジック、スタイルが本質的に結合されており、実際にそれらを配置することで、コンポーネントがより一貫性と保守性に優れています。\n\n名前が長いので以下、単一ファイルコンポーネントはSFC(Single File Components)と呼びます。\n\n# SFCってどうやったら使えるの?\n\n## vue.js\n\nvue.jsを使ったプロジェクトであれば`vue-loader`を使えばすぐに使い始めることができます。\n詳しくは[公式](https://jp.vuejs.org/v2/guide/single-file-components.html)を参照してください。\n\n## Riot.js\n\nRiotはSFCが前提なっているため、普通に使っていけば自然にSFCになるはずです。\n\n## React\n\nTODO\n\n## フレームワークなし\n\nこちら([webpack-component-loader](https://github.com/nicholaslee119/webpack-component-loader))が使えそうです。\n\n# 新しいSFC CSS設計、その名は**Kaom(仮)**\n\nこれから説明するSFC CSS設計を**Kaom(仮)**と名付けます。\n\n## スタイル言語の選択\n\n**Kaom(仮)**にはmixin機能と変数機能、import機能が必須です。\nなのでスタイル言語にはこれらの機能があるものを選択しましょう。\n逆に言えばこれら機能があればlessでもsassでもstylusでもなんでもいいです。\npost-cssを駆使してもOKです。\n(指定ディレクトリの中をまとめてimportする機能があるstylusがややオススメ。)\n以下はstylusのコードで説明していきます。\n\n## ディレクトリ構成\n\n```\nsrc/\n├ components/\n│├ TOP.vue\n│└ ...\n├ styles/\n│├ bases/\n││├ _body.styl\n││└ ...\n│├ mixins/\n││├ _card.styl\n││└ ...\n│├ _bases.styl\n│├ _mixins.styl\n│└ _variables.styl\n└─ main.js\n```\n\n### components\n\nコンポーネントを配置します。\nコンポーネント内のstyleをどのように書くかは後述。\n\n### styles\n\nスタイルシートを配置します。\n\n#### bases\n\nサイト全体の設定を行います。\nここではhtmlタグや属性を指定してスタイルを記述していきます。\nクラスやIDを指定してはいけません。\n\n例えば以下のように書きます。\n\n```stylus:_lists.styl\nul, ol\n  list-style-type: none\n  margin: 0\n  padding: 0\n\ndl\n  margin-bottom: $small-spacing\n\n  dt\n    font-weight: bold\n    margin-top: $small-spacing\n  dd\n    margin: 0\n```\n\n[bitters](https://github.com/thoughtbot/bitters)というCSSがあるので、こちらを参考にするといいと思います。\nそのままコピーしてきてもいいかも。\n\n\n#### mixins\n\n再利用したいスタイルをmixinで定義します。\n\n```stylus:_shadow.styl\nshadow(depth = 1)\n  if      depth == 1\n    box-shadow: 0  2px  5px 0 rgba(0, 0, 0, .16), 0  2px 10px 0 rgba(0, 0, 0, .12)\n  else if depth == 2\n    box-shadow: 0  8px 17px 0 rgba(0, 0, 0,  .2), 0  6px 20px 0 rgba(0, 0, 0, .19)\n  else if depth == 3\n    box-shadow: 0 12px 15px 0 rgba(0, 0, 0, .24), 0 17px 50px 0 rgba(0, 0, 0, .19)\n  else if depth == 4\n    box-shadow: 0 16px 28px 0 rgba(0, 0, 0, .22), 0 25px 55px 0 rgba(0, 0, 0, .21)\n  else if depth == 5\n    box-shadow: 0 27px 24px 0 rgba(0, 0, 0,  .2), 0 40px 77px 0 rgba(0, 0, 0, .22)\n  else\n    box-shadow: none\n```\n\n#### _bases.styl\n\nbasesディレクトリの中を読み込見ます。\nstylusの場合、2行だけ、以下のようになります。\n\n```stylus:_bases.styl\n@import './_variables.styl'\n@import './bases/*'\n```\n\n#### _mixins.styl\n\nmixinsディレクトリの中を読み込見ます。\nstylusの場合、2行だけ、以下のようになります。\n\n```stylus:_bases.styl\n@import './_variables.styl'\n@import './mixins/*'\n```\n\n_basesと同じですね。\n\n#### _variables.styl\n\nサイト全体で使用する変数を定義していきます。\nこちらも[bitters](https://github.com/thoughtbot/bitters)を参考にするとどんなことを書くのかわかると思います。\n\n#### main.js\n\nエンドポイントとなるファイルです。\n次の章で詳しく説明します。\n\n#### 質問: Utilityはどこに置くの?\n\n答え: Utilityを作ってはいけません。\n\n`.mbs { margin-bottom: 10px; }`のような汎用クラスはHTML内にスタイル情報を持ち込む悪しき習慣です。\n詳しくは[こちら(お前ら今すぐそのCSSフレームワーク使うのやめろ!)](http://qiita.com/isuke/items/e132669d54523c934b96)に書きました。\n\n再利用したいスタイルはmixinを使いましょう。\n\n## 各ファイルの読み込み方法\n\nwebpackを使った場合の各ファイルの読み込み方法です。\n\n```js:main.js\n//\n// styles\n//\nimport 'normalize.css'; // 必要な場合\nimport './styles/_bases.styl';\n```\n\nエンドポイントなる`main.js`では`normalize.css`などのリセットCSSと先程説明した`_bases.styl`のみ読み込みます。\n\n`_variables.styl`や`_mixins.styl`は以下のようにします。\n\n```coffee:webpack.config.coffee\n# webpack 2.0\n\npath = require('path')\nwebpack = require('webpack')\n\nmodule.exports =\n  entry: './src/main.js'\n  output:\n    path: path.resolve(__dirname, './dist')\n    publicPath: '/dist/'\n    filename: 'build.js'\n  module:\n    rules: [\n      {\n        test: /\\.vue$/\n        use:\n          loader: 'vue-loader'\n          options:\n            loaders:\n              stylus: [\n                {\n                  loader: 'style-loader'\n                  options: sourceMap: true\n                }\n                {\n                  loader: 'css-loader'\n                  options: sourceMap: true\n                }\n                {\n                  loader: 'stylus-loader'\n                  options: sourceMap: true\n                }\n                {\n                  loader: 'stylus-resources-loader'\n                  options:\n                    resources: [\n                      path.resolve(__dirname, './src/styles/_variables.styl')\n                      path.resolve(__dirname, './src/styles/_mixins.styl')\n                    ]\n                }\n              ]\n      }\n```\n\nこうすることですべてのコンポーネントから`@import`の記述無しで変数とmixinが使えるようになります。\n\n## コンポーネントの記述\n\n著者の宗教上の理由により\n- framework: vue.js\n- template : pug\n- script : CoffeeScript2\n- style : stylus\nをつかって説明させていただきます。\n\n### スタイルガイド\n\n[Vue.js コンポーネント スタイル ガイド](https://github.com/pablohpsilva/vuejs-component-style-guide/blob/master/README-JP.md)を全面的に採用します。\nRiotの場合は[RiotJS Style Guide](https://github.com/voorhoede/riotjs-style-guide)を参照してください。\n\n### ファイル名\n\n[Vue.js コンポーネント スタイル ガイド](https://github.com/pablohpsilva/vuejs-component-style-guide/blob/master/README-JP.md)に従い、2または3語で命名します。\nそれをUpperCamelCaseでファイル名にします。例) `UserList.vue`\n\n### コンポーネント内のテンプレートとスタイル\n#### CSS 命名規約\n\n命名の一貫性を保つために命名規約を導入しましょう。\n命名規約は色々有りますが、どれを使えばいいでしょうか?\n\n単一ファイルコンポーネントでは、コンポーネントごとにスタイルが独立しているので名前の衝突の危険はありません。\nこの危険を回避するための意味合いが強いBEMなどは不要です。\n\n[rscss](http://rscss.io/index.html)がわかりやすく、大げさでなく、使いやすいのでおすすめです。\n\n#### **Kaom's Primacy(仮)**\n\n上で「単一ファイルコンポーネントでは、コンポーネントごとにスタイルが独立しているので名前の衝突の危険はありません。」と言いました。\nこれは`scoped`オプションによる力です。\nどのような力かこちら[vue-loader](https://vue-loader.vuejs.org/ja/features/scoped-css.html)から引用して説明します。\n\n```html\n\u003ctemplate lang=\"pug\"\u003e\n  .example hi\n\u003c/template\u003e\n\n\u003cstyle lang=\"styl\" scoped\u003e\n.example\n  color: red\n\u003c/style\u003e\n```\n\nこれをコンパイルするとこうなります。\n\n```html\n\u003ctemplate\u003e\n  \u003cdiv class=\"example\" data-v-f3f3eg9\u003ehi\u003c/div\u003e\n\u003c/template\u003e\n\n\u003cstyle\u003e\n.example[data-v-f3f3eg9] {\n  color: red;\n}\n\u003c/style\u003e\n```\n\nここで追加された`data-v-f3f3eg9`という文字列はコンポーネントごとに固有のものです。\nつまり、ランダムな文字列を付与することによって、別のコンポーネントへ影響を与えることを防いでいるのです。\n\nこのように自動的にセレクターにランダムな文字列を付与することでスタイルの漏れを防ぐことを**Kaom's Primacy(仮)**と呼ぶことにします。\n\n#### **Kaom's Roots(仮)**\n\ntemplateはコンポーネント名と同じ名前(dash-case)のクラスで全体を囲みましょう。\nこのクラスを持ったタグを**Kaom's Roots(仮)**と呼ぶことにします。\n\n```:UserList.vue\n\u003ctemplate lang=\"pug\"\u003e\n.user-list //- \u003c- これがKaom's Roots(仮)\n h1 hello\n\u003c/template\u003e\n\n\u003cstyle lang=\"styl\" scoped\u003e\n.user-list\n  background-color: $theme-color;\n\u003c/style\u003e\n```\n\n以下のように**Kaom's Roots(仮)**が複数あるのはNGです。\n\n```html:UserList.vue_NGパターン\n\u003ctemplate lang=\"pug\"\u003e\n.user-list1\n  h1 hello\n.user-list2\n  h1 goodbye\n\u003c/template\u003e\n```\n\n**Kaom's Roots(仮)**は`div`である必要はありません。\n以下のように`header`, `footer`, `main`, `form`, `ul`などを自由に使ってください。\n\n```html:MainHeader.vue\n\u003ctemplate lang=\"pug\"\u003e\nheader.main-header\n  h1 hello\n\u003c/template\u003e\n\n\u003cstyle lang=\"styl\" scoped\u003e\n.main-header\n  background-color: $theme-color;\n\u003c/style\u003e\n```\n\n\n\n**To be continued...**\n\n# See also\n\n[Vue.js命名規則、命名のコツ](https://qiita.com/isuke/items/3572e3b1c3677961f127)\n\n---\n\n# TODO\n\n- [ ] 説明加筆\n  - [ ] 各フレームワークでのSFCの実装方法について\n  - [ ] マジックナンバーの使用について\n- [ ] 用語の統一\n- [ ] 例の追加\n- [ ] 名前をつける(必要なら)\n","coediting":false,"comments_count":0,"created_at":"2017-09-08T17:22:04+09:00","group":null,"id":"4345074cc646dbdeb42d","likes_count":23,"private":false,"reactions_count":0,"tags":[{"name":"CSS","versions":[]},{"name":"Sass","versions":[]},{"name":"stylus","versions":[]},{"name":"Vue.js","versions":[]},{"name":"CSS設計","versions":[]}],"title":"[WIP] もうFLOCSSで消耗するのはやめよう！単一ファイルコンポーネント時代の新しいCSS設計","updated_at":"2017-10-27T17:14:23+09:00","url":"https://qiita.com/isuke/items/4345074cc646dbdeb42d","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ca href=\"https://github.com/pablohpsilva/vuejs-component-style-guide/blob/master/README-JP.md\" rel=\"nofollow noopener\" target=\"_blank\"\u003eVue.js コンポーネント スタイル ガイド\u003c/a\u003e\u003cbr\u003e\nこちらがベースになっているのでまずはこれを熟読すべし!\u003cbr\u003e\n以下、引用になっているのはこのサイトからの出典です。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"20171214-追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#20171214-%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2017/12/14 追記\u003c/h1\u003e\n\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://jp.vuejs.org/v2/style-guide/index.html\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式ガイド\u003c/a\u003eがもうすぐBetaが外れるのでこちらを見たほうが良いです。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"コンポーネント名\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E5%90%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eコンポーネント名\u003c/h1\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e意味のある名前で: 具体的過ぎず、抽象的過ぎず。\u003cbr\u003e\n短く: ２または３語。\u003cbr\u003e\n発音可能: それらについて話せるようにしたい。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e例)\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eCard: 短すぎます。抽象的すぎます。\u003c/li\u003e\n\u003cli\u003eUserProfilePostErrorModal: 長すぎます。具体的すぎます。\u003c/li\u003e\n\u003cli\u003eUserList: Good\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ファイル名\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%90%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eファイル名\u003c/h2\u003e\n\n\u003cp\u003ePascalCaseにします。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003euser_list.vue: PascalCaseになっていません。\u003c/li\u003e\n\u003cli\u003eUserList.vue: Good\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"name属性\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#name%E5%B1%9E%E6%80%A7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ename属性\u003c/h2\u003e\n\n\u003cp\u003e\u003cdel\u003ename属性は必ず与えましょう。\u003c/del\u003e\u003cbr\u003e\nname属性は\u003ccode\u003e.vue\u003c/code\u003eファイル\u003cstrong\u003eでない場合は\u003c/strong\u003e必ず与えましょう。\u003cbr\u003e\n\u003ccode\u003e.vue\u003c/code\u003eファイルの場合は自動でファイル名がname属性になるため不要です。\u003c/p\u003e\n\n\u003cp\u003ePascalCaseにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e// name属性がありません。\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003ebar\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e// Good\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eUserList\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"html\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#html\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ehtml\u003c/h2\u003e\n\n\u003cp\u003ekebab-caseにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u003c/span\u003e \u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"html\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;user-list\u0026gt;\u0026lt;/user-list\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"text/javascript\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003eHoge\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ecomponents\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003euser-list\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eUserList\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eコンポーネントの登録の部分はES2015では以下のように省略して書くこともできます(Thank you \u003ca href=\"/kimama1997\" class=\"user-mention js-hovercard\" title=\"kimama1997\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"kimama1997\"\u003e@kimama1997\u003c/a\u003e)。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003eHoge\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ecomponents\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eUserList\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e{ ComponentA }\u003c/code\u003eは\u003ccode\u003e{ ComponentA: ComponentA }\u003c/code\u003eの簡略形です。\u003cbr\u003e\nそしてVueは自動でキーを\u003ccode\u003ecomponent-a\u003c/code\u003eに変換してくれます。\u003c/p\u003e\n\n\u003cp\u003e参考: \u003ca href=\"https://vue-loader.vuejs.org/ja/features/es2015.html\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://vue-loader.vuejs.org/ja/features/es2015.html\u003c/a\u003e\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"メソッド名\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E5%90%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメソッド名\u003c/h1\u003e\n\n\u003cp\u003e当然camelCaseにします。\u003cbr\u003e\n処理の内容を明確に表す名前にすること。\u003c/p\u003e\n\n\u003cp\u003eよくある間違いは\u003ccode\u003e@click\u003c/code\u003eで発火するメソッドに\u003ccode\u003eclickButton\u003c/code\u003e等とつけてしまうことです。\u003cbr\u003e\nちゃんと処理の内容(クリックすると何が起きるのか)を表すようにしましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- 何が起きるのかを表していません --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003eclick=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"clickSubmit\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eSubmit\u003cspan class=\"nt\"\u003e\u0026lt;/button\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e\u0026lt;!-- Good --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003eclick=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"postData\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eSubmit\u003cspan class=\"nt\"\u003e\u0026lt;/button\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"イベント名\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E5%90%8D\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eイベント名\u003c/h1\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eイベント名前はケバブケースにするべきです。\u003cbr\u003e\nイベント名は末尾が不定形の動詞(例 client-api-load)、または名詞(例 drive-upload-success)で終わるべきです。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eよくある間違いは\u003ccode\u003e@click\u003c/code\u003eで発火したタイミングで通知するイベントに対して\u003ccode\u003eupdate-user-list\u003c/code\u003e等と実行する内容をつけてしまうことです。\u003cbr\u003e\n何が起きたのかを表す名前をつけましょう。\u003cbr\u003e\nメソッド名をつけるときとは逆の考え方なので要注意です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$emit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eupdateButtonClick\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// kebab-caseになっていません。\u003c/span\u003e\n\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$emit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eclick-on-update-button\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 末尾が不定形の動詞で終わっていません。\u003c/span\u003e\n\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$emit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eupdate-button-click\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e// Good\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eちなみに vue.js 2.3 から使える \u003ccode\u003e.sync\u003c/code\u003e 修飾子を使う場合は少々ややこしいですが、以下のようにkebab-caseとcamelCaseを使い分けるので要注意です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;comp\u003c/span\u003e \u003cspan class=\"na\"\u003e:my-foo.sync=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"bar\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/comp\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$emit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eupdate:myFoo\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003enewValue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp data-height=\"265\" data-slug-hash=\"OjezvX\" data-default-tab=\"js,result\" data-embed-version=\"2\" class=\"codepen\"\u003eSee the Pen \u003ca href=\"https://codepen.io/isuke/pen/OjezvX/\" rel=\"nofollow noopener\" target=\"_blank\"\u003evue.js sync test\u003c/a\u003e by isuke (\u003ca href=\"https://codepen.io/isuke\" rel=\"nofollow noopener\" target=\"_blank\"\u003e@isuke\u003c/a\u003e) on \u003ca href=\"https://codepen.io\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCodePen\u003c/a\u003e.\u003c/p\u003e\n\n\u003cscript async src=\"https://production-assets.codepen.io/assets/embed/ei.js\"\u003e\u003c/script\u003e\n","body":"[Vue.js コンポーネント スタイル ガイド](https://github.com/pablohpsilva/vuejs-component-style-guide/blob/master/README-JP.md)\nこちらがベースになっているのでまずはこれを熟読すべし!\n以下、引用になっているのはこのサイトからの出典です。\n\n# 2017/12/14 追記\n\n**[公式ガイド](https://jp.vuejs.org/v2/style-guide/index.html)がもうすぐBetaが外れるのでこちらを見たほうが良いです。**\n\n# コンポーネント名\n\n\u003e 意味のある名前で: 具体的過ぎず、抽象的過ぎず。\n\u003e 短く: ２または３語。\n\u003e 発音可能: それらについて話せるようにしたい。\n\n例)\n\n- Card: 短すぎます。抽象的すぎます。\n- UserProfilePostErrorModal: 長すぎます。具体的すぎます。\n- UserList: Good\n\n## ファイル名\n\nPascalCaseにします。\n\n- user_list.vue: PascalCaseになっていません。\n- UserList.vue: Good\n\n## name属性\n\n~~name属性は必ず与えましょう。~~\nname属性は`.vue`ファイル**でない場合は**必ず与えましょう。\n`.vue`ファイルの場合は自動でファイル名がname属性になるため不要です。\n\nPascalCaseにします。\n\n```js\n// name属性がありません。\nexport default {\n  data: function() {\n    return {\n      foo: \"bar\"\n    }\n  }\n}\n\n// Good\nexport default {\n  name: 'UserList'\n}\n```\n\n## html\n\nkebab-caseにします。\n\n```html\n\u003ctemplate lang=\"html\"\u003e\n  \u003cuser-list\u003e\u003c/user-list\u003e\n\u003c/template\u003e\n\n\u003cscript type=\"text/javascript\"\u003e\nexport default {\n  name: \"Hoge\",\n  components: {\n    'user-list': UserList\n  }\n}\n\u003c/script\u003e\n```\n\nコンポーネントの登録の部分はES2015では以下のように省略して書くこともできます(Thank you @kimama1997)。\n\n```js\nexport default {\n  name: \"Hoge\",\n  components: {\n    UserList\n  }\n}\n```\n\n`{ ComponentA }`は`{ ComponentA: ComponentA }`の簡略形です。\nそしてVueは自動でキーを`component-a`に変換してくれます。\n\n参考: https://vue-loader.vuejs.org/ja/features/es2015.html\n\n# メソッド名\n\n当然camelCaseにします。\n処理の内容を明確に表す名前にすること。\n\nよくある間違いは`@click`で発火するメソッドに`clickButton`等とつけてしまうことです。\nちゃんと処理の内容(クリックすると何が起きるのか)を表すようにしましょう。\n\n```html\n\u003c!-- 何が起きるのかを表していません --\u003e\n\u003cbutton @click=\"clickSubmit\"\u003eSubmit\u003c/button\u003e\n\n\u003c!-- Good --\u003e\n\u003cbutton @click=\"postData\"\u003eSubmit\u003c/button\u003e\n```\n\n# イベント名\n\n\u003e イベント名前はケバブケースにするべきです。\n\u003e イベント名は末尾が不定形の動詞(例 client-api-load)、または名詞(例 drive-upload-success)で終わるべきです。\n\nよくある間違いは`@click`で発火したタイミングで通知するイベントに対して`update-user-list`等と実行する内容をつけてしまうことです。\n何が起きたのかを表す名前をつけましょう。\nメソッド名をつけるときとは逆の考え方なので要注意です。\n\n```js\nthis.$emit('updateButtonClick') // kebab-caseになっていません。\nthis.$emit('click-on-update-button') // 末尾が不定形の動詞で終わっていません。\nthis.$emit('update-button-click') // Good\n```\n\nちなみに vue.js 2.3 から使える `.sync` 修飾子を使う場合は少々ややこしいですが、以下のようにkebab-caseとcamelCaseを使い分けるので要注意です。\n\n```html\n\u003ccomp :my-foo.sync=\"bar\"\u003e\u003c/comp\u003e\n```\n\n```js\nthis.$emit('update:myFoo', newValue)\n```\n\n\u003cp data-height=\"265\" data-theme-id=\"0\" data-slug-hash=\"OjezvX\" data-default-tab=\"js,result\" data-user=\"isuke\" data-embed-version=\"2\" data-pen-title=\"vue.js sync test\" class=\"codepen\"\u003eSee the Pen \u003ca href=\"https://codepen.io/isuke/pen/OjezvX/\"\u003evue.js sync test\u003c/a\u003e by isuke (\u003ca href=\"https://codepen.io/isuke\"\u003e@isuke\u003c/a\u003e) on \u003ca href=\"https://codepen.io\"\u003eCodePen\u003c/a\u003e.\u003c/p\u003e\n\u003cscript async src=\"https://production-assets.codepen.io/assets/embed/ei.js\"\u003e\u003c/script\u003e\n","coediting":false,"comments_count":2,"created_at":"2017-09-07T19:41:03+09:00","group":null,"id":"3572e3b1c3677961f127","likes_count":164,"private":false,"reactions_count":0,"tags":[{"name":"JavaScript","versions":[]},{"name":"Vue.js","versions":[]}],"title":"Vue.js命名規則、命名のコツ","updated_at":"2018-09-17T18:19:47+09:00","url":"https://qiita.com/isuke/items/3572e3b1c3677961f127","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eSinatra+Vue.jsでSPAを作っていきます。\u003cbr\u003e\nSinatraやVue.jsが初めてという方は\u003cbr\u003e\n\u003ca href=\"http://qiita.com/isuke/items/6597f11bbd09cd0f5157\" id=\"reference-050eeed55ac0df0b2241\"\u003esinatra+vue+webpackで作成したアプリをHerokuで公開する(初心者向け) - Qiita\u003c/a\u003e\u003cbr\u003e\nこちらも合わせてどうぞ。\u003c/p\u003e\n\n\u003cp\u003e完成したコードは\u003ca href=\"https://github.com/isuke/sinatra-vuejs-template/tree/v0.8.0\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eで見ることができます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"フロントエンドの準備\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E3%81%AE%E6%BA%96%E5%82%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eフロントエンドの準備\u003c/h2\u003e\n\n\u003cp\u003evue-cliを使うのでインストールします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003enpm \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e \u003cspan class=\"nt\"\u003e-g\u003c/span\u003e vue-cli\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003evue templateを使います。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003evue init isuke/vuejs-template#v0.8.0 sinatara-vue-sample\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eisuke/vuejs-template\u003c/code\u003eは著者が、公式の\u003ccode\u003evuejs-templates/webpack-simple\u003c/code\u003eをもとに作ったvue.jsのテンプレートです。\u003cbr\u003e\n\u003ccode\u003evuejs-templates/webpack-simple\u003c/code\u003eとくらべて以下の違いがります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003ebabelは使わずにcoffeescriptを使う\u003c/li\u003e\n\u003cli\u003escssは使わずにstylusを使う\u003c/li\u003e\n\u003cli\u003evue-routerが入っている\u003c/li\u003e\n\u003cli\u003eaxiosが入っている\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e基本的には同じなのでbabelが使いたい方などは\u003ccode\u003evuejs-templates/webpack-simple\u003c/code\u003eを使ってもらっても大丈夫です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eyarn \u003cspan class=\"c\"\u003e# npm installでも可\u003c/span\u003e\n\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003enpm run dev\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"http://localhost:8080/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://localhost:8080/\u003c/a\u003e をブラウザで開いてみましょう。\u003cbr\u003e\n一行もコードを書かずにこれだけでwebページができていることがわかると思います。\u003cbr\u003e\n[Bye]リンクをクリックしてページ遷移ができていることも確認してみてください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"サーバーサイドの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%82%B5%E3%82%A4%E3%83%89%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eサーバーサイドの作成\u003c/h2\u003e\n\n\u003cp\u003eここからsinatraを使っていきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebundle init\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGemfile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e# frozen_string_literal: true\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"https://rubygems.org\"\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eruby\u003c/span\u003e \u003cspan class=\"s1\"\u003e'2.4.1'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'rack-proxy'\u003c/span\u003e\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra'\u003c/span\u003e\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra-contrib'\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003erack-proxy\u003c/code\u003eという見慣れないものがありますが、これは後で説明します。\u003c/p\u003e\n\n\u003cp\u003esinatraのコードを書いていきます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eserver.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra/base'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"sinatra/reloader\"\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eServer\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eSinatra\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBase\u003c/span\u003e\n  \u003cspan class=\"n\"\u003econfigure\u003c/span\u003e \u003cspan class=\"ss\"\u003e:development\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eregister\u003c/span\u003e \u003cspan class=\"no\"\u003eSinatra\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eReloader\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s1\"\u003e'/companies.json'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecompanies\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n    \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eupto\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e50\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecompanies\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"ss\"\u003eid: \u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Company \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecompanies\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_json\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003econfig.ru\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'./server'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"no\"\u003eServer\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e何の変哲もない　APIが一つあるだけです。\u003c/p\u003e\n\n\u003cp\u003e立ち上げて、確認してみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003erackup\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"http://localhost:9292/companies.json\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://localhost:9292/companies.json\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ejsonが返ってきました。\u003cbr\u003e\n次のステップに進みましょう。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"フロントとサーバーの連携\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%81%A8%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AE%E9%80%A3%E6%90%BA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eフロントとサーバーの連携\u003c/h1\u003e\n\n\u003cp\u003eフロントは\u003ccode\u003enpm run dev\u003c/code\u003eでlocalhost:8080\u003cbr\u003e\nサーバーは\u003ccode\u003ebundle exec rackup\u003c/code\u003eでlocalhost:9292\u003cbr\u003e\nにそれぞれアクセスできるようになりました。\u003cbr\u003e\nこれをくっつけましょう。\u003c/p\u003e\n\n\u003cp\u003e先程の\u003ccode\u003econfig.ru\u003c/code\u003eを\u003ccode\u003erack-proxy\u003c/code\u003eをつかって書き換えます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003econfig.ru\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'./server'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'rack-proxy'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAppProxy\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eProxy\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003erewrite_env\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e'HTTP_HOST'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e'localhost:8080'\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eenv\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eURLMap\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n \u003cspan class=\"s1\"\u003e'/api'\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"no\"\u003eServer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e'/'\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"no\"\u003eAppProxy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eサーバーを２つとも立ち上げてlocalhost:9292を見てみましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003enpm run dev\n\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ebundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003erackup\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca href=\"http://localhost:9292/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://localhost:9292/\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eここでトップページが見れたらOKです。\u003cbr\u003e\nなぜlocalhost:9292でトップページが見れたのかというと、先程の\u003ccode\u003econfig.ru\u003c/code\u003eの設定によりlocalhost:9292がlocalhost:8080にマップされたからですね。\u003c/p\u003e\n\n\u003cp\u003eさて、これでフロントからAPIが叩けるようになったので、ちょっと試してみましょう。\u003c/p\u003e\n\n\u003cp\u003eBye.vueを以下のように書き換えます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eBye.vue\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;template\u003c/span\u003e \u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"pug\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n.bye\n  button(@click=\"load\") load\n  ul(v-for=\"company in companies\")\n    li {{company.name}}\n  router-link(:to=\"{ name: 'top'}\") TOP\n\u003cspan class=\"nt\"\u003e\u0026lt;/template\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;script \u003c/span\u003e\u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"coffee\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ebye\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ecompanies\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emethods\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eload\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003eaxios\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"kd\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e/api/companies.json\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ethen\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponce\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e@\u003c/span\u003e\u003cspan class=\"nd\"\u003ecompanies\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eresponce\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edata\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/script\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;style \u003c/span\u003e\u003cspan class=\"na\"\u003elang=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"stylus\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nc\"\u003e.bye\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003efont-family\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e'Avenir'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eHelvetica\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eArial\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003esans-serif\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003e-webkit-font-smoothing\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eantialiased\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003e-moz-osx-font-smoothing\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003egrayscale\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003etext-align\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003ecenter\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003ecolor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e#2c3e50\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"nl\"\u003emargin-top\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e60px\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"err\"\u003eh1\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nl\"\u003efont-weight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003enormal\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"nt\"\u003ea\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nl\"\u003ecolor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e#42b983\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/style\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e[load]ボタンを押してデータが表示されていれば成功です。\u003c/p\u003e\n\n\u003cp\u003eついでにHot Module Replacementが動作しているかもためしてみましょう。\u003c/p\u003e\n\n\u003cp\u003eCompnayデータが表示された状態で\u003ccode\u003eBye.vue\u003c/code\u003eのstyleを適当に変えてみてください。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  .bye {\n    font-family: 'Avenir', Helvetica, Arial, sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    text-align: center;\n    color: #2c3e50;\n    margin-top: 60px;\n\u003cspan class=\"gi\"\u003e+   background-color: red;\n\u003c/span\u003e\n    h1 {\n      font-weight: normal;\n    }\n\n    a {\n      color: #42b983;\n    }\n  }\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eブラウザを\u003cstrong\u003e更新せずに\u003c/strong\u003e反映されたら成功です。\u003cbr\u003e\nHot Module Replacementが動作しています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"productionモードで動かす\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#production%E3%83%A2%E3%83%BC%E3%83%89%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eProductionモードで動かす\u003c/h2\u003e\n\n\u003cp\u003e最後にProductionでの動かし方です。\u003c/p\u003e\n\n\u003cp\u003eまず\u003ccode\u003enpm run build\u003c/code\u003eを実行して\u003ccode\u003esrc\u003c/code\u003eディレクトリの中をコンパイルします。\u003cbr\u003e\nコンパイルした結果は\u003ccode\u003edist\u003c/code\u003eに吐かれます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003enpm run build\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e次にURLが\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e/api\u003c/code\u003eで始まる場合はsinatra server\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e/dist\u003c/code\u003eで始まる場合は\u003ccode\u003edist\u003c/code\u003eディレクトリ\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e/\u003c/code\u003eの場合は\u003ccode\u003eindex.html\u003c/code\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eを返すように\u003ccode\u003econfig.ru\u003c/code\u003eを書き換えます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003econfig.ru\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'./server'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'rack-proxy'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eIndex\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"mi\"\u003e200\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Content-Type'\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e'text/html'\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'./index.html'\u003c/span\u003e\u003cspan class=\"p\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAppProxy\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eProxy\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003erewrite_env\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e'HTTP_HOST'\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e'localhost:8080'\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eenv\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"no\"\u003eENV\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"APP_ENV\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"production\"\u003c/span\u003e\n  \u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eURLMap\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e'/api'\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"no\"\u003eServer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e'/dist'\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eDirectory\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"./dist\"\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e'/'\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"no\"\u003eIndex\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n  \u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"no\"\u003eRack\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eURLMap\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e'/api'\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"no\"\u003eServer\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e'/'\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"no\"\u003eAppProxy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eあとは環境変数をつけて実行してあげるだけです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"shell-session\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gp\"\u003e$\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nv\"\u003eAPP_ENV\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eproduction bundle \u003cspan class=\"nb\"\u003eexec \u003c/span\u003erackup \n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e以上です。お疲れ様でした。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"http://adamjamesbull.co.uk/words/combining-webpack-sinatra\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://adamjamesbull.co.uk/words/combining-webpack-sinatra\u003c/a\u003e\u003c/p\u003e\n","body":"Sinatra+Vue.jsでSPAを作っていきます。\nSinatraやVue.jsが初めてという方は\n[sinatra+vue+webpackで作成したアプリをHerokuで公開する(初心者向け) - Qiita](http://qiita.com/isuke/items/6597f11bbd09cd0f5157)\nこちらも合わせてどうぞ。\n\n完成したコードは[こちら](https://github.com/isuke/sinatra-vuejs-template/tree/v0.8.0)で見ることができます。\n\n## フロントエンドの準備\n\nvue-cliを使うのでインストールします。\n\n```shell-session\n$ npm install -g vue-cli\n```\n\nvue templateを使います。\n\n```shell-session\n$ vue init isuke/vuejs-template#v0.8.0 sinatara-vue-sample\n```\n\n`isuke/vuejs-template`は著者が、公式の`vuejs-templates/webpack-simple`をもとに作ったvue.jsのテンプレートです。\n`vuejs-templates/webpack-simple`とくらべて以下の違いがります。\n\n- babelは使わずにcoffeescriptを使う\n- scssは使わずにstylusを使う\n- vue-routerが入っている\n- axiosが入っている\n\n基本的には同じなのでbabelが使いたい方などは`vuejs-templates/webpack-simple`を使ってもらっても大丈夫です。\n\n\n```shell-session\n$ yarn # npm installでも可\n$ npm run dev\n```\n\nhttp://localhost:8080/ をブラウザで開いてみましょう。\n一行もコードを書かずにこれだけでwebページができていることがわかると思います。\n[Bye]リンクをクリックしてページ遷移ができていることも確認してみてください。\n\n## サーバーサイドの作成\n\nここからsinatraを使っていきます。\n\n```shell-session\n$ bundle init\n```\n\n```rb:Gemfile\n# frozen_string_literal: true\n\nsource \"https://rubygems.org\"\n\nruby '2.4.1'\n\ngem 'rack-proxy'\ngem 'sinatra'\ngem 'sinatra-contrib'\n```\n\n```shell-session\n$ bundle install\n```\n\n`rack-proxy`という見慣れないものがありますが、これは後で説明します。\n\nsinatraのコードを書いていきます。\n\n```rb:server.rb\nrequire 'sinatra/base'\nrequire \"sinatra/reloader\"\n\nclass Server \u003c Sinatra::Base\n  configure :development do\n    register Sinatra::Reloader\n  end\n\n  get '/companies.json' do\n    companies = []\n    1.upto(50) do |i|\n      companies \u003c\u003c {\n        id: i,\n        name: \"Company #{i}\"\n      }\n    end\n    companies.to_json\n  end\nend\n```\n\n```rb:config.ru\nrequire './server'\n\nrun Server\n```\n\n何の変哲もない　APIが一つあるだけです。\n\n立ち上げて、確認してみましょう。\n\n```shell-session\n$ bundle exec rackup\n```\n\nhttp://localhost:9292/companies.json\n\njsonが返ってきました。\n次のステップに進みましょう。\n\n# フロントとサーバーの連携\n\nフロントは`npm run dev`でlocalhost:8080\nサーバーは`bundle exec rackup`でlocalhost:9292\nにそれぞれアクセスできるようになりました。\nこれをくっつけましょう。\n\n先程の`config.ru`を`rack-proxy`をつかって書き換えます。\n\n```rb:config.ru\nrequire './server'\nrequire 'rack-proxy'\n\nclass AppProxy \u003c Rack::Proxy\n  def rewrite_env(env)\n    env['HTTP_HOST'] = 'localhost:8080'\n    env\n  end\nend\n\nrun Rack::URLMap.new(\n '/api' =\u003e Server,\n  '/' =\u003e AppProxy.new\n)\n```\n\nサーバーを２つとも立ち上げてlocalhost:9292を見てみましょう。\n\n```shell-session\n$ npm run dev\n$ bundle exec rackup\n```\n\nhttp://localhost:9292/\n\nここでトップページが見れたらOKです。\nなぜlocalhost:9292でトップページが見れたのかというと、先程の`config.ru`の設定によりlocalhost:9292がlocalhost:8080にマップされたからですね。\n\nさて、これでフロントからAPIが叩けるようになったので、ちょっと試してみましょう。\n\nBye.vueを以下のように書き換えます。\n\n```html:Bye.vue\n\u003ctemplate lang=\"pug\"\u003e\n.bye\n  button(@click=\"load\") load\n  ul(v-for=\"company in companies\")\n    li {{company.name}}\n  router-link(:to=\"{ name: 'top'}\") TOP\n\u003c/template\u003e\n\n\u003cscript lang=\"coffee\"\u003e\nmodule.exports = {\n  name: 'bye'\n  data: -\u003e\n    companies: []\n  methods:\n    load: -\u003e\n      axios.get('/api/companies.json')\n        .then (responce) =\u003e\n          @companies = responce.data\n}\n\u003c/script\u003e\n\n\u003cstyle lang=\"stylus\"\u003e\n.bye {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n\n  h1 {\n    font-weight: normal;\n  }\n\n  a {\n    color: #42b983;\n  }\n}\n\u003c/style\u003e\n```\n\n[load]ボタンを押してデータが表示されていれば成功です。\n\nついでにHot Module Replacementが動作しているかもためしてみましょう。\n\nCompnayデータが表示された状態で`Bye.vue`のstyleを適当に変えてみてください。\n\n```diff\n  .bye {\n    font-family: 'Avenir', Helvetica, Arial, sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    text-align: center;\n    color: #2c3e50;\n    margin-top: 60px;\n+   background-color: red;\n\n    h1 {\n      font-weight: normal;\n    }\n\n    a {\n      color: #42b983;\n    }\n  }\n```\n\nブラウザを**更新せずに**反映されたら成功です。\nHot Module Replacementが動作しています。\n\n## Productionモードで動かす\n\n最後にProductionでの動かし方です。\n\nまず`npm run build`を実行して`src`ディレクトリの中をコンパイルします。\nコンパイルした結果は`dist`に吐かれます。\n\n```shell-session\n$ npm run build\n```\n\n次にURLが\n\n- `/api`で始まる場合はsinatra server\n- `/dist`で始まる場合は`dist`ディレクトリ\n- `/`の場合は`index.html`\n\nを返すように`config.ru`を書き換えます。\n\n```rb:config.ru\nrequire './server'\nrequire 'rack-proxy'\n\nclass Index\n  def call(env)\n    [\n      200,\n      { 'Content-Type' =\u003e 'text/html' },\n      [File.read('./index.html')]\n    ]\n  end\nend\n\nclass AppProxy \u003c Rack::Proxy\n  def rewrite_env(env)\n    env['HTTP_HOST'] = 'localhost:8080'\n    env\n  end\nend\n\nif ENV[\"APP_ENV\"] == \"production\"\n  run Rack::URLMap.new(\n    '/api' =\u003e Server,\n    '/dist' =\u003e Rack::Directory.new(\"./dist\"),\n    '/' =\u003e Index.new\n  )\nelse\n  run Rack::URLMap.new(\n    '/api' =\u003e Server,\n    '/' =\u003e AppProxy.new\n  )\nend\n```\n\nあとは環境変数をつけて実行してあげるだけです。\n\n```shell-session\n$ APP_ENV=production bundle exec rackup \n```\n\n以上です。お疲れ様でした。\n\n## 参考\n\nhttp://adamjamesbull.co.uk/words/combining-webpack-sinatra\n","coediting":false,"comments_count":2,"created_at":"2017-09-03T20:15:29+09:00","group":null,"id":"6df8ab9bea944b23f65d","likes_count":9,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"Sinatra","versions":[]},{"name":"SPA","versions":[]},{"name":"Vue.js","versions":[]},{"name":"webpack","versions":[]}],"title":"Sinatra+Vue.jsでSPA(Hot Module Replacementつき)","updated_at":"2017-11-05T18:02:47+09:00","url":"https://qiita.com/isuke/items/6df8ab9bea944b23f65d","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ca href=\"http://hanamirb.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHanami\u003c/a\u003eでwebpackを使う方法を説明していきます。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"プロジェクトの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロジェクトの作成\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003emkdir hanami-webpack\ncd hanami-webpack\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGemfile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e# frozen_string_literal: true\u003c/span\u003e\n\u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"https://rubygems.org\"\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"hanami\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"1.0.0\"\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle install\nbundle exec hanami new .\nbundle install\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ページの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eページの作成\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle exec hanami g action web page#home\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/config/routes.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gd\"\u003e- get '/page', to: 'page#home'\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+ get '/home', to: 'page#home'\n\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"erb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/templates/page/home.html.erb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;h1\u0026gt;\u003c/span\u003eHome\u003cspan class=\"nt\"\u003e\u0026lt;/h1\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eid=\u003c/span\u003e\u003cspan class=\"s\"\u003ehello\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u0026lt;/div\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eサーバ起動\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle exec hanami s\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca\u003elocalhost:2300/home\u003c/a\u003eを開けば　Homeと表示されるはずです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"assetsの削除\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#assets%E3%81%AE%E5%89%8A%E9%99%A4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eAssetsの削除　\u003c/h3\u003e\n\n\u003cp\u003eAssetsは使わないので削除しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003erm -rf apps/web/assets\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/application.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"gd\"\u003e- require 'hanami/assets'\n\u003c/span\u003e\n...\n\n- assets do\n\u003cspan class=\"gd\"\u003e-   javascript_compressor :builtin\n- \n-   stylesheet_compressor :builtin\n- \n-   sources \u0026lt;\u0026lt; [\n-     'assets'\n-   ]\n- end\n\u003c/span\u003e\n...\n\n  configure :production do\n\u003cspan class=\"gd\"\u003e-   assets do\n-     compile false\n-     fingerprint true\n-     subresource_integrity :sha256\n-   end\n\u003c/span\u003e  end\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"webpackの導入\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#webpack%E3%81%AE%E5%B0%8E%E5%85%A5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ewebpackの導入\u003c/h3\u003e\n\n\u003cp\u003eここから先は\u003ccode\u003eapps/web\u003c/code\u003eに移動して作業します。\u003cbr\u003e\n今どこのディレクトリにいるかをよく確認しながら作業してください。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ecd apps/web\nyarn init\nyarn add webpack assets-webpack-plugin --dev\nyarn add jquery\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/webpack.config.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epath\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ewebpack\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ewebpack\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eassetsPlugin\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eassets-webpack-plugin\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eentry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e./frontend/application.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003e__dirname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e..\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e..\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epublic\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n    \u003cspan class=\"na\"\u003efilename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ebundle_web-[hash].js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eassetsPlugin\u003c/span\u003e\u003cspan class=\"p\"\u003e()]\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003emkdir frontend\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/frontend/application.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ejquery\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e#hello\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nx\"\u003eafter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ehello webpack\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ewebpack\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれでプロジェクトファイル直下のpublicに\u003ccode\u003ebundle_web-aaaaaaaaa.js\u003c/code\u003eファイルが、\u003cbr\u003e\n\u003ccode\u003eapps/web\u003c/code\u003e以下に\u003ccode\u003ewebpack-assets.json\u003c/code\u003eができるはずです。\u003c/p\u003e\n\n\u003cp\u003egitを使う場合はこの段階で.gitignoreを以下のように設定しておくと良いでしょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.gitignore\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e/apps/*/node_modules\n/apps/*/webpack-assets.json\n/public/bundle*\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"bundle_webjsの読み込み\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#bundle_webjs%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ebundle_web.jsの読み込み\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/views/application_layout.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  module Web\n    module Views\n      class ApplicationLayout\n        include Web::Layout\n\u003cspan class=\"gi\"\u003e+ \n+       def script_for(bundle)\n+         path = Web::Application.configuration.root.join('webpack-assets.json')\n+         file = File.read(path)\n+         json = JSON.parse(file)\n+         json[bundle]['js']\n+       end\n\u003c/span\u003e      end\n    end\n  end\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/templates/application.html.erb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  \u0026lt;!DOCTYPE html\u0026gt;\n  \u0026lt;html\u0026gt;\n    \u0026lt;head\u0026gt;\n      \u0026lt;title\u0026gt;Web\u0026lt;/title\u0026gt;\n\u003cspan class=\"gd\"\u003e-     \u0026lt;%= favicon %\u0026gt;\n\u003c/span\u003e    \u0026lt;/head\u0026gt;\n    \u0026lt;body\u0026gt;\n      \u0026lt;%= yield %\u0026gt;\n\u003cspan class=\"gi\"\u003e+\n+     \u0026lt;script type=\"text/javascript\" src=\"#{script_for('main')}\" charset=\"utf-8\"\u0026gt;\u0026lt;/script\u0026gt;\n\u003c/span\u003e    \u0026lt;/body\u0026gt;\n  \u0026lt;/html\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれで\u003ca\u003elocalhost:2300/home\u003c/a\u003eを開けば　\u003ccode\u003ehello webpack\u003c/code\u003eと表示されるはずです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"もしもevalerrorがおきたら\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%82%E3%81%97%E3%82%82evalerror%E3%81%8C%E3%81%8A%E3%81%8D%E3%81%9F%E3%82%89\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eもしもEvalErrorがおきたら\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003ehello webpack\u003c/code\u003eと表示されず、ブラウザのコンソールに以下のようなエラーが出ていた場合の対処です。\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eUncaught EvalError: Refused to evaluate a string as JavaScript because 'unsafe-eval' is not an allowed source of script in the following Content Security Policy\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"diff\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/web/application.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  security.content_security_policy %{\n    form-action 'self';\n    frame-ancestors 'self';\n    base-uri 'self';\n    default-src 'none';\n\u003cspan class=\"gd\"\u003e-   script-src 'self';\n\u003c/span\u003e\u003cspan class=\"gi\"\u003e+   script-src 'unsafe-inline';\n\u003c/span\u003e    connect-src 'self';\n    img-src 'self' https: data:;\n    style-src 'self' 'unsafe-inline' https:;\n    font-src 'self';\n    object-src 'none';\n    plugin-types application/pdf;\n    child-src 'self';\n    frame-src 'self';\n    media-src 'self'\n  }\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれで行けるはずです。\u003c/p\u003e\n","body":"[Hanami](http://hanamirb.org/)でwebpackを使う方法を説明していきます。\n\n### プロジェクトの作成\n\n```\nmkdir hanami-webpack\ncd hanami-webpack\n```\n\n```rb:Gemfile\n# frozen_string_literal: true\nsource \"https://rubygems.org\"\n\ngem \"hanami\", \"1.0.0\"\n```\n\n```\nbundle install\nbundle exec hanami new .\nbundle install\n```\n\n### ページの作成\n\n```\nbundle exec hanami g action web page#home\n```\n\n```diff:apps/web/config/routes.rb\n- get '/page', to: 'page#home'\n+ get '/home', to: 'page#home'\n```\n\n```erb:apps/web/templates/page/home.html.erb\n\u003ch1\u003eHome\u003c/h1\u003e\n\n\u003cdiv id=hello\u003e\u003c/div\u003e\n```\n\nサーバ起動\n\n```\nbundle exec hanami s\n```\n\n[localhost:2300/home](localhost:2300/home)を開けば　Homeと表示されるはずです。\n\n### Assetsの削除　\n\nAssetsは使わないので削除しましょう。\n\n```\nrm -rf apps/web/assets\n```\n\n```diff:apps/web/application.rb\n- require 'hanami/assets'\n\n...\n\n- assets do\n-   javascript_compressor :builtin\n- \n-   stylesheet_compressor :builtin\n- \n-   sources \u003c\u003c [\n-     'assets'\n-   ]\n- end\n\n...\n\n  configure :production do\n-   assets do\n-     compile false\n-     fingerprint true\n-     subresource_integrity :sha256\n-   end\n  end\n```\n\n### webpackの導入\n\nここから先は`apps/web`に移動して作業します。\n今どこのディレクトリにいるかをよく確認しながら作業してください。\n\n```\ncd apps/web\nyarn init\nyarn add webpack assets-webpack-plugin --dev\nyarn add jquery\n```\n\n```js:apps/web/webpack.config.js\nvar path = require('path');\nvar webpack = require('webpack');\nvar assetsPlugin = require('assets-webpack-plugin');\n\nmodule.exports = {\n  entry: './frontend/application.js',\n  output: {\n    path: path.resolve(__dirname, '..', '..', 'public'),\n    filename: 'bundle_web-[hash].js'\n  },\n  plugins: [new assetsPlugin()]\n};\n```\n\n```\nmkdir frontend\n```\n\n```js:apps/web/frontend/application.js\n$ = require('jquery');\n\n$('#hello').after('hello webpack');\n```\n\n```\nwebpack\n```\n\nこれでプロジェクトファイル直下のpublicに`bundle_web-aaaaaaaaa.js`ファイルが、\n`apps/web`以下に`webpack-assets.json`ができるはずです。\n\ngitを使う場合はこの段階で.gitignoreを以下のように設定しておくと良いでしょう。\n\n```text:.gitignore\n/apps/*/node_modules\n/apps/*/webpack-assets.json\n/public/bundle*\n```\n\n### bundle_web.jsの読み込み\n\n```diff:apps/web/views/application_layout.rb\n  module Web\n    module Views\n      class ApplicationLayout\n        include Web::Layout\n+ \n+       def script_for(bundle)\n+         path = Web::Application.configuration.root.join('webpack-assets.json')\n+         file = File.read(path)\n+         json = JSON.parse(file)\n+         json[bundle]['js']\n+       end\n      end\n    end\n  end\n```\n\n```diff:apps/web/templates/application.html.erb\n  \u003c!DOCTYPE html\u003e\n  \u003chtml\u003e\n    \u003chead\u003e\n      \u003ctitle\u003eWeb\u003c/title\u003e\n-     \u003c%= favicon %\u003e\n    \u003c/head\u003e\n    \u003cbody\u003e\n      \u003c%= yield %\u003e\n+\n+     \u003cscript type=\"text/javascript\" src=\"#{script_for('main')}\" charset=\"utf-8\"\u003e\u003c/script\u003e\n    \u003c/body\u003e\n  \u003c/html\u003e\n```\n\nこれで[localhost:2300/home](localhost:2300/home)を開けば　`hello webpack`と表示されるはずです。\n\n### もしもEvalErrorがおきたら\n\n`hello webpack`と表示されず、ブラウザのコンソールに以下のようなエラーが出ていた場合の対処です。\n\n\u003e Uncaught EvalError: Refused to evaluate a string as JavaScript because 'unsafe-eval' is not an allowed source of script in the following Content Security Policy\n\n```diff:apps/web/application.rb\n  security.content_security_policy %{\n    form-action 'self';\n    frame-ancestors 'self';\n    base-uri 'self';\n    default-src 'none';\n-   script-src 'self';\n+   script-src 'unsafe-inline';\n    connect-src 'self';\n    img-src 'self' https: data:;\n    style-src 'self' 'unsafe-inline' https:;\n    font-src 'self';\n    object-src 'none';\n    plugin-types application/pdf;\n    child-src 'self';\n    frame-src 'self';\n    media-src 'self'\n  }\n```\n\nこれで行けるはずです。\n","coediting":false,"comments_count":0,"created_at":"2017-07-04T01:23:34+09:00","group":null,"id":"ce2652cd7d9f39367dc5","likes_count":7,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"webpack","versions":[]},{"name":"hanami","versions":[]}],"title":"Hanamiでwebpackを使う方法","updated_at":"2017-07-04T10:41:12+09:00","url":"https://qiita.com/isuke/items/ce2652cd7d9f39367dc5","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003erspec 3.5.0で調査。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'rails_helper'\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eRSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edescribe\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sample'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003etype: :model\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eprepend_before\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"outside prepend_before\"\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"outside before\"\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"context\"\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprepend_before\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"inside prepend_before\"\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"inside before\"\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"kp\"\u003etrue\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e実行結果\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003eoutside prepend_before\noutside before\ninside prepend_before\ninside before\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003einside prepend_before\u003c/code\u003eよりも\u003ccode\u003eoutside before\u003c/code\u003eが先なのね。\u003cbr\u003e\n変えてくれないかなこの挙動。\u003c/p\u003e\n","body":"\nrspec 3.5.0で調査。\n\n```rb\nrequire 'rails_helper'\n\nRSpec.describe 'sample', type: :model do\n\n  prepend_before { puts \"outside prepend_before\" }\n  before { puts \"outside before\" }\n\n  context \"context\" do\n    prepend_before { puts \"inside prepend_before\" }\n    before { puts \"inside before\" }\n\n    it { expect(true).to eq true }\n  end\nend\n```\n\n実行結果\n\n```\noutside prepend_before\noutside before\ninside prepend_before\ninside before\n```\n\n`inside prepend_before`よりも`outside before`が先なのね。\n変えてくれないかなこの挙動。\n","coediting":false,"comments_count":0,"created_at":"2017-06-28T11:20:11+09:00","group":null,"id":"f0bdbc652262cd50ae43","likes_count":1,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"RSpec","versions":[]}],"title":"rspecのprepend_beforeの実行順について調べてみた","updated_at":"2017-06-28T11:21:10+09:00","url":"https://qiita.com/isuke/items/f0bdbc652262cd50ae43","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ca href=\"http://hanamirb.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHanami\u003c/a\u003eで\u003ca href=\"http://graphql.org/learn/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eGraphQL\u003c/a\u003e APIを実装してみるよ。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"プロジェクトの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eプロジェクトの作成\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003emkdir hanami-blog\ncd hanami-blog\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGemfile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"c1\"\u003e# frozen_string_literal: true\u003c/span\u003e\n\u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"https://rubygems.org\"\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"hanami\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'1.0.0'\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle install\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle exec hanami new . --application-name=api \n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle install\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"モデルの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eモデルの作成\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle exec hanami generate model user\nbundle exec hanami generate model post\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e20170621155700_create_users.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eModel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emigration\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003echange\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecreate_table\u003c/span\u003e \u003cspan class=\"ss\"\u003e:users\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:email\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:created_at\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:updated_at\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e20170621155712_create_posts.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eModel\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emigration\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003echange\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecreate_table\u003c/span\u003e \u003cspan class=\"ss\"\u003e:posts\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eprimary_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eforeign_key\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:users\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eon_delete: :cascade\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:title\u003c/span\u003e  \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:content\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:created_at\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ecolumn\u003c/span\u003e \u003cspan class=\"ss\"\u003e:updated_at\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eDateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle exec hanami db prepare \n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"typeの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#type%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eTypeの作成\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGemfile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'graphql'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'1.6.4'\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle install\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003emkdir -p apps/api/types\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/api/application.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e      \u003cspan class=\"n\"\u003eload_paths\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"s1\"\u003e'controllers'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"s1\"\u003e'views'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003cspan class=\"o\"\u003e+\u003c/span\u003e       \u003cspan class=\"s1\"\u003e'types'\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/api/types/user_type.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eUserType\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eGraphQL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eObjectType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefine\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003ename\u003c/span\u003e \u003cspan class=\"s1\"\u003e'User'\u003c/span\u003e\n  \u003cspan class=\"n\"\u003edescription\u003c/span\u003e \u003cspan class=\"s1\"\u003e'User'\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efield\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"no\"\u003eID\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efield\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"no\"\u003eString\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efield\u003c/span\u003e \u003cspan class=\"ss\"\u003e:postss\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"no\"\u003ePostType\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/api/types/post_type.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003ePostType\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eGraphQL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eObjectType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefine\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003ename\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Post'\u003c/span\u003e\n  \u003cspan class=\"n\"\u003edescription\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Post'\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efield\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e     \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"no\"\u003eID\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efield\u003c/span\u003e \u003cspan class=\"ss\"\u003e:title\u003c/span\u003e  \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"no\"\u003eString\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efield\u003c/span\u003e \u003cspan class=\"ss\"\u003e:content\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"no\"\u003eString\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efield\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user\u003c/span\u003e   \u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eUserType\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresolve\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eUserRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser_id\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/api/types/query_type.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire_relative\u003c/span\u003e \u003cspan class=\"s1\"\u003e'user_type'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire_relative\u003c/span\u003e \u003cspan class=\"s1\"\u003e'post_type'\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eQueryType\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eGraphQL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eObjectType\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefine\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003ename\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Query'\u003c/span\u003e\n  \u003cspan class=\"n\"\u003edescription\u003c/span\u003e \u003cspan class=\"s1\"\u003e'The query root for this schema'\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003efield\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etype\u003c/span\u003e \u003cspan class=\"no\"\u003eUserType\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eargument\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"no\"\u003eID\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresolve\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eUserRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003efield\u003c/span\u003e \u003cspan class=\"ss\"\u003e:post\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etype\u003c/span\u003e \u003cspan class=\"no\"\u003ePostType\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eargument\u003c/span\u003e \u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003etypes\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"no\"\u003eID\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresolve\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003ePostRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/api/types/hanami_blog_schema.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire_relative\u003c/span\u003e \u003cspan class=\"s1\"\u003e'query_type'\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eHanamiBlogSchema\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eGraphQL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eSchema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003equery: \u003c/span\u003e\u003cspan class=\"no\"\u003eQueryType\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003elib/hanami_blog/repositories/post_repository.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003ePostRepository\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eHanami\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eRepository\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eposts_by_user\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eposts\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewhere\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003euser_id: \u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"controllerの作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#controller%E3%81%AE%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eControllerの作成\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/api/config/routes.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003eroot\u003c/span\u003e \u003cspan class=\"ss\"\u003eto: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"graphql#show\"\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapps/api/controllers/graphql/show.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003eApi::Controllers::Graphql\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eShow\u003c/span\u003e\n    \u003cspan class=\"kp\"\u003einclude\u003c/span\u003e \u003cspan class=\"no\"\u003eApi\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"n\"\u003equery_variables\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:vairables\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n      \u003cspan class=\"nb\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebody\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eJSON\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003egenerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eHanamiBlogSchema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eexecute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:query\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"ss\"\u003evariables: \u003c/span\u003e\u003cspan class=\"n\"\u003equery_variables\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"テスト用データ作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%86%E3%82%B9%E3%83%88%E7%94%A8%E3%83%87%E3%83%BC%E3%82%BF%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eテスト用データ作成\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle exec hanami c\nirb(main):002:0\u0026gt; user = UserRepository.new.create name: \"foo\", email: \"foo@exsample.com\"\nirb(main):005:0\u0026gt; PostRepository.new.create user_id: user.id, title: \"aaa\", contest: \"AAA\"\nirb(main):006:0\u0026gt; PostRepository.new.create user_id: user.id, title: \"bbb\", contest: \"BBB\"\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"試してみる\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A9%A6%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e試してみる\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle exec hanami s\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ecurl -XGET -d 'query={ user(id: 1) { name email posts {id title} } }' http://localhost:2300/ | jq .\n{\n  \"data\": {\n    \"user\": {\n      \"name\": \"foo\",\n      \"email\": \"foo@exsample.com\",\n      \"posts\": [\n        {\n          \"id\": \"1\",\n          \"title\": \"aaa\"\n        },\n        {\n          \"id\": \"2\",\n          \"title\": \"bbb\"\n        }\n      ]\n    }\n  }\n}\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ecurl -XGET -d 'query={ post(id: 1) { title user { name } } }' http://localhost:2300/ | jq . \n{\n  \"data\": {\n    \"post\": {\n      \"title\": \"aaa\",\n      \"user\": {\n        \"name\": \"foo\"\n      }\n    }\n  }\n}\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e以上。\u003cbr\u003e\n\u003ca href=\"http://hanamirb.org/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eHanami\u003c/a\u003e x \u003ca href=\"http://graphql.org/learn/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eGraphQL\u003c/a\u003eのニッチ x ニッチでどこに需要があるのかって感じですが、なにかのご参考になれば。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://blog.simplificator.com/2016/12/07/getting-started-with-hanami-and-graphql/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://blog.simplificator.com/2016/12/07/getting-started-with-hanami-and-graphql/\u003c/a\u003e\u003c/p\u003e\n","body":"[Hanami](http://hanamirb.org/)で[GraphQL](http://graphql.org/learn/) APIを実装してみるよ。\n\n### プロジェクトの作成\n\n```\nmkdir hanami-blog\ncd hanami-blog\n```\n\n```rb:Gemfile\n# frozen_string_literal: true\nsource \"https://rubygems.org\"\n\ngem \"hanami\", '1.0.0'\n```\n\n```\nbundle install\n```\n\n```\nbundle exec hanami new . --application-name=api \n```\n\n```\nbundle install\n```\n\n### モデルの作成\n\n```\nbundle exec hanami generate model user\nbundle exec hanami generate model post\n```\n\n```rb:20170621155700_create_users.rb\nHanami::Model.migration do\n  change do\n    create_table :users do\n      primary_key :id\n\n      column :name , String, null: false\n      column :email, String, null: false\n\n      column :created_at, DateTime, null: false\n      column :updated_at, DateTime, null: false\n    end\n  end\nend\n```\n\n```rb:20170621155712_create_posts.rb\nHanami::Model.migration do\n  change do\n    create_table :posts do\n      primary_key :id\n      foreign_key :user_id, :users, on_delete: :cascade, null: false\n\n      column :title  , String, null: false\n      column :content, String, null: true\n\n      column :created_at, DateTime, null: false\n      column :updated_at, DateTime, null: false\n    end\n  end\nend\n```\n\n```\nbundle exec hanami db prepare \n```\n\n### Typeの作成\n\n```rb:Gemfile\n+ gem 'graphql', '1.6.4'\n```\n\n```\nbundle install\n```\n\n```\nmkdir -p apps/api/types\n```\n\n```rb:apps/api/application.rb\n      load_paths \u003c\u003c [\n        'controllers',\n        'views',\n+       'types'\n      ]\n```\n\n```rb:apps/api/types/user_type.rb\nUserType = GraphQL::ObjectType.define do\n  name 'User'\n  description 'User'\n  field :id, types.ID\n  field :name, types.String\n  field :postss, types[!PostType]\nend\n```\n\n```rb:apps/api/types/post_type.rb\nPostType = GraphQL::ObjectType.define do\n  name 'Post'\n  description 'Post'\n  field :id     , types.ID\n  field :title  , types.String\n  field :content, types.String\n  field :user   , UserType do\n    resolve -\u003e(obj, _, _) { UserRepository.new.find(obj.user_id) }\n  end\nend\n```\n\n```rb:apps/api/types/query_type.rb\nrequire_relative 'user_type'\nrequire_relative 'post_type'\n\nQueryType = GraphQL::ObjectType.define do\n  name 'Query'\n  description 'The query root for this schema'\n\n  field :user do\n    type UserType\n    argument :id, !types.ID\n    resolve -\u003e(_, args, _) { UserRepository.new.find(args[:id]) }\n  end\n\n  field :post do\n    type PostType\n    argument :id, !types.ID\n    resolve -\u003e(_, args, _) { PostRepository.new.find(args[:id]) }\n  end\nend\n```\n\n```rb:apps/api/types/hanami_blog_schema.rb\nrequire_relative 'query_type'\n\nHanamiBlogSchema = GraphQL::Schema.define(query: QueryType)\n```\n\n```rb:lib/hanami_blog/repositories/post_repository.rb\nclass PostRepository \u003c Hanami::Repository\n  def posts_by_user(user)\n    posts.where(user_id: user.id)\n  end\nend\n```\n\n### Controllerの作成\n\n```rb:apps/api/config/routes.rb\nroot to: \"graphql#show\"\n```\n\n```rb:apps/api/controllers/graphql/show.rb\nmodule Api::Controllers::Graphql\n  class Show\n    include Api::Action\n\n    def call(params)\n      query_variables = params[:vairables] || {}\n      self.body = JSON.generate(HanamiBlogSchema.execute(params[:query], variables: query_variables))\n    end\n  end\nend\n```\n\n### テスト用データ作成\n\n```\nbundle exec hanami c\nirb(main):002:0\u003e user = UserRepository.new.create name: \"foo\", email: \"foo@exsample.com\"\nirb(main):005:0\u003e PostRepository.new.create user_id: user.id, title: \"aaa\", contest: \"AAA\"\nirb(main):006:0\u003e PostRepository.new.create user_id: user.id, title: \"bbb\", contest: \"BBB\"\n```\n\n\n### 試してみる\n\n```\nbundle exec hanami s\n```\n\n```\ncurl -XGET -d 'query={ user(id: 1) { name email posts {id title} } }' http://localhost:2300/ | jq .\n{\n  \"data\": {\n    \"user\": {\n      \"name\": \"foo\",\n      \"email\": \"foo@exsample.com\",\n      \"posts\": [\n        {\n          \"id\": \"1\",\n          \"title\": \"aaa\"\n        },\n        {\n          \"id\": \"2\",\n          \"title\": \"bbb\"\n        }\n      ]\n    }\n  }\n}\n```\n\n```\ncurl -XGET -d 'query={ post(id: 1) { title user { name } } }' http://localhost:2300/ | jq . \n{\n  \"data\": {\n    \"post\": {\n      \"title\": \"aaa\",\n      \"user\": {\n        \"name\": \"foo\"\n      }\n    }\n  }\n}\n```\n\n以上。\n[Hanami](http://hanamirb.org/) x [GraphQL](http://graphql.org/learn/)のニッチ x ニッチでどこに需要があるのかって感じですが、なにかのご参考になれば。\n\n### 参考\n\nhttps://blog.simplificator.com/2016/12/07/getting-started-with-hanami-and-graphql/\n","coediting":false,"comments_count":0,"created_at":"2017-06-27T19:45:52+09:00","group":null,"id":"28860a613ef7c6487b0f","likes_count":9,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"api","versions":[]},{"name":"GraphQL","versions":[]},{"name":"hanami","versions":[]}],"title":"HanamiでGraphQL APIを実装してみよう","updated_at":"2017-06-27T22:09:28+09:00","url":"https://qiita.com/isuke/items/28860a613ef7c6487b0f","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e自分でRakeタスクを作る場合、Railsプロジェクトの場合は\u003ccode\u003elib/tasks/\u003c/code\u003eに\u003ccode\u003e.rake\u003c/code\u003eファイルを作ります。しかしHanamiの場合はそのようなディレクトリはありません。なので一工夫する必要があります。\u003c/p\u003e\n\n\u003cp\u003eまず、Rakefileに以下の行を足します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eRakefile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eDir\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eexpand_path\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'../tasks'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kp\"\u003e__FILE__\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e'/*.rake'\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nf\"\u003eeach\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eload\u003c/span\u003e \u003cspan class=\"n\"\u003efile\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003etasks\u003c/code\u003eディレクトリを作り、そこにrakeファイルを置きます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003etasks/clear_users.rake\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003edesc\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Clear users\"\u003c/span\u003e\n\u003cspan class=\"n\"\u003etask\u003c/span\u003e \u003cspan class=\"ss\"\u003eclear_users: :environment\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eUserRepository\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eclear\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e:environment\u003c/code\u003eをつけることでプロジェクトのエンティティなどを読み込んでくれます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u0026gt; bundle exec rake -T\nrake create_user  # Clear users\nrake environment  # Load the full project\nrake spec         # Run RSpec code examples\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e認識してくれました！\u003c/p\u003e\n\n\u003cp\u003e以上です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h2\u003e\n\n\u003cp\u003e\u003ca href=\"http://hanamirb.org/guides/projects/rake/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://hanamirb.org/guides/projects/rake/\u003c/a\u003e\u003c/p\u003e\n","body":"自分でRakeタスクを作る場合、Railsプロジェクトの場合は`lib/tasks/`に`.rake`ファイルを作ります。しかしHanamiの場合はそのようなディレクトリはありません。なので一工夫する必要があります。\n\nまず、Rakefileに以下の行を足します。\n\n```rb:Rakefile\nDir[File.expand_path('../tasks', __FILE__) \u003c\u003c '/*.rake'].each { |file| load file }\n```\n\n`tasks`ディレクトリを作り、そこにrakeファイルを置きます。\n\n```rb:tasks/clear_users.rake\ndesc \"Clear users\"\ntask clear_users: :environment do\n  UserRepository.new.clear\nend\n```\n\n`:environment`をつけることでプロジェクトのエンティティなどを読み込んでくれます。\n\n```\n\u003e bundle exec rake -T\nrake create_user  # Clear users\nrake environment  # Load the full project\nrake spec         # Run RSpec code examples\n```\n\n認識してくれました！\n\n以上です。\n\n## 参考\n\nhttp://hanamirb.org/guides/projects/rake/\n","coediting":false,"comments_count":0,"created_at":"2017-06-20T23:52:11+09:00","group":null,"id":"e2fec4b000f56af0e1ae","likes_count":3,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"rake","versions":[]},{"name":"hanami","versions":[]}],"title":"Hanamiにrake taskを追加する方法","updated_at":"2017-06-21T10:37:18+09:00","url":"https://qiita.com/isuke/items/e2fec4b000f56af0e1ae","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ca href=\"http://qiita.com/syu_chan_1005/items/e1a18896107d8cedfc45\" id=\"reference-6c699d4f6f4584e3388e\"\u003eGitのコミットに絵文字を使おう！ - Qiita\u003c/a\u003e\u003cbr\u003e\nこちらの記事を読んでなるほどと思ったので、PRレビューにも使えないか考えてみました。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"ルール\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%AB%E3%83%BC%E3%83%AB\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eルール\u003c/h3\u003e\n\n\u003cp\u003ePRレビューの際に1コメントに1つだけ、頭に絵文字をつけます。\u003cbr\u003e\nつける絵文字はチームで共有しましょう。以下は例です。\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: center\"\u003e絵文字\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e文字列\u003c/th\u003e\n\u003cth style=\"text-align: left\"\u003e意味\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":book:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f4d6.png\" title=\":book:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ebook\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eTOPIC: 参考までに。修正する必要はないけどこうゆう書き方もあるよ。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":wrench:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f527.png\" title=\":wrench:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ewrench\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eHACK: リファクタリングの余地あり。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":turtle:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f422.png\" title=\":turtle:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eturtle\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eOPTIMIZE: パフォーマンス改善の余地あり。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":pencil2:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/270f-fe0f.png\" title=\":pencil2:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003epencil2\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eDOC: ドキュメントを書こう。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":red_circle:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f534.png\" title=\":red_circle:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ered_circle\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eTEST: テストを書こう。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":unlock:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f513.png\" title=\":unlock:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eunlock\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eSECURITY: セキュリティに問題あり。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":hammer:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f528.png\" title=\":hammer:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ehammer\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eIMPLEMENT: 仕様を満たしていない。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":bug:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f41b.png\" title=\":bug:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ebug\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eBUG: バグあり。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":cool:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f192.png\" title=\":cool:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ecool\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eCOOL: このコードいいね。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":raised_hand:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/270b.png\" title=\":raised_hand:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003ehand\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eHELP: 自分じゃわからないから他の人レビューして。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: center\"\u003e\u003cimg alt=\":sos:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f198.png\" title=\":sos:\" width=\"20\" loading=\"lazy\"\u003e\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003esos\u003c/td\u003e\n\u003ctd style=\"text-align: left\"\u003eSOS: よくわからないので説明して。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"メリット\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eメリット\u003c/h3\u003e\n\n\u003cp\u003e以下のメリットがあるのではないかと思っています。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e議論がゴッチャにならない\u003cbr\u003e\n1つのコメントに1つしか絵文字が使えないので、一度に複数のことを言うことはできません。\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eレビュー時間短縮\u003cbr\u003e\n絵文字だけでも意図が伝わるのでコメントを書く時間が減ります。\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e何が言いたいのか伝わりやすい\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eなんか楽しげ\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h3\u003e\n\n\u003cp\u003e自分はまだ導入していないのでうまくいくかわかりませんが、PRレビューのコミュニケーションでお困りの方は導入を検討してみてはどうでしょうか?\u003cbr\u003e\n導入した際にはぜひとも使ってみた感想を聞かせてください。\u003c/p\u003e\n","body":"[Gitのコミットに絵文字を使おう！ - Qiita](http://qiita.com/syu_chan_1005/items/e1a18896107d8cedfc45)\nこちらの記事を読んでなるほどと思ったので、PRレビューにも使えないか考えてみました。\n\n### ルール\n\nPRレビューの際に1コメントに1つだけ、頭に絵文字をつけます。\nつける絵文字はチームで共有しましょう。以下は例です。\n\n| 絵文字       | 文字列     | 意味                                                              |\n|:------------:|:-----------|:------------------------------------------------------------------|\n| :book:       | book       | TOPIC: 参考までに。修正する必要はないけどこうゆう書き方もあるよ。 |\n| :wrench:      | wrench       | HACK: リファクタリングの余地あり。                                |\n| :turtle:     | turtle     | OPTIMIZE: パフォーマンス改善の余地あり。                          |\n| :pencil2:    | pencil2    | DOC: ドキュメントを書こう。                                       |\n| :red_circle: | red_circle | TEST: テストを書こう。                                            |\n| :unlock:     | unlock     | SECURITY: セキュリティに問題あり。                                |\n| :hammer:     | hammer     | IMPLEMENT: 仕様を満たしていない。                                 |\n| :bug:        | bug        | BUG: バグあり。                                                   |\n| :cool:       | cool       | COOL: このコードいいね。                                          |\n| :hand:       | hand       | HELP: 自分じゃわからないから他の人レビューして。                  |\n| :sos:        | sos        | SOS: よくわからないので説明して。                                 |\n### メリット\n\n以下のメリットがあるのではないかと思っています。\n\n- 議論がゴッチャにならない\n1つのコメントに1つしか絵文字が使えないので、一度に複数のことを言うことはできません。\n\n- レビュー時間短縮\n絵文字だけでも意図が伝わるのでコメントを書く時間が減ります。\n\n- 何が言いたいのか伝わりやすい\n\n- なんか楽しげ\n\n### まとめ\n\n自分はまだ導入していないのでうまくいくかわかりませんが、PRレビューのコミュニケーションでお困りの方は導入を検討してみてはどうでしょうか?\n導入した際にはぜひとも使ってみた感想を聞かせてください。\n\n","coediting":false,"comments_count":1,"created_at":"2017-06-19T22:55:53+09:00","group":null,"id":"1b154580a78bed82f99a","likes_count":11,"private":false,"reactions_count":0,"tags":[{"name":"Git","versions":[]},{"name":"GitHub","versions":[]},{"name":"emoji","versions":[]}],"title":"PRレビューに絵文字を使おう！","updated_at":"2018-04-11T14:23:19+09:00","url":"https://qiita.com/isuke/items/1b154580a78bed82f99a","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eタイトルは釣りです。すみません。\u003c/p\u003e\n\n\u003cp\u003eCSSフレームワークって文章構造とスタイル情報の分離ができてなかったり、色々問題だよねって話です。\u003cbr\u003e\nそれではどうぞ。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"cssフレームワークの問題点\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#css%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%83%AF%E3%83%BC%E3%82%AF%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCSSフレームワークの問題点\u003c/h2\u003e\n\n\u003cp\u003e以下は\u003ca href=\"http://getbootstrap.com/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eBootstrap\u003c/a\u003eの公式から持ってきたサンプルコードです。\u003cbr\u003e\nこちらのサンプルコードを見ながらCSSフレームワークの問題点を探っていきましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"row\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"col-lg-6\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"input-group\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;span\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"input-group-btn\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"btn btn-default\"\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"button\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eGo!\u003cspan class=\"nt\"\u003e\u0026lt;/button\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;/span\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"text\"\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"form-control\"\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Search for...\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- /input-group --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- /.col-lg-6 --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"col-lg-6\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"input-group\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"text\"\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"form-control\"\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Search for...\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;span\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"input-group-btn\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"btn btn-default\"\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"button\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eGo!\u003cspan class=\"nt\"\u003e\u0026lt;/button\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e\u0026lt;/span\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- /input-group --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- /.col-lg-6 --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- /.row --\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"何を構成するコードなのかわからない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E4%BD%95%E3%82%92%E6%A7%8B%E6%88%90%E3%81%99%E3%82%8B%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AA%E3%81%AE%E3%81%8B%E3%82%8F%E3%81%8B%E3%82%89%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e何を構成するコードなのかわからない\u003c/h3\u003e\n\n\u003cp\u003eCSSのサンプルなので当たり前なのですが、上記のコードからサイトのどの部分を構成しているのかを読み取ることは困難です。\u003cbr\u003e\nかろうじて検索フォームなのがわかるくらいでしょうか。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"文書構造定義とスタイル定義が分離できていない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%87%E6%9B%B8%E6%A7%8B%E9%80%A0%E5%AE%9A%E7%BE%A9%E3%81%A8%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E5%AE%9A%E7%BE%A9%E3%81%8C%E5%88%86%E9%9B%A2%E3%81%A7%E3%81%8D%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e文書構造定義とスタイル定義が分離できていない\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"col-lg-6\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"c\"\u003e\u0026lt;!-- ... --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- /.col-lg-6 --\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003ecol-lg-6\u003c/code\u003eはLarge deviceで幅が6/12という意味です。\u003cbr\u003e\n「Large deviceで幅が6/12」というのは文書構造でしょうか?\u003cbr\u003e\nいいえ、スタイルですね。\u003cbr\u003e\n\u003cstrong\u003eこれがCSSフレームワークを使う最大の弊害\u003c/strong\u003eです。\u003cbr\u003e\nスタイル定義がHTMLに侵食してしまうのです。\u003c/p\u003e\n\n\u003cp\u003e本来、文書構造に変更が生じたときはHTMLのみ、スタイルの変更が生じたときはCSSのみを変更するのが理想です。\u003cbr\u003e\nですが、上記の場合例えば「幅を7/12にしたい」というスタイルの変更が生じたときにHTMLを編集しなくてはなりません。\u003cbr\u003e\n文書構造とスタイルを分離するためにスタイルシートが生まれたのにこれでは本末転倒ですね。\u003c/p\u003e\n\n\u003cp\u003e文書構造定義とスタイル定義が混ざることにより、凝集度は下がり、保守性は下がり、いつしかコードはカオスになっていくでしょう。\u003cbr\u003e\nそして、戦争は繰り返され、幾つもの国が生まれては滅び、幾人もの英雄が現れては死んでき、長い年月が経った頃にはあなたのプロジェクトは終わっているでしょう。\u003cbr\u003e\n悲しいことです。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"そんなこと言ったってどうすりゃいいのさ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%9D%E3%82%93%E3%81%AA%E3%81%93%E3%81%A8%E8%A8%80%E3%81%A3%E3%81%9F%E3%81%A3%E3%81%A6%E3%81%A9%E3%81%86%E3%81%99%E3%82%8A%E3%82%83%E3%81%84%E3%81%84%E3%81%AE%E3%81%95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eそんなこと言ったってどうすりゃいいのさ\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"mixinライブラリの使用を検討しましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#mixin%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E4%BD%BF%E7%94%A8%E3%82%92%E6%A4%9C%E8%A8%8E%E3%81%97%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eMixinライブラリの使用を検討しましょう\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://bourbon.io/\" rel=\"nofollow noopener\" target=\"_blank\"\u003ebourbon\u003c/a\u003eなどのMixinライブラリの使用を検討しましょう。\u003cbr\u003e\nMixinライブラリを使うことで文書構造とスタイルを分離しながら便利なCSSを使うことができます。\u003c/p\u003e\n\n\u003cp\u003e上のBootstrapの例を書き直すと以下のようになるでしょうか。(イメージです。実際に動くコードではありません。)\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"html\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"search_bar\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"search_bar__search_form\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;button\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"search_bar__search_form__btn\"\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"button\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003eGo!\u003cspan class=\"nt\"\u003e\u0026lt;/button\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003e\u0026lt;input\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"text\"\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"search_bar__search_form__submit\"\u003c/span\u003e \u003cspan class=\"na\"\u003eplaceholder=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"Search for...\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- /.search_bar__search_form --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;div\u003c/span\u003e \u003cspan class=\"na\"\u003eclass=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"search_bar__option_form\"\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"c\"\u003e\u0026lt;!-- 省略 --\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- /.search_bar__option_form --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"nt\"\u003e\u0026lt;/div\u0026gt;\u003c/span\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- /.search_bar --\u0026gt;\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"scss\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nc\"\u003e.search_bar\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003e@include\u003c/span\u003e \u003cspan class=\"nd\"\u003egrid-container\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"k\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nt\"\u003e__search_form\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003e@include\u003c/span\u003e \u003cspan class=\"nd\"\u003egrid-column\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003e@include\u003c/span\u003e \u003cspan class=\"nd\"\u003edisplay\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eflex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"k\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nt\"\u003e__input\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003e@include\u003c/span\u003e \u003cspan class=\"nd\"\u003eflex\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"k\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nt\"\u003e__option_form\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003e@include\u003c/span\u003e \u003cspan class=\"nd\"\u003egrid-column\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"extendして使いましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#extend%E3%81%97%E3%81%A6%E4%BD%BF%E3%81%84%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003ccode\u003e@extend\u003c/code\u003eして使いましょう\u003c/h3\u003e\n\n\u003cp\u003e折衷案としてCSSフレームワークのクラスをextendして使う方法があります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"scss\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nc\"\u003e.search_bar\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"k\"\u003e@extend\u003c/span\u003e \u003cspan class=\"nc\"\u003e.row\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eといった感じで一個一個必要なクラスをextendして使います。\u003cbr\u003e\n大変ですが、できないことはないでしょう。\u003c/p\u003e\n\n\u003cp\u003eこの方法でも文書構造とスタイルを分離しながら便利なCSSを使うことができます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"まとめ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003eCSSフレームワークはお手軽にきれいなサイトができて素敵\u003c/li\u003e\n\u003cli\u003eでも文書構造とスタイルを分離できない\n\n\u003cul\u003e\n\u003cli\u003eそれゆえ: コードがカオスになる\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMixinライブラリを使うなど工夫しましょう\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e以上、お読み頂きありがとうございました。\u003cbr\u003e\n今後とも宜しくお願い致します。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"補足\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A3%9C%E8%B6%B3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e補足\u003c/h2\u003e\n\n\u003cp\u003eCSSフレームワークについてだけ書きましたが、以下のようなCSSを書いている場合も同じ話です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e.m05 { margin:   5px; }\n.m10 { margin:  10px; }\n.m15 { margin:  15px; } \n.p05 { padding:  5px; }\n.p10 { padding: 10px; }\n.p15 { padding: 15px; } \n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e身に覚えがないですか？\u003c/p\u003e\n","body":"タイトルは釣りです。すみません。\n\nCSSフレームワークって文章構造とスタイル情報の分離ができてなかったり、色々問題だよねって話です。\nそれではどうぞ。\n\n## CSSフレームワークの問題点\n\n以下は[Bootstrap](http://getbootstrap.com/)の公式から持ってきたサンプルコードです。\nこちらのサンプルコードを見ながらCSSフレームワークの問題点を探っていきましょう。\n\n```html\n\u003cdiv class=\"row\"\u003e\n  \u003cdiv class=\"col-lg-6\"\u003e\n    \u003cdiv class=\"input-group\"\u003e\n      \u003cspan class=\"input-group-btn\"\u003e\n        \u003cbutton class=\"btn btn-default\" type=\"button\"\u003eGo!\u003c/button\u003e\n      \u003c/span\u003e\n      \u003cinput type=\"text\" class=\"form-control\" placeholder=\"Search for...\"\u003e\n    \u003c/div\u003e\u003c!-- /input-group --\u003e\n  \u003c/div\u003e\u003c!-- /.col-lg-6 --\u003e\n  \u003cdiv class=\"col-lg-6\"\u003e\n    \u003cdiv class=\"input-group\"\u003e\n      \u003cinput type=\"text\" class=\"form-control\" placeholder=\"Search for...\"\u003e\n      \u003cspan class=\"input-group-btn\"\u003e\n        \u003cbutton class=\"btn btn-default\" type=\"button\"\u003eGo!\u003c/button\u003e\n      \u003c/span\u003e\n    \u003c/div\u003e\u003c!-- /input-group --\u003e\n  \u003c/div\u003e\u003c!-- /.col-lg-6 --\u003e\n\u003c/div\u003e\u003c!-- /.row --\u003e\n```\n\n### 何を構成するコードなのかわからない\n\nCSSのサンプルなので当たり前なのですが、上記のコードからサイトのどの部分を構成しているのかを読み取ることは困難です。\nかろうじて検索フォームなのがわかるくらいでしょうか。\n\n### 文書構造定義とスタイル定義が分離できていない\n\n```html\n\u003cdiv class=\"col-lg-6\"\u003e\n  \u003c!-- ... --\u003e\n\u003c/div\u003e\u003c!-- /.col-lg-6 --\u003e\n```\n\n`col-lg-6`はLarge deviceで幅が6/12という意味です。\n「Large deviceで幅が6/12」というのは文書構造でしょうか?\nいいえ、スタイルですね。\n**これがCSSフレームワークを使う最大の弊害**です。\nスタイル定義がHTMLに侵食してしまうのです。\n\n本来、文書構造に変更が生じたときはHTMLのみ、スタイルの変更が生じたときはCSSのみを変更するのが理想です。\nですが、上記の場合例えば「幅を7/12にしたい」というスタイルの変更が生じたときにHTMLを編集しなくてはなりません。\n文書構造とスタイルを分離するためにスタイルシートが生まれたのにこれでは本末転倒ですね。\n\n文書構造定義とスタイル定義が混ざることにより、凝集度は下がり、保守性は下がり、いつしかコードはカオスになっていくでしょう。\nそして、戦争は繰り返され、幾つもの国が生まれては滅び、幾人もの英雄が現れては死んでき、長い年月が経った頃にはあなたのプロジェクトは終わっているでしょう。\n悲しいことです。\n\n## そんなこと言ったってどうすりゃいいのさ\n\n### Mixinライブラリの使用を検討しましょう\n\n[bourbon](http://bourbon.io/)などのMixinライブラリの使用を検討しましょう。\nMixinライブラリを使うことで文書構造とスタイルを分離しながら便利なCSSを使うことができます。\n\n上のBootstrapの例を書き直すと以下のようになるでしょうか。(イメージです。実際に動くコードではありません。)\n\n```html\n\u003cdiv class=\"search_bar\"\u003e\n  \u003cdiv class=\"search_bar__search_form\"\u003e\n    \u003cbutton class=\"search_bar__search_form__btn\" type=\"button\"\u003eGo!\u003c/button\u003e\n    \u003cinput type=\"text\" class=\"search_bar__search_form__submit\" placeholder=\"Search for...\"\u003e\n  \u003c/div\u003e\u003c!-- /.search_bar__search_form --\u003e\n  \u003cdiv class=\"search_bar__option_form\"\u003e\n    \u003c!-- 省略 --\u003e\n  \u003c/div\u003e\u003c!-- /.search_bar__option_form --\u003e\n\u003c/div\u003e\u003c!-- /.search_bar --\u003e\n```\n\n```scss\n.search_bar {\n  @include grid-container;\n  \u0026__search_form {\n    @include grid-column(6);\n    @include display(flex);\n    \u0026__input { @include flex(1); }\n  }\n  \u0026__option_form {\n    @include grid-column(6);\n  }\n}\n```\n\n### `@extend`して使いましょう\n\n折衷案としてCSSフレームワークのクラスをextendして使う方法があります。\n\n```scss\n.search_bar {\n  @extend .row;\n}\n```\n\nといった感じで一個一個必要なクラスをextendして使います。\n大変ですが、できないことはないでしょう。\n\nこの方法でも文書構造とスタイルを分離しながら便利なCSSを使うことができます。\n\n## まとめ\n\n- CSSフレームワークはお手軽にきれいなサイトができて素敵\n- でも文書構造とスタイルを分離できない\n  - それゆえ: コードがカオスになる\n- Mixinライブラリを使うなど工夫しましょう\n\n以上、お読み頂きありがとうございました。\n今後とも宜しくお願い致します。\n\n## 補足\n\nCSSフレームワークについてだけ書きましたが、以下のようなCSSを書いている場合も同じ話です。\n\n```\n.m05 { margin:   5px; }\n.m10 { margin:  10px; }\n.m15 { margin:  15px; } \n.p05 { padding:  5px; }\n.p10 { padding: 10px; }\n.p15 { padding: 15px; } \n```\n\n身に覚えがないですか？\n","coediting":false,"comments_count":0,"created_at":"2017-06-13T20:43:11+09:00","group":null,"id":"e132669d54523c934b96","likes_count":56,"private":false,"reactions_count":0,"tags":[{"name":"HTML","versions":[]},{"name":"CSS","versions":[]},{"name":"Bootstrap","versions":[]}],"title":"お前ら今すぐそのCSSフレームワーク使うのやめろ!","updated_at":"2017-06-17T16:03:49+09:00","url":"https://qiita.com/isuke/items/e132669d54523c934b96","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eいろんなところからパクった秘伝のgit aliasです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.gitconfig\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003estat = status\ncom = commit\nwip = \"!f () { git commit -m \\\"WIP $1\\\"; };f\"                                   # WIPでコミット\nwipc = \"!f () { git commit -m \\\"WIP $1 [ci skip]\\\"; };f\"                        # WIPでコミット(ci skip)\nfix = \"!f () { git commit -m \\\"Fixup $1\\\"; };f\"                                 # Fixupでコミット(あとでrebaseする)\nrecom = commit --amend --no-edit                                                # 再commitします。コミットメッセージ変更しません\nrecom-reword = commit --amend                                                   # 再commitします。コミットメッセージ変更します\ncon = consistent -i -t\nchk = checkout\nchk-fork = \"!f () { git checkout -b ᛝ`git cbran`+$1; };f\"                       # master以外のブランチからブランチを切るとき\ndiffh = diff HEAD\ndiffhh = diff HEAD^                                                             # 最後にcommitしたファイルとの差分が見たいときに\ndiffc = diff --cached                                                           # add したものとHEADの差分を見たいときに\nbran = branch\nbran-backup = !git branch ဓ`git cbran`-backup                                   # 現在のブランチをバックアップ\ncleanbran = checkout --orphan                                                   # 親コミットのないブランチを作成\ncbran = rev-parse --abbrev-ref HEAD                                             # カレントブランチの名前を取得\ncancel = reset --soft HEAD^                                                     # 最後のコミットを取り消し\ncpush = !git push origin `git cbran`\ncpull = !git pull origin `git cbran`\nfpull = !git fetch origin `git cbran` \u0026amp;\u0026amp; git reset --hard origin/`git cbran`    # 現在の状態を無視して強制的にpull\nretag = \"!f () { git tag -d $1;git tag $1\u0026amp;\u0026amp;echo Create tag \\\\'$1\\\\'; };f\"       # tagの付け直し\nmrg = merge --no-ff\nslog = log --pretty=format:'%C(yellow)[%ad] %C(green)%h %Creset: %s' --date=iso # 1 commit 1行でlogを表示します。\nslog-name = log --pretty=format:'%C(yellow)[%ad] %C(green)%h %Creset: %C(blue)%an %Creset: %s' --date=iso\ndelete-brans = !git branch --merged | grep -v \\\\* | grep -v 'master\\\\|release' | xargs -I % git branch -d % # master, release以外のマージ済みのbranchをすべて削除します。\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"参考\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8F%82%E8%80%83\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e参考\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"http://qiita.com/tkengo/items/5bae50fb7531d5a6bbcf\" class=\"autolink\" id=\"reference-4184a6cb2a1f6457365e\"\u003ehttp://qiita.com/tkengo/items/5bae50fb7531d5a6bbcf\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"http://qiita.com/Yinaura/items/30992f25b87f76af3ba2\" class=\"autolink\" id=\"reference-46f877f2c4d8427cc528\"\u003ehttp://qiita.com/Yinaura/items/30992f25b87f76af3ba2\u003c/a\u003e\u003cbr\u003e\n\u003ca href=\"http://gutch.hatenablog.com/entry/2014/05/17/155840\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://gutch.hatenablog.com/entry/2014/05/17/155840\u003c/a\u003e\u003c/p\u003e\n","body":"いろんなところからパクった秘伝のgit aliasです。\n\n```text:.gitconfig\nstat = status\ncom = commit\nwip = \"!f () { git commit -m \\\"WIP $1\\\"; };f\"                                   # WIPでコミット\nwipc = \"!f () { git commit -m \\\"WIP $1 [ci skip]\\\"; };f\"                        # WIPでコミット(ci skip)\nfix = \"!f () { git commit -m \\\"Fixup $1\\\"; };f\"                                 # Fixupでコミット(あとでrebaseする)\nrecom = commit --amend --no-edit                                                # 再commitします。コミットメッセージ変更しません\nrecom-reword = commit --amend                                                   # 再commitします。コミットメッセージ変更します\ncon = consistent -i -t\nchk = checkout\nchk-fork = \"!f () { git checkout -b ᛝ`git cbran`+$1; };f\"                       # master以外のブランチからブランチを切るとき\ndiffh = diff HEAD\ndiffhh = diff HEAD^                                                             # 最後にcommitしたファイルとの差分が見たいときに\ndiffc = diff --cached                                                           # add したものとHEADの差分を見たいときに\nbran = branch\nbran-backup = !git branch ဓ`git cbran`-backup                                   # 現在のブランチをバックアップ\ncleanbran = checkout --orphan                                                   # 親コミットのないブランチを作成\ncbran = rev-parse --abbrev-ref HEAD                                             # カレントブランチの名前を取得\ncancel = reset --soft HEAD^                                                     # 最後のコミットを取り消し\ncpush = !git push origin `git cbran`\ncpull = !git pull origin `git cbran`\nfpull = !git fetch origin `git cbran` \u0026\u0026 git reset --hard origin/`git cbran`    # 現在の状態を無視して強制的にpull\nretag = \"!f () { git tag -d $1;git tag $1\u0026\u0026echo Create tag \\\\'$1\\\\'; };f\"       # tagの付け直し\nmrg = merge --no-ff\nslog = log --pretty=format:'%C(yellow)[%ad] %C(green)%h %Creset: %s' --date=iso # 1 commit 1行でlogを表示します。\nslog-name = log --pretty=format:'%C(yellow)[%ad] %C(green)%h %Creset: %C(blue)%an %Creset: %s' --date=iso\ndelete-brans = !git branch --merged | grep -v \\\\* | grep -v 'master\\\\|release' | xargs -I % git branch -d % # master, release以外のマージ済みのbranchをすべて削除します。\n```\n\n### 参考\n\nhttp://qiita.com/tkengo/items/5bae50fb7531d5a6bbcf\nhttp://qiita.com/Yinaura/items/30992f25b87f76af3ba2\nhttp://gutch.hatenablog.com/entry/2014/05/17/155840\n","coediting":false,"comments_count":0,"created_at":"2017-06-12T16:04:06+09:00","group":null,"id":"7c622324c396c172a16c","likes_count":5,"private":false,"reactions_count":0,"tags":[{"name":"Git","versions":[]}],"title":"秘伝のgit alias","updated_at":"2018-06-26T21:07:29+09:00","url":"https://qiita.com/isuke/items/7c622324c396c172a16c","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eES2015が登場してすっかりCoffeeScriptがオワコン化(オワコンという言葉自体がオワコンか?)した感があります。\u003cbr\u003e\n嫌いな言語ランキングでも無事3位にランクインされました(\u003ca href=\"https://fossbytes.com/most-loved-and-most-hated-programming-languages/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://fossbytes.com/most-loved-and-most-hated-programming-languages/\u003c/a\u003e )。\u003c/p\u003e\n\n\u003cp\u003eCoffeeScriptはもう死んだ言語なのでしょうか?\u003cbr\u003e\nいえいえ、ES2015登場後もCoffeeScriptを使うメリットはあります。\u003cbr\u003e\nそこで、すっかり嫌われ者になってしまったCoffeeScriptのいいところを紹介したいと思います。\u003cbr\u003e\nちなみに、TypeScriptについては触れません(触ったことがないので)。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"coffeescriptはが不要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#coffeescript%E3%81%AF%E3%81%8C%E4%B8%8D%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCoffeeScriptは\u003ccode\u003e;\u003c/code\u003eが不要\u003c/h3\u003e\n\n\u003cp\u003e21世紀にもなって\u003ccode\u003e;\u003c/code\u003eをつけないといけないのはかなり苦痛なのでこれは結構うれしいです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"coffeescriptは比較が厳密\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#coffeescript%E3%81%AF%E6%AF%94%E8%BC%83%E3%81%8C%E5%8E%B3%E5%AF%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCoffeeScriptは比較が厳密\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ejs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"dl\"\u003e\"\"\u003c/span\u003e           \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003e0\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e           \u003cspan class=\"c1\"\u003e// false\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e0\u003c/span\u003e            \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"dl\"\u003e\"\"\u003c/span\u003e            \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e0\u003c/span\u003e            \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003e0\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e           \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e        \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003efalse\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e       \u003cspan class=\"c1\"\u003e// false\u003c/span\u003e\n\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e        \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003e0\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e           \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e        \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"kc\"\u003eundefined\u003c/span\u003e     \u003cspan class=\"c1\"\u003e// false\u003c/span\u003e\n\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e        \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"kc\"\u003enull\u003c/span\u003e          \u003cspan class=\"c1\"\u003e// false\u003c/span\u003e\n\u003cspan class=\"kc\"\u003enull\u003c/span\u003e         \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"kc\"\u003eundefined\u003c/span\u003e     \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003e \u003c/span\u003e\u003cspan class=\"se\"\u003e\\t\\r\\n\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e    \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"mi\"\u003e0\u003c/span\u003e             \u003cspan class=\"c1\"\u003e// true\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecoffeescript\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e           \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"s\"\u003e\"0\"\u003c/span\u003e           \u003cspan class=\"c1\"\u003e# false\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e0\u003c/span\u003e            \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"s\"\u003e\"\"\u003c/span\u003e            \u003cspan class=\"c1\"\u003e# false\u003c/span\u003e\n\u003cspan class=\"mi\"\u003e0\u003c/span\u003e            \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"s\"\u003e\"0\"\u003c/span\u003e           \u003cspan class=\"c1\"\u003e# false\u003c/span\u003e\n\u003cspan class=\"no\"\u003efalse\u003c/span\u003e        \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"s\"\u003e\"false\"\u003c/span\u003e       \u003cspan class=\"c1\"\u003e# false\u003c/span\u003e\n\u003cspan class=\"no\"\u003efalse\u003c/span\u003e        \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"s\"\u003e\"0\"\u003c/span\u003e           \u003cspan class=\"c1\"\u003e# false\u003c/span\u003e\n\u003cspan class=\"no\"\u003efalse\u003c/span\u003e        \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"no\"\u003eundefined\u003c/span\u003e     \u003cspan class=\"c1\"\u003e# false\u003c/span\u003e\n\u003cspan class=\"no\"\u003efalse\u003c/span\u003e        \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"no\"\u003enull\u003c/span\u003e          \u003cspan class=\"c1\"\u003e# false\u003c/span\u003e\n\u003cspan class=\"no\"\u003enull\u003c/span\u003e         \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"no\"\u003eundefined\u003c/span\u003e     \u003cspan class=\"c1\"\u003e# false\u003c/span\u003e\n\u003cspan class=\"s\"\u003e\" \u003c/span\u003e\u003cspan class=\"se\"\u003e\\t\\r\\n\u003c/span\u003e\u003cspan class=\"s\"\u003e\"\u003c/span\u003e    \u003cspan class=\"o\"\u003e==\u003c/span\u003e   \u003cspan class=\"mi\"\u003e0\u003c/span\u003e             \u003cspan class=\"c1\"\u003e# false\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e引用元: \u003ca href=\"http://qiita.com/mugichan3/items/9462844b049900ffb22c\" class=\"autolink\" id=\"reference-bc6709913754ed2b37f0\"\u003ehttp://qiita.com/mugichan3/items/9462844b049900ffb22c\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003ejsの比較はかなり醜悪です。それはES2015でも(おそらく未来永劫)変わりません。\u003cbr\u003e\n代わりに\u003ccode\u003e===\u003c/code\u003eを使えばいいのですが、逆にうっかり\u003ccode\u003e==\u003c/code\u003eを使ってしまうとバグの元です。\u003cbr\u003e\nCoffeeScriptでは多くの言語と同じように\u003ccode\u003e==\u003c/code\u003eを素直に使えばいいので簡素です。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"coffeescriptはfunctionを--でかける\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#coffeescript%E3%81%AFfunction%E3%82%92--%E3%81%A7%E3%81%8B%E3%81%91%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCoffeeScriptは\u003ccode\u003efunction\u003c/code\u003eを\u003ccode\u003e-\u0026gt;\u003c/code\u003e, \u003ccode\u003e=\u0026gt;\u003c/code\u003eでかける\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ejs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ecreated\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecoffeescript\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ecreated\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003ejsでは関数を多用しますが、関数を定義するのに\u003ccode\u003efunction\u003c/code\u003eと書くのは長すぎます。\u003cbr\u003e\nES2015ではめでたく\u003ccode\u003efunction\u003c/code\u003eを\u003ccode\u003e=\u0026gt;\u003c/code\u003eとかけるようになりました。\u003cbr\u003e\nが、それは\u003ccode\u003ethis\u003c/code\u003eが関数が定義されたスコープにおける\u003ccode\u003ethis\u003c/code\u003eを引き継ぐ場合のみです。\u003cbr\u003e\n引き継ぎたくない場合はあいかわらす\u003ccode\u003efunction\u003c/code\u003eと書かなければなりません。\u003c/p\u003e\n\n\u003cp\u003eCoffeeScriptでは\u003ccode\u003ethis\u003c/code\u003eを引き継がない場合は\u003ccode\u003e-\u0026gt;\u003c/code\u003e、'this'を引き継ぐ場合は\u003ccode\u003e=\u0026gt;\u003c/code\u003eと書くことができます。\u003cbr\u003e\n簡潔で素晴らしいです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"coffeescriptはreturnが不要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#coffeescript%E3%81%AFreturn%E3%81%8C%E4%B8%8D%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCoffeeScriptは\u003ccode\u003ereturn\u003c/code\u003eが不要\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ejs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eel\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e#hoge\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eFOO\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ebar\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eBAR\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecomponent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epiyo\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eFOO\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ebar\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003eBAR\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecoffeescript\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \n    \u003cspan class=\"na\"\u003efoo\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'FOO'\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ebar\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'BAR'\u003c/span\u003e\n\n\u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecomponent\u003c/span\u003e \u003cspan class=\"s\"\u003e'piyo'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"na\"\u003efoo\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'FOO'\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ebar\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'BAR'\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003evue.jsにおいて、\u003ccode\u003edata\u003c/code\u003eは\u003ccode\u003eVue\u003c/code\u003eのインスタンスではオブジェクトなのに対して、componentはオブジェクトを返す関数を定義しなければなりません。\u003cbr\u003e\njsでは\u003ccode\u003efunction\u003c/code\u003eと書いた上、\u003ccode\u003ereturn\u003c/code\u003eも書かなければなりませんが、CoffeeScriptでは\u003ccode\u003e-\u0026gt;\u003c/code\u003eをつけるだけです。\u003cbr\u003e\n\u003ccode\u003eVue\u003c/code\u003eのインスタンスとcomponentでインデントが統一できてきれいです。\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"coffeescriptはオブジェクトにが不要\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#coffeescript%E3%81%AF%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AB%E3%81%8C%E4%B8%8D%E8%A6%81\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eCoffeeScriptはオブジェクトに\u003ccode\u003e,\u003c/code\u003eが不要\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ejs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emethods\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esayFoo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003eFOO\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esayBar\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003eBAR\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecoffeescript\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esayFoo\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elog\u003c/span\u003e \u003cspan class=\"s\"\u003e\"FOO\"\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esayBar\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elog\u003c/span\u003e \u003cspan class=\"s\"\u003e\"BAR\"\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003evue.jsではメソッドを上記のように定義します。\u003cbr\u003e\nここでメソッド\u003ccode\u003esayPiyo\u003c/code\u003eを追加したい時、どうするでしょうか？\u003cbr\u003e\n私はよく、\u003ccode\u003esayBar\u003c/code\u003eをコピペして次のように書いてしまいます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ejs\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emethods\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esayFoo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003eFOO\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esayBar\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003eBAR\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"c1\"\u003e// !!!\u003c/span\u003e\n    \u003cspan class=\"nl\"\u003esayPiyo\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003ePIYO\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eこれは怒られます。なぜなら\u003ccode\u003esayBar\u003c/code\u003eと\u003ccode\u003esayPiyo\u003c/code\u003eの間に\u003ccode\u003e,\u003c/code\u003eがないからです。\u003cbr\u003e\nキレそうになりますね。\u003cbr\u003e\nCoffeeScriptではこのようなことはありません。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ecoffeescript\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esayFoo\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elog\u003c/span\u003e \u003cspan class=\"s\"\u003e\"FOO\"\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esayBar\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elog\u003c/span\u003e \u003cspan class=\"s\"\u003e\"BAR\"\u003c/span\u003e\n    \u003cspan class=\"na\"\u003esayPiyo\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elog\u003c/span\u003e \u003cspan class=\"s\"\u003e\"PIYO\"\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eストレスフリー!\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e以上、思いついたことを書いてみました。\u003cbr\u003e\n最後までお読み頂きありがとうございます。\u003cbr\u003e\nよきCoffeeScriptライフを！\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"追記\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%BF%BD%E8%A8%98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e追記\u003c/h3\u003e\n\n\u003cp\u003eきたぜ! \u003ca href=\"http://coffeescript.org/v2/#\" rel=\"nofollow noopener\" target=\"_blank\"\u003eCoffeeScript2\u003c/a\u003e\u003cbr\u003e\n我がCoffeeScriptは永久に不滅だ!\u003c/p\u003e\n","body":"ES2015が登場してすっかりCoffeeScriptがオワコン化(オワコンという言葉自体がオワコンか?)した感があります。\n嫌いな言語ランキングでも無事3位にランクインされました(https://fossbytes.com/most-loved-and-most-hated-programming-languages/ )。\n\nCoffeeScriptはもう死んだ言語なのでしょうか?\nいえいえ、ES2015登場後もCoffeeScriptを使うメリットはあります。\nそこで、すっかり嫌われ者になってしまったCoffeeScriptのいいところを紹介したいと思います。\nちなみに、TypeScriptについては触れません(触ったことがないので)。\n\n### CoffeeScriptは`;`が不要\n21世紀にもなって`;`をつけないといけないのはかなり苦痛なのでこれは結構うれしいです。\n\n### CoffeeScriptは比較が厳密\n\n```js:js\n\"\"           ==   \"0\"           // false\n0            ==   \"\"            // true\n0            ==   \"0\"           // true\nfalse        ==   \"false\"       // false\nfalse        ==   \"0\"           // true\nfalse        ==   undefined     // false\nfalse        ==   null          // false\nnull         ==   undefined     // true\n\" \\t\\r\\n\"    ==   0             // true\n```\n\n```coffeescript:coffeescript\n\"\"           ==   \"0\"           # false\n0            ==   \"\"            # false\n0            ==   \"0\"           # false\nfalse        ==   \"false\"       # false\nfalse        ==   \"0\"           # false\nfalse        ==   undefined     # false\nfalse        ==   null          # false\nnull         ==   undefined     # false\n\" \\t\\r\\n\"    ==   0             # false\n```\n\n引用元: http://qiita.com/mugichan3/items/9462844b049900ffb22c\n\njsの比較はかなり醜悪です。それはES2015でも(おそらく未来永劫)変わりません。\n代わりに`===`を使えばいいのですが、逆にうっかり`==`を使ってしまうとバグの元です。\nCoffeeScriptでは多くの言語と同じように`==`を素直に使えばいいので簡素です。\n\n### CoffeeScriptは`function`を`-\u003e`, `=\u003e`でかける\n\n```js:js\nnew Vue({\n  created: function() {\n    return this.hoge();\n  }\n});\n```\n\n```coffeescript:coffeescript\nnew Vue\n  created: -\u003e\n    @hoge()\n```\n\njsでは関数を多用しますが、関数を定義するのに`function`と書くのは長すぎます。\nES2015ではめでたく`function`を`=\u003e`とかけるようになりました。\nが、それは`this`が関数が定義されたスコープにおける`this`を引き継ぐ場合のみです。\n引き継ぎたくない場合はあいかわらす`function`と書かなければなりません。\n\nCoffeeScriptでは`this`を引き継がない場合は`-\u003e`、'this'を引き継ぐ場合は`=\u003e`と書くことができます。\n簡潔で素晴らしいです。\n\n### CoffeeScriptは`return`が不要\n\n```js:js\nnew Vue({\n  el: '#hoge',\n  data: {\n    foo: 'FOO',\n    bar: 'BAR'\n  }\n});\n\nVue.component('piyo', {\n  data: function() {\n    return {\n      foo: 'FOO',\n      bar: 'BAR'\n    };\n  }\n});\n```\n\n```coffeescript:coffeescript\nnew Vue\n  data: \n    foo: 'FOO'\n    bar: 'BAR'\n\nVue.component 'piyo',\n  data: -\u003e\n    foo: 'FOO'\n    bar: 'BAR'\n```\n\nvue.jsにおいて、`data`は`Vue`のインスタンスではオブジェクトなのに対して、componentはオブジェクトを返す関数を定義しなければなりません。\njsでは`function`と書いた上、`return`も書かなければなりませんが、CoffeeScriptでは`-\u003e`をつけるだけです。\n`Vue`のインスタンスとcomponentでインデントが統一できてきれいです。\n\n### CoffeeScriptはオブジェクトに`,`が不要\n\n```js:js\nnew Vue({\n  methods: {\n    sayFoo: function() {\n      return console.log(\"FOO\");\n    },\n    sayBar: function() {\n      return console.log(\"BAR\");\n    }\n  }\n});\n```\n\n```coffeescript:coffeescript\nnew Vue\n  methods:\n    sayFoo: -\u003e\n      console.log \"FOO\"\n    sayBar: -\u003e\n      console.log \"BAR\"\n```\n\nvue.jsではメソッドを上記のように定義します。\nここでメソッド`sayPiyo`を追加したい時、どうするでしょうか？\n私はよく、`sayBar`をコピペして次のように書いてしまいます。\n\n```js:js\nnew Vue({\n  methods: {\n    sayFoo: function() {\n      return console.log(\"FOO\");\n    },\n    sayBar: function() {\n      return console.log(\"BAR\");\n    } // !!!\n    sayPiyo: function() {\n      return console.log(\"PIYO\");\n    }\n  }\n});\n```\nこれは怒られます。なぜなら`sayBar`と`sayPiyo`の間に`,`がないからです。\nキレそうになりますね。\nCoffeeScriptではこのようなことはありません。\n\n```coffeescript:coffeescript\nnew Vue\n  methods:\n    sayFoo: -\u003e\n      console.log \"FOO\"\n    sayBar: -\u003e\n      console.log \"BAR\"\n    sayPiyo: -\u003e\n      console.log \"PIYO\"\n```\n\nストレスフリー!\n\n---\n\n以上、思いついたことを書いてみました。\n最後までお読み頂きありがとうございます。\nよきCoffeeScriptライフを！\n\n### 追記\n\nきたぜ! [CoffeeScript2](http://coffeescript.org/v2/#)\n我がCoffeeScriptは永久に不滅だ!\n","coediting":false,"comments_count":2,"created_at":"2017-06-12T16:01:40+09:00","group":null,"id":"5469f09798372a673266","likes_count":28,"private":false,"reactions_count":0,"tags":[{"name":"CoffeeScript","versions":[]},{"name":"Vue.js","versions":[]}],"title":"CoffeeScriptは死んだのか? CoffeeScriptのいいところ(Vue.jsを例に)","updated_at":"2017-07-29T00:23:34+09:00","url":"https://qiita.com/isuke/items/5469f09798372a673266","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003ewerckerを使っていてローカルではテストが通るのにCIではコケる場合にデバッグする方法です。\u003cbr\u003e\nいづれの方法もテスト実行時の状態のdocker imageをローカルに持ってくる方法になります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"前提条件\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e前提条件　\u003c/h2\u003e\n\n\u003cp\u003eローカルでdockerが使えること。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"方法1-ローカルでciを実行する\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%B9%E6%B3%951-%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A7ci%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e方法1: ローカルでCIを実行する\u003c/h2\u003e\n\n\u003cp\u003ewercker cliをつかってローカルでCIを実行する方法です。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"wercker-cliのインストールmac\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#wercker-cli%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%ABmac\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ewercker cliのインストール(Mac)\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebrew tap wercker/wercker\nbrew install wercker-cli\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"実行\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行\u003c/h4\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ewercker build --no-remove\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e--no-remove\u003c/code\u003eをつけるとdocker containerが残るので　containerに入ってデバッグします。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"方法2-werckerでbuildしたimageをpullする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%B9%E6%B3%952-wercker%E3%81%A7build%E3%81%97%E3%81%9Fimage%E3%82%92pull%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e方法2: werckerでbuildしたimageをpullする\u003c/h2\u003e\n\n\u003cp\u003ewercker上でbuildしたimageをpullする方法です。\u003cbr\u003e\n方法1と同様にwercker ciを使います。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"werckeryml\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#werckeryml\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ewercker.yml\u003c/h4\u003e\n\n\u003cp\u003e以下を追加します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"yaml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewercker.yml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"na\"\u003ebuild\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eafter-steps\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"pi\"\u003e-\u003c/span\u003e \u003cspan class=\"s\"\u003einternal/store-container\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"wercker-pull\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#wercker-pull\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ewercker pull\u003c/h3\u003e\n\n\u003cp\u003ewercker上でbuildが走ったあとに以下のコマンドでpullできます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ewercker login\nwercker pull isule/test\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003egithubのアカウントを使っていてログインできない、ってひとは\u003ca href=\"https://skatsuta.github.io/2015/07/21/wercker-github-login/\" rel=\"nofollow noopener\" target=\"_blank\"\u003eこちら\u003c/a\u003eを参照ください。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"方法3-werckerでbuildしたimageをdockerhubにpushする\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%96%B9%E6%B3%953-wercker%E3%81%A7build%E3%81%97%E3%81%9Fimage%E3%82%92dockerhub%E3%81%ABpush%E3%81%99%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e方法3: werckerでbuildしたimageをdockerhubにpushする\u003c/h2\u003e\n\n\u003cp\u003e方法2は自分の環境では以下のエラーになって実行できませんでした。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003eERROR No finished builds found for this application\nFATAL Exiting.\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eそんなときはwerckerでbuildしたimageをdockerhubにpushしましょう。\u003c/p\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"werckeryml-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#werckeryml-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003ewercker.yml\u003c/h4\u003e\n\n\u003cp\u003e以下を追加します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"yaml\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewercker.yml\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"na\"\u003ebuild\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eafter-steps\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"pi\"\u003e-\u003c/span\u003e \u003cspan class=\"s\"\u003einternal/docker-push\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eusername\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e$DOCKER_HUB_USERNAME\u003c/span\u003e\n            \u003cspan class=\"na\"\u003epassword\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e$DOCKER_HUB_PASSWORD\u003c/span\u003e\n            \u003cspan class=\"na\"\u003etag\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003edebug\u003c/span\u003e\n            \u003cspan class=\"na\"\u003erepository\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003emy/repository\u003c/span\u003e \u003cspan class=\"c1\"\u003e#適宜変更\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eregistry\u003c/span\u003e\u003cspan class=\"pi\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003ehttps://registry.hub.docker.com\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eDOCKER_HUB_USERNAME\u003c/code\u003eと\u003ccode\u003eDOCKER_HUB_PASSWORD\u003c/code\u003eを環境変数に追加します。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fd2fd9f22-0c11-d42b-7279-ba1eabbb91c3.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a07e73ed7c5d7ca95eab685dd9c57420\" target=\"_blank\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fd2fd9f22-0c11-d42b-7279-ba1eabbb91c3.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;s=a07e73ed7c5d7ca95eab685dd9c57420\" alt=\"image.png\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/152997/d2fd9f22-0c11-d42b-7279-ba1eabbb91c3.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F152997%2Fd2fd9f22-0c11-d42b-7279-ba1eabbb91c3.png?ixlib=rb-1.2.2\u0026amp;auto=format\u0026amp;gif-q=60\u0026amp;q=75\u0026amp;w=1400\u0026amp;fit=max\u0026amp;s=07e881479773bf1bb9f2a425197637ee 1x\" loading=\"lazy\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"実行-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%AE%9F%E8%A1%8C-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e実行\u003c/h3\u003e\n\n\u003cp\u003ebuildを実行すればdockerhubにpushされるはず。\u003c/p\u003e\n\n\u003cp\u003e以上です。\u003c/p\u003e\n","body":"werckerを使っていてローカルではテストが通るのにCIではコケる場合にデバッグする方法です。\nいづれの方法もテスト実行時の状態のdocker imageをローカルに持ってくる方法になります。\n\n## 前提条件　\n\nローカルでdockerが使えること。\n\n## 方法1: ローカルでCIを実行する\n\nwercker cliをつかってローカルでCIを実行する方法です。\n\n#### wercker cliのインストール(Mac)\n\n```\nbrew tap wercker/wercker\nbrew install wercker-cli\n```\n\n#### 実行\n\n```\nwercker build --no-remove\n```\n\n`--no-remove`をつけるとdocker containerが残るので　containerに入ってデバッグします。\n\n## 方法2: werckerでbuildしたimageをpullする\n\nwercker上でbuildしたimageをpullする方法です。\n方法1と同様にwercker ciを使います。\n\n#### wercker.yml\n\n以下を追加します。\n\n```yaml:wercker.yml\nbuild:\n  after-steps:\n    - internal/store-container\n```\n\n### wercker pull\n\nwercker上でbuildが走ったあとに以下のコマンドでpullできます。\n\n```\nwercker login\nwercker pull isule/test\n```\n\ngithubのアカウントを使っていてログインできない、ってひとは[こちら](https://skatsuta.github.io/2015/07/21/wercker-github-login/)を参照ください。\n\n## 方法3: werckerでbuildしたimageをdockerhubにpushする\n\n方法2は自分の環境では以下のエラーになって実行できませんでした。\n\n```\nERROR No finished builds found for this application\nFATAL Exiting.\n```\n\nそんなときはwerckerでbuildしたimageをdockerhubにpushしましょう。\n\n#### wercker.yml\n\n以下を追加します。\n\n\n```yaml:wercker.yml\nbuild:\n    after-steps:\n        - internal/docker-push:\n            username: $DOCKER_HUB_USERNAME\n            password: $DOCKER_HUB_PASSWORD\n            tag: debug\n            repository: my/repository #適宜変更\n            registry: https://registry.hub.docker.com\n```\n\n`DOCKER_HUB_USERNAME`と`DOCKER_HUB_PASSWORD`を環境変数に追加します。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/152997/d2fd9f22-0c11-d42b-7279-ba1eabbb91c3.png)\n\n### 実行\n\nbuildを実行すればdockerhubにpushされるはず。\n\n以上です。\n","coediting":false,"comments_count":0,"created_at":"2017-05-18T01:18:09+09:00","group":null,"id":"4259c659014016475639","likes_count":6,"private":false,"reactions_count":0,"tags":[{"name":"CI","versions":[]},{"name":"wercker","versions":[]}],"title":"werckerを使っていてローカルではテストが通るのにCIではコケる場合にデバッグする3つの方法","updated_at":"2017-05-18T01:18:09+09:00","url":"https://qiita.com/isuke/items/4259c659014016475639","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\n\u003ch1\u003e\n\u003cspan id=\"1-サーバーサイド作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#1-%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%82%B5%E3%82%A4%E3%83%89%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e1. サーバーサイド作成\u003c/h1\u003e\n\n\u003cp\u003eまずはいつもの感じでディレクトリを作って\u003ccode\u003ebundle init\u003c/code\u003eしましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003emkdir sample-app\ncd sample-app\nbundle init\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eGemfile\u003c/code\u003eは以下のように。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eGemfile\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003esource\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"https://rubygems.org\"\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eruby\u003c/span\u003e \u003cspan class=\"s1\"\u003e'2.3.3'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'~\u0026gt; 1.4'\u003c/span\u003e\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra-contrib'\u003c/span\u003e\n\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'slim'\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003evendor/bundle\u003c/code\u003eにインストールします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ebundle install --path=vendor/bundle\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e忘れずに\u003ccode\u003e.gitignore\u003c/code\u003eに\u003ccode\u003e/vendor\u003c/code\u003eを追加。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.gitignore\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e/vendor\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e準備が整ったので早速アプリを作っていきましょう。\u003cbr\u003e\nといっても以下のファイルを置くだけ。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eapp.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'sinatra/reloader'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'rabl'\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eget\u003c/span\u003e \u003cspan class=\"s1\"\u003e'/'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eslim\u003c/span\u003e \u003cspan class=\"ss\"\u003e:app\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"slim\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003eviews/app.slim\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nn\"\u003edoctype\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003ehtml\n\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003ehead\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003etitle\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003esample\u003cspan class=\"w\"\u003e \u003c/span\u003eapp\n    \u003cspan class=\"nt\"\u003escript\u003c/span\u003e[\u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"text/javascript\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"bundle.js\"\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"na\"\u003echarset\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"utf-8\"\u003c/span\u003e]\n  \u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\n    \u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003eHELLO!\n    \u003cspan class=\"nf\"\u003e#app\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003ep\u003c/span\u003e[\u003cspan class=\"na\"\u003ev-text\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\"massege\"\u003c/span\u003e]\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003ebundle.js\u003c/code\u003eはこのあと作成するファイルです。\u003c/p\u003e\n\n\u003cp\u003eこの時点で\u003ccode\u003ebundle exec ruby app.rb\u003c/code\u003eして\u003ca href=\"http://localhost:4567/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://localhost:4567/\u003c/a\u003e を開けば\u003ccode\u003eHELLO!\u003c/code\u003eと表示されるはずです。\u003c/p\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"2-フロントサイド作成\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#2-%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%B5%E3%82%A4%E3%83%89%E4%BD%9C%E6%88%90\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e2. フロントサイド作成\u003c/h1\u003e\n\n\u003cp\u003e今回はyarnを使います。\u003cbr\u003e\n以下のものをインストール。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003eyarn init\nyarn add webpack vue coffee-script coffee-loader\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003ewebpackのversion 4以降を使う場合は別途\u003ccode\u003ewebpack-cli\u003c/code\u003eも必要です(Thank you \u003ca href=\"/tamano\" class=\"user-mention js-hovercard\" title=\"tamano\" data-hovercard-target-type=\"user\" data-hovercard-target-name=\"tamano\"\u003e@tamano\u003c/a\u003e)。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003eyarn add webpack-cli\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003ewebpack.config.js\u003c/code\u003eを作成しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003ewebpack.config.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eexports\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eentry\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e./frontend/main.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eoutput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003epath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003epublic\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003efilename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003ebundle.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eloaders\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"na\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"sr\"\u003e/\u003c/span\u003e\u003cspan class=\"se\"\u003e\\.\u003c/span\u003e\u003cspan class=\"sr\"\u003ecoffee$/\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eloader\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003ecoffee-loader\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eresolve\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eextenstions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"dl\"\u003e''\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e.json\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e.html\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n    \u003cspan class=\"na\"\u003ealias\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue$\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003evue/dist/vue.common.js\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eだいたいこんなことが書いてあります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eentry\u003c/code\u003eと\u003ccode\u003eoutput\u003c/code\u003e:\u003ccode\u003e./frontend/main.js\u003c/code\u003eを\u003ccode\u003e./public/bundle.js\u003c/code\u003eにビルド\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eloaders\u003c/code\u003e: \u003ccode\u003e.coffee\u003c/code\u003eファイルは\u003ccode\u003ecoffee-loader\u003c/code\u003eを使ってコンパイル\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eextenstions\u003c/code\u003e: \u003ccode\u003erequire\u003c/code\u003e(後述)するときにこの拡張子は省略できるよ\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ealias\u003c/code\u003e: vueを使うときのおまじない。詳しくは\u003ca href=\"https://jp.vuejs.org/v2/guide/installation.html#%E3%82%B9%E3%82%BF%E3%83%B3%E3%83%89%E3%82%A2%E3%83%AD%E3%83%B3-vs-%E3%83%A9%E3%83%B3%E3%82%BF%E3%82%A4%E3%83%A0%E9%99%90%E5%AE%9A%E3%83%93%E3%83%AB%E3%83%89\" rel=\"nofollow noopener\" target=\"_blank\"\u003e公式参照\u003c/a\u003e。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e\u003ccode\u003e./frontend/main.js\u003c/code\u003eを作っていきましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003efrontend/main.js\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"s1\"\u003e./app.coffee\u003c/span\u003e\u003cspan class=\"dl\"\u003e'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003emain.jsというのがビルドしたときのエンドポイントになるので、ここに必要なファイルをどんどん\u003ccode\u003erequire\u003c/code\u003eしていきます。\u003cbr\u003e\n今回は\u003ccode\u003eapp.coffee\u003c/code\u003eというのを作ります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003efrontend/app.coffee\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003eVue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'vue'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003ewindow\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eapp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eel\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'#app'\u003c/span\u003e\n  \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"na\"\u003emessage\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"hello vue!\"\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003e以下のコマンドでビルドします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003ewebpack\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれで\u003ccode\u003epublic/bundle.js\u003c/code\u003eができているはずです。\u003c/p\u003e\n\n\u003cp\u003eここで\u003ca href=\"http://localhost:4567/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttp://localhost:4567/\u003c/a\u003e を開けば\u003ccode\u003ehello vue\u003c/code\u003eと表示されるはずです。\u003c/p\u003e\n\n\u003cp\u003e忘れずに\u003ccode\u003e.gitignore\u003c/code\u003eに\u003ccode\u003e/node_modules\u003c/code\u003eと\u003ccode\u003e/public\u003c/code\u003eを追加します。\u003cbr\u003e\n\u003ccode\u003e/public\u003c/code\u003eはgitに入れるケースも有るのですが、今回はgitで管理しないことにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003e.gitignore\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e/vendor\n/node_modules\n/public\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eここらでコミットを\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003egit add .\ngit commit -m \"Initial commit\"\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch1\u003e\n\u003cspan id=\"3-herokuにアップ\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#3-heroku%E3%81%AB%E3%82%A2%E3%83%83%E3%83%97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e3. Herokuにアップ!\u003c/h1\u003e\n\n\u003cp\u003eherokuにappを作成しましょう。\u003cbr\u003e\n作成部分は省略します。\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eここからが一番言いたかったこと\u003c/strong\u003e\u003cbr\u003e\nHeroku上でwebpackを実行するためにbuildpackにnodejsを追加しましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003eheroku buildpacks:clear\nheroku buildpacks:set heroku/nodejs\nheroku buildpacks:add heroku/ruby --index 2\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003e--index 2\u003c/code\u003eはnodejsのあとでrubyをビルドするよってことです(なくてもいいかもしれません)。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003epackage.json\u003c/code\u003eに下記を追加しましよう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"js\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003epackage.json\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e  \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003escripts\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003eheroku-postbuild\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\u003cspan class=\"s2\"\u003ewebpack -p\u003c/span\u003e\u003cspan class=\"dl\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cp\u003eあとはpushするだけ。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003egit push heroku master\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eお疲れ様でした！\u003c/p\u003e\n","body":"# 1. サーバーサイド作成\n\nまずはいつもの感じでディレクトリを作って`bundle init`しましょう。\n\n```\nmkdir sample-app\ncd sample-app\nbundle init\n```\n\n`Gemfile`は以下のように。\n\n```rb:Gemfile\nsource \"https://rubygems.org\"\n\nruby '2.3.3'\n\ngem 'sinatra', '~\u003e 1.4'\ngem 'sinatra-contrib'\ngem 'slim'\n```\n\n`vendor/bundle`にインストールします。\n\n```\nbundle install --path=vendor/bundle\n```\n\n忘れずに`.gitignore`に`/vendor`を追加。\n\n```text:.gitignore\n/vendor\n```\n\n準備が整ったので早速アプリを作っていきましょう。\nといっても以下のファイルを置くだけ。\n\n```rb:app.rb\nrequire 'sinatra'\nrequire 'sinatra/reloader'\nrequire 'rabl'\n\nget '/' do\n  slim :app\nend\n```\n\n```slim:views/app.slim\ndoctype html\nhtml\n  head\n    title sample app\n    script[type=\"text/javascript\" src=\"bundle.js\" charset=\"utf-8\"]\n  body\n    h1 HELLO!\n    #app\n      p[v-text=\"massege\"]\n```\n\n`bundle.js`はこのあと作成するファイルです。\n\nこの時点で`bundle exec ruby app.rb`してhttp://localhost:4567/ を開けば`HELLO!`と表示されるはずです。\n\n# 2. フロントサイド作成\n\n今回はyarnを使います。\n以下のものをインストール。\n\n```\nyarn init\nyarn add webpack vue coffee-script coffee-loader\n```\n\nwebpackのversion 4以降を使う場合は別途`webpack-cli`も必要です(Thank you @tamano)。\n\n```\nyarn add webpack-cli\n```\n\n`webpack.config.js`を作成しましょう。\n\n```js:webpack.config.js\nmodule.exports = {\n  entry: './frontend/main.js',\n  output: {\n    path: 'public',\n    filename: 'bundle.js'\n  },\n  module: {\n    loaders: [\n      { test: /\\.coffee$/, loader: \"coffee-loader\" }\n    ]\n  },\n  resolve: {\n    extenstions: ['', '.js', '.json', '.html'],\n    alias: {\n      'vue$': 'vue/dist/vue.common.js'\n    }\n  }\n};\n```\n\nだいたいこんなことが書いてあります。\n\n- `entry`と`output`:`./frontend/main.js`を`./public/bundle.js`にビルド\n- `loaders`: `.coffee`ファイルは`coffee-loader`を使ってコンパイル\n- `extenstions`: `require`(後述)するときにこの拡張子は省略できるよ\n- `alias`: vueを使うときのおまじない。詳しくは[公式参照](https://jp.vuejs.org/v2/guide/installation.html#スタンドアロン-vs-ランタイム限定ビルド)。\n\n`./frontend/main.js`を作っていきましょう。\n\n```js:frontend/main.js\nrequire('./app.coffee')\n```\n\nmain.jsというのがビルドしたときのエンドポイントになるので、ここに必要なファイルをどんどん`require`していきます。\n今回は`app.coffee`というのを作ります。\n\n```coffeescript:frontend/app.coffee\nVue = require('vue')\n\nwindow.app = new Vue\n  el: '#app'\n  data:\n    message: \"hello vue!\"\n```\n\n以下のコマンドでビルドします。\n\n```\nwebpack\n```\n\nこれで`public/bundle.js`ができているはずです。\n\nここでhttp://localhost:4567/ を開けば`hello vue`と表示されるはずです。\n\n忘れずに`.gitignore`に`/node_modules`と`/public`を追加します。\n`/public`はgitに入れるケースも有るのですが、今回はgitで管理しないことにします。\n\n```text:.gitignore\n/vendor\n/node_modules\n/public\n```\n\nここらでコミットを\n\n```\ngit add .\ngit commit -m \"Initial commit\"\n```\n\n# 3. Herokuにアップ!\n\nherokuにappを作成しましょう。\n作成部分は省略します。\n\n**ここからが一番言いたかったこと**\nHeroku上でwebpackを実行するためにbuildpackにnodejsを追加しましょう。\n\n```\nheroku buildpacks:clear\nheroku buildpacks:set heroku/nodejs\nheroku buildpacks:add heroku/ruby --index 2\n```\n\n`--index 2`はnodejsのあとでrubyをビルドするよってことです(なくてもいいかもしれません)。\n\n`package.json`に下記を追加しましよう。\n\n```js:package.json\n  \"scripts\": {\n    \"heroku-postbuild\": \"webpack -p\"\n  }\n```\n\nあとはpushするだけ。\n\n```\ngit push heroku master\n```\n\nお疲れ様でした！\n","coediting":false,"comments_count":0,"created_at":"2017-01-30T21:29:08+09:00","group":null,"id":"6597f11bbd09cd0f5157","likes_count":8,"private":false,"reactions_count":0,"tags":[{"name":"Sinatra","versions":[]},{"name":"Heroku","versions":[]},{"name":"Vue.js","versions":[]},{"name":"webpack","versions":[]}],"title":"sinatra+vue+webpackで作成したアプリをHerokuで公開する(初心者向け)","updated_at":"2018-09-28T19:15:39+09:00","url":"https://qiita.com/isuke/items/6597f11bbd09cd0f5157","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e\u003ca href=\"http://qiita.com/isuke/items/471bb5672af6e761032c\" id=\"reference-0186bcacb9f0f33a5985\"\u003eこちら\u003c/a\u003eのクイズの答えと解説(?)です。\u003c/p\u003e\n\n\u003cp\u003eruby 2.3.0で動作確認しています。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ1\u003c/h2\u003e\n\n\u003cp\u003eAの出力結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{})\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efoo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:foo\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"foo is \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003efoo\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"options is \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"ss\"\u003efoo: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'FOO'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ebar: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'BAR'\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; A\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"答え\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AD%94%E3%81%88\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e答え\u003c/h3\u003e\n\n\u003cp\u003eAの出力結果 : \u003ccode\u003e{:bar=\u0026gt;\"BAR\"}\u003c/code\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"解説\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h3\u003e\n\n\u003cp\u003erubyは参照の値渡しを行いますので、引数を受け取った先(\u003ccode\u003e#hoge\u003c/code\u003e)で引数の破壊的な変更を行うと、\u003cbr\u003e\nメソッドの呼び出しもとに影響があります。\u003cbr\u003e\n\u003ccode\u003e#deelte\u003c/code\u003eは\u003ccode\u003e!\u003c/code\u003eはついていませんが破壊的メソッドなので注意です。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ2\u003c/h2\u003e\n\n\u003cp\u003eA, Bの出力結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eINIT_STR\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e'INIT STR:'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eINIT_STR\u003c/span\u003e\n  \u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etimes\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\" \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"n\"\u003etemp\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; A\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; B\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"答え-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AD%94%E3%81%88-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e答え\u003c/h3\u003e\n\n\u003cp\u003eAの出力結果 : \u003ccode\u003eINIT STR: 0 1 2\u003c/code\u003e\u003cbr\u003e\nBの出力結果 : \u003ccode\u003eINIT STR: 0 1 2 0 1 2\u003c/code\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"解説-1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC-1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h3\u003e\n\n\u003cp\u003erubyは定数を書き換えてもエラーになりません。\u003cbr\u003e\n\u003ccode\u003e\u0026lt;\u0026lt;\u003c/code\u003eメソッドでは値を書き換えてしまうので、このクイズの場合、実行するたびに\u003ccode\u003eINIT_STR\u003c/code\u003eが書き代わってしまします。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e#freeze\u003c/code\u003eをつけておくと定数の変更はできなくなるので、必ず付けるようにすると良いでしょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eINIT_STR\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e'INIT STR:'\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efreeze\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ3\u003c/h2\u003e\n\n\u003cp\u003eAの出力結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{},\u003c/span\u003e \u003cspan class=\"ss\"\u003efoo: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'FOO'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003efoo\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ebar: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003efoo: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'foo'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; A\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"答え-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AD%94%E3%81%88-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e答え\u003c/h3\u003e\n\n\u003cp\u003eAの出力結果 : `\u003ccode\u003ehoge': unknown keyword: bar (ArgumentError)\u003c/code\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"解説-2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC-2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h3\u003e\n\n\u003cp\u003e詳しく追っていないのですが、デフォルト引数とキーワード引数を併用するときは注意。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ4\u003c/h2\u003e\n\n\u003cp\u003eA〜Hの実行結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e            \u003cspan class=\"c1\"\u003e# =\u0026gt; A\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e          \u003cspan class=\"c1\"\u003e# =\u0026gt; B\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e([])\u003c/span\u003e           \u003cspan class=\"c1\"\u003e# =\u0026gt; C\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e           \u003cspan class=\"c1\"\u003e# =\u0026gt; D\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e        \u003cspan class=\"c1\"\u003e# =\u0026gt; E\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e      \u003cspan class=\"c1\"\u003e# =\u0026gt; F\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_i\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; G\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e([])\u003c/span\u003e       \u003cspan class=\"c1\"\u003e# =\u0026gt; H\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"答え-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AD%94%E3%81%88-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e答え\u003c/h3\u003e\n\n\u003cp\u003eAの出力結果 : [1]\u003cbr\u003e\nBの出力結果 : []\u003cbr\u003e\nCの出力結果 : []\u003cbr\u003e\nDの出力結果 : []\u003cbr\u003e\nEの出力結果 : [nil]\u003cbr\u003e\nFの出力結果 : \u003ccode\u003eno implicit conversion from nil to integer (TypeError)\u003c/code\u003e\u003cbr\u003e\nGの出力結果 : []\u003cbr\u003e\nHの出力結果 : []\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"解説-3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC-3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eArray\u003c/code\u003eメソッドは引数で受け取った値を値として持つ配列を返します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; [\"test\"]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e引数の値はすでに配列の場合はそのまま返します。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; [\"test\"]\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ccode\u003eArray.new\u003c/code\u003eは受け取った第1引数の数だけ、第2引数の値を持つ配列を返します。第2引数のデフォルト値はnilです。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003eArray.new(3) # =\u0026gt; [nil, nil, nil]\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eちなみに\u003ccode\u003enil.to_i\u003c/code\u003eは0になります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ5\u003c/h2\u003e\n\n\u003cp\u003eAの実行結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHoge\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efoo\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebar\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"kp\"\u003eprivate\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ebar\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efoo\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; A\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"答え-4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AD%94%E3%81%88-4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e答え\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003eprivate method\u003c/code\u003ebar' called for #\u003ca class=\"autolink\"\u003eHoge:0x007fe96a07cde8\u003c/a\u003e (NoMethodError)`\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"解説-4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC-4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h3\u003e\n\n\u003cp\u003erubyのprivateメソッドは「レシーバを指定して実行できない」メソッドなので、たとえ\u003ccode\u003eself\u003c/code\u003eでも付けることはできません。\u003cbr\u003e\n初学者が引っかかりやすいので注意。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ6\u003c/h2\u003e\n\n\u003cp\u003eAの実行結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHoge\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eattr_accessor\u003c/span\u003e \u003cspan class=\"ss\"\u003e:foo\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@foo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efoo\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"vi\"\u003e@foo\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; A\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"答え-5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AD%94%E3%81%88-5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e答え\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003ewrong number of arguments (given 1, expected 0) (ArgumentError)\u003c/code\u003e\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"解説-5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC-5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h3\u003e\n\n\u003cp\u003e2行目に余計な\u003ccode\u003e,\u003c/code\u003eがついているのでエラーになるのですが、何故かエラー箇所が10行目になります。\u003cbr\u003e\nなんででしょうね。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ7\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ7\u003c/h2\u003e\n\n\u003cp\u003eA, Bの実行結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehoge\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003esleep\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"c1\"\u003e# 重い処理\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e'hoge'\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eresult1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eresult1\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; A\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eresult2\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eresult2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ehoge\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; B\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"答え-6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E7%AD%94%E3%81%88-6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e答え\u003c/h3\u003e\n\n\u003cp\u003eAの実行結果 : hoge\u003cbr\u003e\nBの実行結果 : undefined local variable or method `result2' for main:Object (NameError)\u003c/p\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"解説-6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%A7%A3%E8%AA%AC-6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e解説\u003c/h3\u003e\n\n\u003cp\u003eifをインラインで書いたときのそうでないときにスコープが若干違うようです。\u003cbr\u003e\nインラインで書いたときにはifの条件式で新しく定義した変数は他で使えないようです。\u003c/p\u003e\n\n\u003cp\u003e詳しい理由を\u003ca href=\"https://ja.stackoverflow.com/questions/44291/ruby%E3%81%AEinline-if-%E3%81%AEscope%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6\" rel=\"nofollow noopener\" target=\"_blank\"\u003estackoverflowで教えてもらいました\u003c/a\u003e(1年越しの追記)。\u003c/p\u003e\n","body":"[こちら](http://qiita.com/isuke/items/471bb5672af6e761032c)のクイズの答えと解説(?)です。\n\nruby 2.3.0で動作確認しています。\n\n## クイズ1\n\nAの出力結果は何でしょう?\n\n```ruby\ndef hoge(options = {})\n  foo = options.delete(:foo)\n  puts \"foo is #{foo}\"\n  puts \"options is #{options}\"\nend\n\noptions = {foo: 'FOO', bar: 'BAR'}\nhoge(options)\nputs options #=\u003e A\n```\n### 答え\n\nAの出力結果 : `{:bar=\u003e\"BAR\"}`\n\n### 解説\n\nrubyは参照の値渡しを行いますので、引数を受け取った先(`#hoge`)で引数の破壊的な変更を行うと、\nメソッドの呼び出しもとに影響があります。\n`#deelte`は`!`はついていませんが破壊的メソッドなので注意です。\n\n## クイズ2\n\nA, Bの出力結果は何でしょう?\n\n```ruby\nINIT_STR = 'INIT STR:'\n\ndef hoge(num)\n  temp = INIT_STR\n  num.times do |n|\n    temp \u003c\u003c \" #{n}\"\n  end\n  temp\nend\n\nputs hoge(3) #=\u003e A\nputs hoge(3) #=\u003e B\n```\n\n### 答え\n\nAの出力結果 : `INIT STR: 0 1 2`\nBの出力結果 : `INIT STR: 0 1 2 0 1 2`\n\n### 解説\n\nrubyは定数を書き換えてもエラーになりません。\n`\u003c\u003c`メソッドでは値を書き換えてしまうので、このクイズの場合、実行するたびに`INIT_STR`が書き代わってしまします。\n\n`#freeze`をつけておくと定数の変更はできなくなるので、必ず付けるようにすると良いでしょう。\n\n```ruby\nINIT_STR = 'INIT STR:'.freeze\n```\n\n## クイズ3\n\nAの出力結果は何でしょう?\n\n```ruby\ndef hoge(options = {}, foo: 'FOO')\n  puts options\n  puts foo\nend\n\nhoge(bar: 'bar', foo: 'foo') #=\u003e A\n```\n\n### 答え\n\nAの出力結果 : ``hoge': unknown keyword: bar (ArgumentError)`\n\n### 解説\n\n詳しく追っていないのですが、デフォルト引数とキーワード引数を併用するときは注意。\n\n## クイズ4\n\nA〜Hの実行結果は何でしょう?\n\n```ruby\nArray(1)            # =\u003e A\nArray(nil)          # =\u003e B\nArray([])           # =\u003e C\nArray.new           # =\u003e D\nArray.new(1)        # =\u003e E\nArray.new(nil)      # =\u003e F\nArray.new(nil.to_i) # =\u003e G\nArray.new([])       # =\u003e H\n```\n\n### 答え\n\nAの出力結果 : [1]\nBの出力結果 : []\nCの出力結果 : []\nDの出力結果 : []\nEの出力結果 : [nil]\nFの出力結果 : `no implicit conversion from nil to integer (TypeError)`\nGの出力結果 : []\nHの出力結果 : []\n\n### 解説\n\n`Array`メソッドは引数で受け取った値を値として持つ配列を返します。\n\n```ruby\nArray(\"test\") #=\u003e [\"test\"]\n```\n\n引数の値はすでに配列の場合はそのまま返します。\n\n```ruby\nArray([\"test\"]) #=\u003e [\"test\"]\n```\n\n`Array.new`は受け取った第1引数の数だけ、第2引数の値を持つ配列を返します。第2引数のデフォルト値はnilです。\n\n```\nArray.new(3) # =\u003e [nil, nil, nil]\n```\n\nちなみに`nil.to_i`は0になります。\n\n## クイズ5\n\nAの実行結果は何でしょう?\n\n```ruby\nclass Hoge\n  def foo\n    self.bar\n  end\n\nprivate\n\n  def bar\n    puts 'bar'\n  end\nend\n\nHoge.new.foo # =\u003e A\n```\n\n### 答え\n\n`private method `bar' called for #\u003cHoge:0x007fe96a07cde8\u003e (NoMethodError)`\n\n### 解説\n\nrubyのprivateメソッドは「レシーバを指定して実行できない」メソッドなので、たとえ`self`でも付けることはできません。\n初学者が引っかかりやすいので注意。\n\n## クイズ6\n\nAの実行結果は何でしょう?\n\n```ruby\nclass Hoge\n  attr_accessor :foo,\n\n  def initialize(foo)\n    @foo = foo\n    puts @foo\n  end\nend\n\nHoge.new('bar') # =\u003e A\n```\n\n### 答え\n\n`wrong number of arguments (given 1, expected 0) (ArgumentError)`\n\n### 解説\n\n2行目に余計な`,`がついているのでエラーになるのですが、何故かエラー箇所が10行目になります。\nなんででしょうね。\n\n## クイズ7\n\nA, Bの実行結果は何でしょう?\n\n```ruby\ndef hoge\n  sleep 1 # 重い処理\n  'hoge'\nend\n\nif result1 = hoge\n  puts result1 # =\u003e A\nend\nputs result2 if result2 = hoge # =\u003e B\n```\n\n### 答え\n\nAの実行結果 : hoge\nBの実行結果 : undefined local variable or method `result2' for main:Object (NameError)\n\n### 解説\n\nifをインラインで書いたときのそうでないときにスコープが若干違うようです。\nインラインで書いたときにはifの条件式で新しく定義した変数は他で使えないようです。\n\n詳しい理由を[stackoverflowで教えてもらいました](https://ja.stackoverflow.com/questions/44291/ruby%E3%81%AEinline-if-%E3%81%AEscope%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6)(1年越しの追記)。\n\n","coediting":false,"comments_count":2,"created_at":"2016-12-12T18:19:49+09:00","group":null,"id":"b8cc8fb5804fb522cb3f","likes_count":3,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]}],"title":"Rubyクイズ 答えと解説","updated_at":"2018-05-28T00:38:55+09:00","url":"https://qiita.com/isuke/items/b8cc8fb5804fb522cb3f","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003e自分が実際に業務でRubyを書いていてハマったところ、ハマりかけたところ、あるいは初心者がつまづきやすいところをクイズにしてみました。\u003cbr\u003e\n皆さん、実行せずに答えられますか?\u003c/p\u003e\n\n\u003cp\u003e答えは\u003ca href=\"http://qiita.com/isuke/items/b8cc8fb5804fb522cb3f\" id=\"reference-d2c240f58e961c5f318e\"\u003eこちら\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA1\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ1\u003c/h2\u003e\n\n\u003cp\u003eAの出力結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{})\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efoo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:foo\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"foo is \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003efoo\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"options is \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"ss\"\u003efoo: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'FOO'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ebar: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'BAR'\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; A\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA2\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ2\u003c/h2\u003e\n\n\u003cp\u003eA, Bの出力結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eINIT_STR\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e'INIT STR:'\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eINIT_STR\u003c/span\u003e\n  \u003cspan class=\"n\"\u003enum\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etimes\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etemp\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\" \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003en\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"n\"\u003etemp\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; A\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; B\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA3\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ3\u003c/h2\u003e\n\n\u003cp\u003eAの出力結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eoptions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{},\u003c/span\u003e \u003cspan class=\"ss\"\u003efoo: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'FOO'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eoptions\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003efoo\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ebar: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003efoo: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'foo'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e#=\u0026gt; A\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA4\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ4\u003c/h2\u003e\n\n\u003cp\u003eA〜Hの実行結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e            \u003cspan class=\"c1\"\u003e# =\u0026gt; A\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e          \u003cspan class=\"c1\"\u003e# =\u0026gt; B\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e([])\u003c/span\u003e           \u003cspan class=\"c1\"\u003e# =\u0026gt; C\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e           \u003cspan class=\"c1\"\u003e# =\u0026gt; D\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e        \u003cspan class=\"c1\"\u003e# =\u0026gt; E\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e      \u003cspan class=\"c1\"\u003e# =\u0026gt; F\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kp\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto_i\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; G\u003c/span\u003e\n\u003cspan class=\"no\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e([])\u003c/span\u003e       \u003cspan class=\"c1\"\u003e# =\u0026gt; H\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA5\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ5\u003c/h2\u003e\n\n\u003cp\u003eAの実行結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHoge\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003efoo\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eself\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebar\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"kp\"\u003eprivate\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ebar\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efoo\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; A\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA6\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ6\u003c/h2\u003e\n\n\u003cp\u003eAの実行結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eHoge\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eattr_accessor\u003c/span\u003e \u003cspan class=\"ss\"\u003e:foo\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003einitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@foo\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efoo\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"vi\"\u003e@foo\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eHoge\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; A\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"クイズ7\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%AF%E3%82%A4%E3%82%BA7\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eクイズ7\u003c/h2\u003e\n\n\u003cp\u003eA, Bの実行結果は何でしょう?\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"ruby\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ehoge\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003esleep\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"c1\"\u003e# 重い処理\u003c/span\u003e\n  \u003cspan class=\"s1\"\u003e'hoge'\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eresult1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eresult1\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; A\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eresult2\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eresult2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ehoge\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; B\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e思いついたら追加します。\u003c/p\u003e\n","body":"自分が実際に業務でRubyを書いていてハマったところ、ハマりかけたところ、あるいは初心者がつまづきやすいところをクイズにしてみました。\n皆さん、実行せずに答えられますか?\n\n答えは[こちら](http://qiita.com/isuke/items/b8cc8fb5804fb522cb3f)\n\n## クイズ1\n\nAの出力結果は何でしょう?\n\n```ruby\ndef hoge(options = {})\n  foo = options.delete(:foo)\n  puts \"foo is #{foo}\"\n  puts \"options is #{options}\"\nend\n\noptions = {foo: 'FOO', bar: 'BAR'}\nhoge(options)\nputs options #=\u003e A\n```\n\n## クイズ2\n\nA, Bの出力結果は何でしょう?\n\n```ruby\nINIT_STR = 'INIT STR:'\n\ndef hoge(num)\n  temp = INIT_STR\n  num.times do |n|\n    temp \u003c\u003c \" #{n}\"\n  end\n  temp\nend\n\nputs hoge(3) #=\u003e A\nputs hoge(3) #=\u003e B\n```\n\n## クイズ3\n\nAの出力結果は何でしょう?\n\n```ruby\ndef hoge(options = {}, foo: 'FOO')\n  puts options\n  puts foo\nend\n\nhoge(bar: 'bar', foo: 'foo') #=\u003e A\n```\n\n## クイズ4\n\nA〜Hの実行結果は何でしょう?\n\n```ruby\nArray(1)            # =\u003e A\nArray(nil)          # =\u003e B\nArray([])           # =\u003e C\nArray.new           # =\u003e D\nArray.new(1)        # =\u003e E\nArray.new(nil)      # =\u003e F\nArray.new(nil.to_i) # =\u003e G\nArray.new([])       # =\u003e H\n```\n\n## クイズ5\n\nAの実行結果は何でしょう?\n\n```ruby\nclass Hoge\n  def foo\n    self.bar\n  end\n\nprivate\n\n  def bar\n    puts 'bar'\n  end\nend\n\nHoge.new.foo # =\u003e A\n```\n\n## クイズ6\n\nAの実行結果は何でしょう?\n\n```ruby\nclass Hoge\n  attr_accessor :foo,\n\n  def initialize(foo)\n    @foo = foo\n    puts @foo\n  end\nend\n\nHoge.new('bar') # =\u003e A\n```\n\n## クイズ7\n\nA, Bの実行結果は何でしょう?\n\n```ruby\ndef hoge\n  sleep 1 # 重い処理\n  'hoge'\nend\n\nif result1 = hoge\n  puts result1 # =\u003e A\nend\nputs result2 if result2 = hoge # =\u003e B\n```\n\n---\n\n思いついたら追加します。\n","coediting":false,"comments_count":0,"created_at":"2016-12-07T18:02:47+09:00","group":null,"id":"471bb5672af6e761032c","likes_count":2,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]}],"title":"Rubyクイズ","updated_at":"2016-12-12T18:20:42+09:00","url":"https://qiita.com/isuke/items/471bb5672af6e761032c","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003evue.jsでfile postする例です。\u003cbr\u003e\n何かのご参考になれば。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003etemplate#file_new\n  = file_field_tag :files, multiple: true, 'v-on:change' =\u0026gt; 'fileInputChange'\n  = submit_tag 'Upload', 'v-on:click.prevent' =\u0026gt; 'fileUpload'\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"coffeescript\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"nx\"\u003e$\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eVue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecomponent\u003c/span\u003e \u003cspan class=\"s\"\u003e'file-new'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"na\"\u003etemplate\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'#file_new'\u003c/span\u003e\n    \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efile_input\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003eundefined\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efiles\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003eundefined\u003c/span\u003e\n    \u003cspan class=\"na\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efileInputChange\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"vi\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003efile_input\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etarget\u003c/span\u003e\n        \u003cspan class=\"vi\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003efiles\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"vi\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003efile_input\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003efiles\u003c/span\u003e\n      \u003cspan class=\"na\"\u003efileUpload\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"vi\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003efiles\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eeach\u003c/span\u003e \u003cspan class=\"nb\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprototype\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eslice\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vi\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003efiles\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"vi\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003e_handleUpload\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"vi\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003efile_input\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e''\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e_handleUpload\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eform\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eFormData\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'Content-Type'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etype\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"s\"\u003e'application/octet-stream'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eform\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e'file'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n        \u003cspan class=\"nx\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eajax\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eurl\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\"/api/hoge.json\"\u003c/span\u003e\n          \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e'POST'\u003c/span\u003e\n          \u003cspan class=\"na\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eform\u003c/span\u003e\n          \u003cspan class=\"na\"\u003ecache\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n          \u003cspan class=\"na\"\u003econtentType\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eprocessData\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"no\"\u003efalse\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edone\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elog\u003c/span\u003e \u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003efail\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eerror\u003c/span\u003e \u003cspan class=\"nx\"\u003eresponse\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n","body":"vue.jsでfile postする例です。\n何かのご参考になれば。\n\n```\ntemplate#file_new\n  = file_field_tag :files, multiple: true, 'v-on:change' =\u003e 'fileInputChange'\n  = submit_tag 'Upload', 'v-on:click.prevent' =\u003e 'fileUpload'\n```\n\n\n```coffeescript\n$ -\u003e\n  Vue.component 'file-new',\n    template: '#file_new'\n    data: -\u003e\n      file_input: undefined\n      files: undefined\n    methods:\n      fileInputChange: (e) -\u003e\n        @file_input = e.target\n        @files = @file_input.files\n      fileUpload: -\u003e\n        return if @files.length \u003c= 0\n        $.each Array.prototype.slice.call(@files, 0), (i, file) =\u003e\n          @_handleUpload(file)\n        @file_input.value = ''\n      _handleUpload: (file) -\u003e\n        form = new FormData()\n        form.append('Content-Type', file.type || 'application/octet-stream')\n        form.append('file', file)\n\n        $.ajax\n          url: \"/api/hoge.json\"\n          type: 'POST'\n          data: form\n          cache: false\n          contentType: false\n          processData: false\n        .done (response) =\u003e\n          console.log response\n        .fail (response) =\u003e\n          console.error response\n```\n","coediting":false,"comments_count":1,"created_at":"2016-12-06T18:19:26+09:00","group":null,"id":"7ba7667f239b8df63f4d","likes_count":1,"private":false,"reactions_count":0,"tags":[{"name":"Vue.js","versions":[]}],"title":"vue.jsでfile postする例","updated_at":"2016-12-06T18:19:26+09:00","url":"https://qiita.com/isuke/items/7ba7667f239b8df63f4d","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\u003cp\u003eHasLogsというActiveRecordのログを取るgemを作りました。\u003cbr\u003e\n\u003ca href=\"https://github.com/isuke/has_logs\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/isuke/has_logs\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eこのgemはベータ版です。バグや破壊的な仕様変更があるかもしれません。\u003c/strong\u003e\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"動機\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E5%8B%95%E6%A9%9F\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e動機\u003c/h2\u003e\n\n\u003cp\u003eActiveRecordのログを取るgemは\u003ca href=\"https://github.com/collectiveidea/audited\" rel=\"nofollow noopener\" target=\"_blank\"\u003eaudited\u003c/a\u003eや\u003ca href=\"https://github.com/airblade/paper_trail\" rel=\"nofollow noopener\" target=\"_blank\"\u003epaper_trail\u003c/a\u003eなどありますが、いずれもymlやjsonにシリアライズして保存しているので、ログの検索機能がほしいときに困りますよね。\u003cbr\u003e\nそこで、ログテーブルにログを取るgemを作りました。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"usage\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#usage\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eUsage\u003c/h2\u003e\n\n\u003cp\u003earticlesというテーブルのログを取るとして、以下のようなmigrationを書きます。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCreateAllTables\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eActiveRecord\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eMigration\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eup\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecreate_table\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:articles\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n      \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etimestamps\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003ecreate_table\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:article_logs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n      \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einteger\u003c/span\u003e \u003cspan class=\"ss\"\u003e:article_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003estring\u003c/span\u003e \u003cspan class=\"ss\"\u003e:title\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etext\u003c/span\u003e \u003cspan class=\"ss\"\u003e:content\u003c/span\u003e\n      \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eboolean\u003c/span\u003e \u003cspan class=\"ss\"\u003e:public\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003enull: \u003c/span\u003e\u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003edefault: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n      \u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edatetime\u003c/span\u003e \u003cspan class=\"ss\"\u003e:created_at\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eadd_index\u003c/span\u003e \u003cspan class=\"ss\"\u003e:article_logs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"ss\"\u003e:article_id\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eadd_index\u003c/span\u003e \u003cspan class=\"ss\"\u003e:article_logs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:article_id\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:created_at\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e \u003cspan class=\"ss\"\u003eunique: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003earticlesテーブルが(timestamps以外)からっぽなのがポイントです。\u003c/p\u003e\n\n\u003cp\u003e次にModelを以下のようにします。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eArticle\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eActiveRecord\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBase\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ehas_logs\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eArticleLog\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eActiveRecord\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBase\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eact_as_log\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e使って見ましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"text\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003earticle = Article.create(title: 'test1', content: 'demo1', public: false)\narticle.attributes =   { title: 'test2', content: 'demo2', public: false } ; article.save!\narticle.attributes =   { title: 'test3', content: 'demo3', public: true  } ; article.save!\n\narticle.title\n=\u0026gt; 'test3'\n\narticle.logs\n=\u0026gt; [#\u0026lt;ArticleLog id: 1, article_id: 1, title: \"test1\", content: \"demo1\", created_at: \"2015-01-04 03:36:51\"\u0026gt;,\n #\u0026lt;ArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\"\u0026gt;,\n #\u0026lt;ArticleLog id: 3, article_id: 1, title: \"test3\", content: \"demo3\", created_at: \"2015-01-04 03:36:51\"\u0026gt;]\n\narticle.oldest_log\n=\u0026gt; #\u0026lt;ArticleLog id: 1, article_id: 1, title: \"test1\", content: \"demo1\", created_at: \"2015-01-04 03:36:51\"\u0026gt;\n\narticle.latest_log\n=\u0026gt; #\u0026lt;ArticleLog id: 3, article_id: 1, title: \"test3\", content: \"demo3\", created_at: \"2015-01-04 03:36:51\"\u0026gt;\n\narticle.oldest_log.next\n=\u0026gt; #\u0026lt;ArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\"\u0026gt;\n\narticle.latest_log.prev\n=\u0026gt; #\u0026lt;ArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\"\u0026gt;\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eいい感じです。\u003c/p\u003e\n\n\u003cp\u003eDB上は以下のようになっています。\u003c/p\u003e\n\n\u003ch5\u003e\n\u003cspan id=\"articles\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#articles\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003earticles\u003c/h5\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: right\"\u003eid\u003c/th\u003e\n\u003cth\u003etitle\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: right\"\u003e1\u003c/td\u003e\n\u003ctd\u003etitle\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch5\u003e\n\u003cspan id=\"article_logs\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#article_logs\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003earticle_logs\u003c/h5\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align: right\"\u003eid\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003earticle_id\u003c/th\u003e\n\u003cth\u003etitle\u003c/th\u003e\n\u003cth\u003econtent\u003c/th\u003e\n\u003cth style=\"text-align: right\"\u003epublic\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: right\"\u003e1\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e1\u003c/td\u003e\n\u003ctd\u003etest1\u003c/td\u003e\n\u003ctd\u003edemo1\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: right\"\u003e2\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e1\u003c/td\u003e\n\u003ctd\u003etest2\u003c/td\u003e\n\u003ctd\u003edemo2\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e0\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align: right\"\u003e3\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e1\u003c/td\u003e\n\u003ctd\u003etest3\u003c/td\u003e\n\u003ctd\u003edemo3\u003c/td\u003e\n\u003ctd style=\"text-align: right\"\u003e1\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e以上です。よかったら使ってみてください。\u003c/p\u003e\n","body":"HasLogsというActiveRecordのログを取るgemを作りました。\nhttps://github.com/isuke/has_logs\n\n**このgemはベータ版です。バグや破壊的な仕様変更があるかもしれません。**\n\n## 動機\n\nActiveRecordのログを取るgemは[audited](https://github.com/collectiveidea/audited)や[paper_trail](https://github.com/airblade/paper_trail)などありますが、いずれもymlやjsonにシリアライズして保存しているので、ログの検索機能がほしいときに困りますよね。\nそこで、ログテーブルにログを取るgemを作りました。\n\n## Usage\n\narticlesというテーブルのログを取るとして、以下のようなmigrationを書きます。\n\n```rb\nclass CreateAllTables \u003c ActiveRecord::Migration\n  def self.up\n    create_table(:articles) do |t|\n      t.timestamps\n    end\n\n    create_table(:article_logs) do |t|\n      t.integer :article_id, null: false\n      t.string :title, null: false\n      t.text :content\n      t.boolean :public, null: false, default: true\n      t.datetime :created_at\n    end\n    add_index :article_logs,  :article_id\n    add_index :article_logs, [:article_id, :created_at], unique: true\n  end\nend\n```\n\narticlesテーブルが(timestamps以外)からっぽなのがポイントです。\n\n次にModelを以下のようにします。\n\n```rb\nclass Article \u003c ActiveRecord::Base\n  has_logs\nend\n\nclass ArticleLog \u003c ActiveRecord::Base\n  act_as_log\nend\n```\n\n使って見ましょう。\n\n```\narticle = Article.create(title: 'test1', content: 'demo1', public: false)\narticle.attributes =   { title: 'test2', content: 'demo2', public: false } ; article.save!\narticle.attributes =   { title: 'test3', content: 'demo3', public: true  } ; article.save!\n\narticle.title\n=\u003e 'test3'\n\narticle.logs\n=\u003e [#\u003cArticleLog id: 1, article_id: 1, title: \"test1\", content: \"demo1\", created_at: \"2015-01-04 03:36:51\"\u003e,\n #\u003cArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\"\u003e,\n #\u003cArticleLog id: 3, article_id: 1, title: \"test3\", content: \"demo3\", created_at: \"2015-01-04 03:36:51\"\u003e]\n\narticle.oldest_log\n=\u003e #\u003cArticleLog id: 1, article_id: 1, title: \"test1\", content: \"demo1\", created_at: \"2015-01-04 03:36:51\"\u003e\n\narticle.latest_log\n=\u003e #\u003cArticleLog id: 3, article_id: 1, title: \"test3\", content: \"demo3\", created_at: \"2015-01-04 03:36:51\"\u003e\n\narticle.oldest_log.next\n=\u003e #\u003cArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\"\u003e\n\narticle.latest_log.prev\n=\u003e #\u003cArticleLog id: 2, article_id: 1, title: \"test2\", content: \"demo2\", created_at: \"2015-01-04 03:36:51\"\u003e\n```\n\nいい感じです。\n\nDB上は以下のようになっています。\n\n##### articles\n\n| id | title |\n|---:|-------|\n| 1  | title |\n\n##### article_logs\n\n| id | article_id | title | content | public |\n|---:|-----------:|-------|---------|-------:|\n|   1|           1| test1 | demo1   |       0|\n|   2|           1| test2 | demo2   |       0|\n|   3|           1| test3 | demo3   |       1|\n\n\n以上です。よかったら使ってみてください。\n","coediting":false,"comments_count":0,"created_at":"2016-12-05T18:34:13+09:00","group":null,"id":"a3ea358861812663f64c","likes_count":0,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"ActiveRecord","versions":[]}],"title":"ActiveRecordのログを取るgemを作りました。","updated_at":"2016-12-05T18:34:13+09:00","url":"https://qiita.com/isuke/items/a3ea358861812663f64c","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null},{"rendered_body":"\n\u003ch2\u003e\n\u003cspan id=\"ケース1\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B1%E3%83%BC%E3%82%B91\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eケース1\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"悪い書き方-itに文脈を書いてしまっている\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%82%AA%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-it%E3%81%AB%E6%96%87%E8%84%88%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%97%E3%81%BE%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e悪い書き方: \u003ccode\u003eit\u003c/code\u003eに文脈を書いてしまっている。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"s1\"\u003e'#hoge'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'引数がfooの場合barを返す'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'foo'\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"良い書き方-contextを使いましょうitには期待値だけを書きましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%89%AF%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-context%E3%82%92%E4%BD%BF%E3%81%84%E3%81%BE%E3%81%97%E3%82%87%E3%81%86it%E3%81%AB%E3%81%AF%E6%9C%9F%E5%BE%85%E5%80%A4%E3%81%A0%E3%81%91%E3%82%92%E6%9B%B8%E3%81%8D%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e良い書き方: \u003ccode\u003econtext\u003c/code\u003eを使いましょう。\u003ccode\u003eit\u003c/code\u003eには期待値だけを書きましょう。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"s1\"\u003e'#hoge'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"s1\"\u003e'引数がfooの場合'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:args\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"s1\"\u003e'foo'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'barを返す'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ケース2\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B1%E3%83%BC%E3%82%B92\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eケース2\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"あまり良くない書き方-itsを使っていない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%82%E3%81%BE%E3%82%8A%E8%89%AF%E3%81%8F%E3%81%AA%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-its%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eあまり良くない書き方: \u003ccode\u003eits\u003c/code\u003eを使っていない\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"s1\"\u003e'#hoge'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eexpecte\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehoge\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"良い書き方-itsを使いましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%89%AF%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-its%E3%82%92%E4%BD%BF%E3%81%84%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e良い書き方: \u003ccode\u003eits\u003c/code\u003eを使いましょう。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003eits\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:hoge\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e(\u003ccode\u003eits\u003c/code\u003eを使うためには\u003ccode\u003erspec-its\u003c/code\u003e gemが必要です。)\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ケース3\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B1%E3%83%BC%E3%82%B93\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eケース3\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"悪い書き方-contextの内容が直下のbeforeの内容と違う\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%82%AA%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-context%E3%81%AE%E5%86%85%E5%AE%B9%E3%81%8C%E7%9B%B4%E4%B8%8B%E3%81%AEbefore%E3%81%AE%E5%86%85%E5%AE%B9%E3%81%A8%E9%81%95%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e悪い書き方: \u003ccode\u003econtext\u003c/code\u003eの内容が直下の\u003ccode\u003ebefore\u003c/code\u003eの内容と違う。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"s1\"\u003e'ログインしている場合'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'名前が表示される'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003elogin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"良い書き方-beforeを使ってcontextの内容とbeforeの内容が同じになるようにしましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%89%AF%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-before%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6context%E3%81%AE%E5%86%85%E5%AE%B9%E3%81%A8before%E3%81%AE%E5%86%85%E5%AE%B9%E3%81%8C%E5%90%8C%E3%81%98%E3%81%AB%E3%81%AA%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%97%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e良い書き方: \u003ccode\u003ebefore\u003c/code\u003eを使って\u003ccode\u003econtext\u003c/code\u003eの内容と\u003ccode\u003ebefore\u003c/code\u003eの内容が同じになるようにしましょう。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"s1\"\u003e'ログインしている場合'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003elogin\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'名前が表示される'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ケース4\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B1%E3%83%BC%E3%82%B94\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eケース4\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"悪い書き方-letを使っていない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%82%AA%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-let%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e悪い書き方: \u003ccode\u003elet\u003c/code\u003eを使っていない。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eUser\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"vi\"\u003e@user\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'#name'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vi\"\u003e@user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"良い書き方-letを使いましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%89%AF%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-let%E3%82%92%E4%BD%BF%E3%81%84%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e良い書き方: \u003ccode\u003elet\u003c/code\u003eを使いましょう。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eUser\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'#name'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ケース5\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B1%E3%83%BC%E3%82%B95\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eケース5\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"悪い書き方-describeとsubjectが一致しないsubjectを使っていない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%82%AA%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-describe%E3%81%A8subject%E3%81%8C%E4%B8%80%E8%87%B4%E3%81%97%E3%81%AA%E3%81%84subject%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e悪い書き方: \u003ccode\u003edescribe\u003c/code\u003eと\u003ccode\u003esubject\u003c/code\u003eが一致しない(\u003ccode\u003esubject\u003c/code\u003eを使っていない)。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eUser\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'#name'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"良い書き方-describeの内容とsubjectは一致させましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%89%AF%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-describe%E3%81%AE%E5%86%85%E5%AE%B9%E3%81%A8subject%E3%81%AF%E4%B8%80%E8%87%B4%E3%81%95%E3%81%9B%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e良い書き方: \u003ccode\u003edescribe\u003c/code\u003eの内容と\u003ccode\u003esubject\u003c/code\u003eは一致させましょう。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eUser\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003esubject\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003euser\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eits\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Alice'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eこれで\u003ccode\u003eits\u003c/code\u003eも使えるようになります。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ケース6\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B1%E3%83%BC%E3%82%B96\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eケース6\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"悪い書き方-factory_girlのリレーションを使っていない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%82%AA%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-factory_girl%E3%81%AE%E3%83%AA%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e悪い書き方: factory_girlのリレーションを使っていない。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003euser_factory.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eFactoryGirl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefine\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efactory\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecompany_id\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nb\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e..\u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003ename\u003c/span\u003e     \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eFaker\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:company\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:company\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ecompany_id: \u003c/span\u003e\u003cspan class=\"n\"\u003ecompany\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"良い書き方-リレーションを使いましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%89%AF%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-%E3%83%AA%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%BF%E3%81%84%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e良い書き方: リレーションを使いましょう。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\n\u003cdiv class=\"code-lang\"\u003e\u003cspan class=\"bold\"\u003euser_factory.rb\u003c/span\u003e\u003c/div\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eFactoryGirl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefine\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003efactory\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ecompany\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003ename\u003c/span\u003e     \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"no\"\u003eFaker\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:company\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:company\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ecreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ecompany: \u003c/span\u003e\u003cspan class=\"n\"\u003ecompany\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ケース7\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B1%E3%83%BC%E3%82%B97\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eケース7\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"あまり良くない書き方-shouldaを使っていない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%82%E3%81%BE%E3%82%8A%E8%89%AF%E3%81%8F%E3%81%AA%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-shoulda%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eあまり良くない書き方: \u003ccode\u003eshoulda\u003c/code\u003eを使っていない。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"s1\"\u003e'keyが空の場合'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ekey\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e''\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ebe_invalid\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"良い書き方-shouldaを使いましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%89%AF%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-shoulda%E3%82%92%E4%BD%BF%E3%81%84%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e良い書き方: \u003ccode\u003eshoulda\u003c/code\u003eを使いましょう。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003evalidate_presence_of\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:key\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e他に何ができるかは \u003ca href=\"https://github.com/thoughtbot/shoulda-matchers\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\"\u003ehttps://github.com/thoughtbot/shoulda-matchers\u003c/a\u003e を見てください。\u003cbr\u003e\nかなり色々できます。\u003c/p\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ケース8\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B1%E3%83%BC%E3%82%B98\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eケース8\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"悪い書き方-shouldを使っている\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E6%82%AA%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-should%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e悪い書き方: \u003ccode\u003eshould\u003c/code\u003eを使っている。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eshould\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"良い書き方-expectを使いましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%89%AF%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-expect%E3%82%92%E4%BD%BF%E3%81%84%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e良い書き方: \u003ccode\u003eexpect\u003c/code\u003eを使いましょう。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efoo\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003eeq\u003c/span\u003e \u003cspan class=\"s1\"\u003e'bar'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"ケース9\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%82%B1%E3%83%BC%E3%82%B99\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eケース9\u003c/h2\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"あまり良くない書き方-重いテストをまとめていない\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%82%E3%81%BE%E3%82%8A%E8%89%AF%E3%81%8F%E3%81%AA%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-%E9%87%8D%E3%81%84%E3%83%86%E3%82%B9%E3%83%88%E3%82%92%E3%81%BE%E3%81%A8%E3%82%81%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eあまり良くない書き方: 重いテストをまとめていない。\u003c/h3\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eRSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efeature\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Project List Page'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ejs: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003evisit\u003c/span\u003e \u003cspan class=\"n\"\u003eproject_list_path\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003esubject\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003epage\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'ID'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'名前'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'受注先会社名'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'開始日'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'終了日'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'契約日'\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3\u003e\n\u003cspan id=\"良い書き方-重いテストは１つにまとめましょう\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E8%89%AF%E3%81%84%E6%9B%B8%E3%81%8D%E6%96%B9-%E9%87%8D%E3%81%84%E3%83%86%E3%82%B9%E3%83%88%E3%81%AF%EF%BC%91%E3%81%A4%E3%81%AB%E3%81%BE%E3%81%A8%E3%82%81%E3%81%BE%E3%81%97%E3%82%87%E3%81%86\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003e良い書き方: 重いテストは１つにまとめましょう\u003c/h3\u003e\n\n\u003cp\u003e「１つのテストで確認することは１つだけ」は正しいことですが、テストの実行にかかる時間とトレードオフです。\u003cbr\u003e\n仮想ブラウザを使ったテストなどの重いテストはまとめましょう。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eRSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efeature\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Project List Page'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ejs: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003evisit\u003c/span\u003e \u003cspan class=\"n\"\u003eproject_list_path\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003esubject\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003epage\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'各項目が存在すること'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'ID'\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'名前'\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'受注先会社名'\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'開始日'\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'終了日'\u003c/span\u003e \n    \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'契約日'\u003c/span\u003e \n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch4\u003e\n\u003cspan id=\"aggregate_failuresの使用\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#aggregate_failures%E3%81%AE%E4%BD%BF%E7%94%A8\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eaggregate_failuresの使用\u003c/h4\u003e\n\n\u003cp\u003e上記の例について、aggregate_failuresで各expectを囲ってやることでテストがfailした時にどの項目で落ちたのかがわかるようになります。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"no\"\u003eRSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efeature\u003c/span\u003e \u003cspan class=\"s1\"\u003e'Project List Page'\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003ejs: \u003c/span\u003e\u003cspan class=\"kp\"\u003etrue\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebefore\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003evisit\u003c/span\u003e \u003cspan class=\"n\"\u003eproject_list_path\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"n\"\u003esubject\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003epage\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"s1\"\u003e'各項目が存在すること'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eaggregate_failures\u003c/span\u003e \u003cspan class=\"s1\"\u003e'testing items'\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'ID'\u003c/span\u003e \n      \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'名前'\u003c/span\u003e \n      \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'受注先会社名'\u003c/span\u003e \n      \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'開始日'\u003c/span\u003e \n      \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'終了日'\u003c/span\u003e \n      \u003cspan class=\"n\"\u003eis_expected\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ehave_content\u003c/span\u003e \u003cspan class=\"s1\"\u003e'契約日'\u003c/span\u003e \n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003espec_helperに以下の記述を追加することでも同じことが可能です。\u003c/p\u003e\n\n\u003cdiv class=\"code-frame\" data-lang=\"rb\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edefine_derived_metadata\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003emeta\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n  \u003cspan class=\"n\"\u003emeta\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:aggregate_failures\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kp\"\u003etrue\u003c/span\u003e \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"n\"\u003emeta\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ekey?\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:aggregate_failures\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2\u003e\n\u003cspan id=\"まとめ的な\" class=\"fragment\"\u003e\u003c/span\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81%E7%9A%84%E3%81%AA\"\u003e\u003ci class=\"fa fa-link\"\u003e\u003c/i\u003e\u003c/a\u003eまとめ的な\u003c/h2\u003e\n\n\u003cp\u003especとは仕様という意味です。つまり、rspecは仕様書です。\u003cbr\u003e\nその点をふまえて以下の点を気をつけるといいと思います。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003econtext\u003c/code\u003e,\u003ccode\u003edescribe\u003c/code\u003eを正しく使って仕様書として読みやすくすること\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003econtext\u003c/code\u003e,\u003ccode\u003edescribe\u003c/code\u003eで謳っていることと、\u003ccode\u003ebefore\u003c/code\u003e,\u003ccode\u003esubject\u003c/code\u003e,\u003ccode\u003eit\u003c/code\u003e内のテストコードの内容が一致すること/一致することがすぐわかること\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e上記を守って楽しくプログラミング！\u003c/p\u003e\n","body":"## ケース1\n\n### 悪い書き方: `it`に文脈を書いてしまっている。\n\n```rb\ndescribe '#hoge' do\n  it '引数がfooの場合barを返す' do\n    expect(hoge('foo')).to eq 'bar'\n  end\nend\n```\n\n### 良い書き方: `context`を使いましょう。`it`には期待値だけを書きましょう。\n\n```rb\ndescribe '#hoge' do\n  context '引数がfooの場合' do\n    let(:args) { 'foo' }\n    it 'barを返す' do\n      expect(hoge(args)).to eq 'bar'\n    end\n  end\nend\n```\n\n## ケース2\n\n### あまり良くない書き方: `its`を使っていない\n\n```rb\ndescribe '#hoge' do\n  it { expecte(hoge).to eq 'bar' }\nend\n```\n\n### 良い書き方: `its`を使いましょう。\n\n\n```rb\nits(:hoge) { is_expected.to eq 'bar' }\n```\n\n(`its`を使うためには`rspec-its` gemが必要です。)\n\n## ケース3\n\n### 悪い書き方: `context`の内容が直下の`before`の内容と違う。\n\n```rb\ncontext 'ログインしている場合' do\n  it '名前が表示される' do\n    login(user)\n    is_expected.to have_content 'Alice'\n  end\nend\n```\n\n### 良い書き方: `before`を使って`context`の内容と`before`の内容が同じになるようにしましょう。\n\n```rb\ncontext 'ログインしている場合' do\n  before { login(user) }\n  it '名前が表示される' do\n    is_expected.to have_content 'Alice'\n  end\nend\n```\n\n## ケース4\n\n### 悪い書き方: `let`を使っていない。\n\n```rb\ndescribe User do\n  before { @user = create(:user, name: 'Alice') }\n\n  it '#name' do\n    expect(@user.name).to eq 'Alice'\n  end\nend\n\n```\n\n### 良い書き方: `let`を使いましょう。\n\n```rb\ndescribe User do\n  let(:user) { create(:user, name: 'Alice') }\n\n  it '#name' do\n    expect(user.name).to eq 'Alice'\n  end\nend\n```\n\n## ケース5\n\n### 悪い書き方: `describe`と`subject`が一致しない(`subject`を使っていない)。\n\n```rb\ndescribe User do\n  let(:user) { create(:user, name: 'Alice') }\n\n  it '#name' do\n    expect(user.name).to eq 'Alice'\n  end\nend\n```\n\n### 良い書き方: `describe`の内容と`subject`は一致させましょう。\n\n```rb\ndescribe User do\n  let(:user) { create(:user, name: 'Alice') }\n  subject { user }\n\n  its(:name) { is_expected.to eq 'Alice' }\nend\n```\n\nこれで`its`も使えるようになります。\n\n## ケース6\n\n### 悪い書き方: factory_girlのリレーションを使っていない。\n\n```rb:user_factory.rb\nFactoryGirl.define do\n  factory :user do\n    company_id { rand(1..100) }\n    name     { Faker::Name.name }\n  end\nend\n```\n\n```rb\nlet(:company) { create(:company) }\nlet(:user) { create(:user, company_id: company.id) }\n```\n\n### 良い書き方: リレーションを使いましょう。\n\n```rb:user_factory.rb\nFactoryGirl.define do\n  factory :user do\n    company\n    name     { Faker::Name.name }\n  end\nend\n```\n\n```rb\nlet(:company) { create(:company) }\nlet(:user) { create(:user, company: company) }\n```\n\n## ケース7\n\n### あまり良くない書き方: `shoulda`を使っていない。\n\n```rb\ncontext 'keyが空の場合' do\n  before { user.key = '' }\n  it { is_expected.to be_invalid }\nend\n\n```\n\n### 良い書き方: `shoulda`を使いましょう。\n\n```rb\nit { is_expected.to validate_presence_of(:key) }\n```\n\n他に何ができるかは https://github.com/thoughtbot/shoulda-matchers を見てください。\nかなり色々できます。\n\n\n## ケース8\n\n### 悪い書き方: `should`を使っている。\n\n```rb\nit { foo.should eq 'bar' }\n```\n\n### 良い書き方: `expect`を使いましょう。\n\n```rb\nit { expect(foo).to eq 'bar' }\n```\n\n## ケース9\n\n### あまり良くない書き方: 重いテストをまとめていない。\n\n```rb\nRSpec.feature 'Project List Page', js: true do\n  before { visit project_list_path }\n  subject { page }\n\n  it { is_expected.to have_content 'ID' }\n  it { is_expected.to have_content '名前' }\n  it { is_expected.to have_content '受注先会社名' }\n  it { is_expected.to have_content '開始日' }\n  it { is_expected.to have_content '終了日' }\n  it { is_expected.to have_content '契約日' }\nend\n```\n\n### 良い書き方: 重いテストは１つにまとめましょう\n\n「１つのテストで確認することは１つだけ」は正しいことですが、テストの実行にかかる時間とトレードオフです。\n仮想ブラウザを使ったテストなどの重いテストはまとめましょう。\n\n```rb\nRSpec.feature 'Project List Page', js: true do\n  before { visit project_list_path }\n  subject { page }\n\n  it '各項目が存在すること' do\n    is_expected.to have_content 'ID' \n    is_expected.to have_content '名前' \n    is_expected.to have_content '受注先会社名' \n    is_expected.to have_content '開始日' \n    is_expected.to have_content '終了日' \n    is_expected.to have_content '契約日' \n  end\nend\n```\n\n#### aggregate_failuresの使用\n\n上記の例について、aggregate_failuresで各expectを囲ってやることでテストがfailした時にどの項目で落ちたのかがわかるようになります。\n\n```rb\nRSpec.feature 'Project List Page', js: true do\n  before { visit project_list_path }\n  subject { page }\n\n  it '各項目が存在すること' do\n    aggregate_failures 'testing items' do\n      is_expected.to have_content 'ID' \n      is_expected.to have_content '名前' \n      is_expected.to have_content '受注先会社名' \n      is_expected.to have_content '開始日' \n      is_expected.to have_content '終了日' \n      is_expected.to have_content '契約日' \n    end\n  end\nend\n```\n\nspec_helperに以下の記述を追加することでも同じことが可能です。\n\n```rb\nconfig.define_derived_metadata do |meta|\n  meta[:aggregate_failures] = true unless meta.key?(:aggregate_failures)\nend\n```\n\n## まとめ的な\n\nspecとは仕様という意味です。つまり、rspecは仕様書です。\nその点をふまえて以下の点を気をつけるといいと思います。\n\n- `context`,`describe`を正しく使って仕様書として読みやすくすること\n- `context`,`describe`で謳っていることと、`before`,`subject`,`it`内のテストコードの内容が一致すること/一致することがすぐわかること\n\n上記を守って楽しくプログラミング！\n","coediting":false,"comments_count":3,"created_at":"2016-12-05T13:02:17+09:00","group":null,"id":"c98f76892d4fec2ac8bf","likes_count":101,"private":false,"reactions_count":0,"tags":[{"name":"Ruby","versions":[]},{"name":"RSpec","versions":[]}],"title":"rspecの悪い書き方、良い書き方","updated_at":"2017-06-14T21:38:43+09:00","url":"https://qiita.com/isuke/items/c98f76892d4fec2ac8bf","user":{"description":"Ruby/フロントプログラマです。\r\nVue.jsとCoffeeScript2信者。","facebook_id":"","followees_count":11,"followers_count":60,"github_login_name":"isuke","id":"isuke","items_count":40,"linkedin_id":"","location":"ঐ, Japan","name":"Isuke FUJIYAMA","organization":"Qiita上の私のデータを許可なくリクルートのために使用することを禁止します。","permanent_id":152997,"profile_image_url":"https://avatars.githubusercontent.com/u/6189067?v=3","team_only":false,"twitter_screen_name":"Isuke_0","website_url":"https://github.com/isuke"},"page_views_count":null}]